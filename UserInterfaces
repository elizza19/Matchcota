'Código Fuentes de Interfaces de Usuario. -
'1.	frmMascotas
Option Explicit
Private Sub Adodc1_Click()
End Sub
Private Sub cmdAdd_Click()
Dim id_estado, id_albergue, activo_web, str, id_color, id_mascota As String
Dim id_mas, id_desc, id_perro, id_gato, id_det, id_web As Integer
If Save = 1 Then
  If Combo_tipo.Text = "Perro" Then
    If Combo_nombre.Text = "" Or Combo_tipo.Text = "" Or Combo_estado.Text= "" Or Combo_albergue.Text = "" Or _
		txtFields(4).Text = "" Or txtFields(7).Text = "" And Combo_sexo.Text = "" Then
       MsgBox ("Ingrese todos los datos obligatorios")
    Else
       Adodc1.RecordSource = "SELECT id_estado FROM status where estado='" & Combo_estado.Text & "'"
       Adodc1.Refresh
       id_estado = Adodc1.Recordset!id_estado
       Adodc1.RecordSource = "SELECT id_albergue FROM albergues where nombre_albergue='" & Combo_albergue.Text & "'"
       Adodc1.Refresh
       id_albergue = Adodc1.Recordset!id_albergue
       Adodc1.RecordSource = "SELECT id_color FROM color where nombre_color='" & Combo_color.Text & "'"
       Adodc1.Refresh
       id_color = Adodc1.Recordset!id_color
       Adodc1.RecordSource = "SELECT MAX(id_mascota) FROM mascotas"
			  Adodc1.Refresh
id_mas = Adodc1.Recordset!Max + 1

       If Option1 = True Then
           activo_web = "Sí"
			Else
   If Option= True Then
           activo_web = "No"
           End If
       End If
       Adodc1.RecordSource = "Select * from mascotas"
       Adodc1.Refresh
       Adodc1.Recordset.AddNew
       Adodc1.Recordset!id_mascota = id_mas
       Adodc1.Recordset!numero_carnet = txtFields(0).Text
       Adodc1.Recordset!nombre_mascota = Combo_nombre.Text
       Adodc1.Recordset!tipo = Combo_tipo.Text
       Adodc1.Recordset!id_albergue = id_albergue
       Adodc1.Recordset!f_registro_matchcota = txtFields(4).Text
       Adodc1.Recordset!f_ingreso_albergue = txtFields(5).Text
       Adodc1.Recordset!id_estado = id_estado
       Adodc1.Recordset!f_nacimiento = txtFields(7).Text
       Adodc1.Recordset!f_fallecimiento = txtFields(8).Text
       Adodc1.Recordset!microchip = txtFields(9).Text
       Adodc1.Recordset!activo_web = activo_web
       Adodc1.Recordset.Update
      'Guardar Registro en Descripcion_Mascota
       Adodc1.RecordSource = "SELECT MAX(id_descripcion_mascota) FROM descripcion_mascota"
       Adodc1.Refresh
       id_desc = Adodc1.Recordset!Max + 1
       Adodc1.RecordSource = "Select * from descripcion_mascota"
       Adodc1.Refresh
       Adodc1.Recordset.AddNew
       Adodc1.Recordset!id_descripcion_mascota = id_desc
       Adodc1.Recordset!id_mascota = id_mas
       Adodc1.Recordset!sexo = Combo_sexo.Text
       Adodc1.Recordset!id_color = id_color
       Adodc1.Recordset!tipo_pelo = Combo_pelo.Text
       Adodc1.Recordset!tamano_adulto = Combo_tamano.Text
       Adodc1.Recordset!peso_adulto = Combo_peso.Text
      Adodc1.Recordset!alergias = Combo_alergia.Text
       Adodc1.Recordset!enfermedad_cronica = Combo_enfermedad.Text
       Adodc1.Recordset!esterilizado = Combo_esterilizado.Text
       Adodc1.Recordset!tratamiento = Combo_tratamiento.Text
       Adodc1.Recordset.Update
       
       'Guardar Registro en Personalidad_Perro
       Adodc1.RecordSource = "SELECT MAX(id_personalidad_mascota) FROM personalidad_perro"
       Adodc1.Refresh
       id_perro = Adodc1.Recordset!Max + 1
       Adodc1.RecordSource = "Select * from personalidad_perro"
       Adodc1.Refresh
       Adodc1.Recordset.AddNew
       Adodc1.Recordset!id_personalidad_mascota = id_perro
       Adodc1.Recordset!id_mascota = id_mas
       Adodc1.Recordset!carinoso = Combo_carinoso.Text
       Adodc1.Recordset!curioso = Combo_curioso.Text
       Adodc1.Recordset!deportista = Combo_deportista.Text
       Adodc1.Recordset!educado = Combo_educado.Text
       Adodc1.Recordset!independiente = Combo_independiente.Text
       Adodc1.Recordset!jugueton = Combo_jugueton.Text
       Adodc1.Recordset!tranquilo = Combo_tranquilo.Text
       Adodc1.Recordset!relacion_p_hembras = Combo_hembras.Text
       Adodc1.Recordset!relacion_p_machos = Combo_machos.Text
       Adodc1.Recordset!relacion_p_humanos = Combo_humanos.Text
       Adodc1.Recordset.Update
       
       'Guardar Registro en Web Mascota
       Adodc1.RecordSource = "SELECT MAX(id_web_mascota) FROM web_mascotas"
       Adodc1.Refresh
       id_web = Adodc1.Recordset!Max + 1
       Adodc1.RecordSource = "Select * from web_mascotas"
       Adodc1.Refresh
       Adodc1.Recordset.AddNew
       Adodc1.Recordset!id_web_mascota = id_web
       Adodc1.Recordset!id_mascota = id_mas
       Adodc1.Recordset!f_activacion_web = frmWEB.txt_fpub.Text
       Adodc1.Recordset!publicacion_historia = frmWEB.Combo_historia.Text
       Adodc1.Recordset.Update
       
      'Guardar Registro en Detalle_Web
       Adodc1.RecordSource = "SELECT MAX(id_detalle_web) FROM detalle_web"
       Adodc1.Refresh
       id_det = Adodc1.Recordset!Max + 1
       Adodc1.RecordSource = "Select * from detalle_web"
       Adodc1.Refresh
       Adodc1.Recordset.AddNew
       Adodc1.Recordset!id_detalle_web = id_det
       Adodc1.Recordset!id_web_mascota = id_web
       Adodc1.Recordset!descripcion = frmWEB.txt_descweb.Text
       Adodc1.Recordset!historia = frmWEB.txt_historiaweb.Text
       Adodc1.Recordset.Update
       MsgBox ("Registro de Perro creado")
      End If
  Else
    If Combo_nombre.Text = "" Or Combo_tipo.Text = "" Or Combo_estado.Text = "" Or Combo_albergue.Text = "" Or _
       txtFields(4).Text = "" Or txtFields(7).Text = "" And Combo_sexo.Text = "" Then
        MsgBox ("Ingrese todos los datos obligatorios")
    Else
        Adodc1.RecordSource = "SELECT id_estado FROM status where estado='" & Combo_estado.Text & "'"
       Adodc1.Refresh
       id_estado = Adodc1.Recordset!id_estado
       Adodc1.RecordSource = "SELECT id_albergue FROM albergues where nombre_albergue='" & Combo_albergue.Text & "'"
       Adodc1.Refresh
       id_albergue = Adodc1.Recordset!id_albergue
       Adodc1.RecordSource = "SELECT id_color FROM color where nombre_color='" & Combo_color.Text & "'"
       Adodc1.Refresh
       id_color = Adodc1.Recordset!id_color
       Adodc1.RecordSource = "SELECT MAX(id_mascota) FROM mascotas"
       Adodc1.Refresh
       id_mas = Adodc1.Recordset!Max + 1

       If Option1 = True Then
           activo_web = "Sí"
       Else
           If Option2 = True Then
           activo_web = "No"
           End If
       End If
       Adodc1.RecordSource = "Select * from mascotas"
       Adodc1.Refresh
        Adodc1.Recordset.AddNew
        Adodc1.Recordset!id_mascota = id_mas
        Adodc1.Recordset!numero_carnet = txtFields(0).Text
        Adodc1.Recordset!nombre_mascota = Combo_nombre.Text
        Adodc1.Recordset!tipo = Combo_tipo.Text
       Adodc1.Recordset!id_albergue = id_albergue
        Adodc1.Recordset!f_registro_matchcota = txtFields(4).Text
        Adodc1.Recordset!f_ingreso_albergue = txtFields(5).Text
        Adodc1.Recordset!id_estado = id_estado
        Adodc1.Recordset!f_nacimiento = txtFields(7).Text
        Adodc1.Recordset!f_fallecimiento = txtFields(8).Text
        Adodc1.Recordset!microchip = txtFields(9).Text
        Adodc1.Recordset!activo_web = activo_web
        Adodc1.Recordset.Update
    
        'Guardar Registro en Descripcion_Mascota
        Adodc1.RecordSource = "SELECT MAX(id_descripcion_mascota) FROM descripcion_mascota"
        Adodc1.Refresh
        id_desc = Adodc1.Recordset!Max + 1
        Adodc1.RecordSource = "Select * from descripcion_mascota"
        Adodc1.Refresh
  Adodc1.Recordset.AddNew
        Adodc1.Recordset!id_descripcion_mascota = id_desc
        Adodc1.Recordset!id_mascota = id_mas
        Adodc1.Recordset!sexo = Combo_sexo.Text
        Adodc1.Recordset!id_color = id_color
        Adodc1.Recordset!tipo_pelo = Combo_pelo.Text
        Adodc1.Recordset!tamano_adulto = Combo_tamano.Text
        Adodc1.Recordset!peso_adulto = Combo_peso.Text
        Adodc1.Recordset!alergias = Combo_alergia.Text
        Adodc1.Recordset!enfermedad_cronica = Combo_enfermedad.Text
        Adodc1.Recordset!esterilizado = Combo_esterilizado.Text
        Adodc1.Recordset!tratamiento = Combo_tratamiento.Text
        Adodc1.Recordset.Update
       'Guardar Registro en Personalidad_Gato
        Adodc1.RecordSource = "SELECT MAX(id_personalidad_gato) FROM personalidad_gato"
        Adodc1.Refresh
        id_gato = Adodc1.Recordset!Max + 1
     Adodc1.RecordSource = "Select * from personalidad_gato"
        Adodc1.Refresh
        Adodc1.Recordset.AddNew
        Adodc1.Recordset!id_personalidad_gato = id_gato
        Adodc1.Recordset!id_mascota = id_mas
        Adodc1.Recordset!sociable_humanos = Combo_sociable.Text
        Adodc1.Recordset!amigable = Combo_amigable.Text
        Adodc1.Recordset!extrovertido = Combo_extrovertido.Text
        Adodc1.Recordset!temoroso = Combo_temeroso.Text
        Adodc1.Recordset!dominante = Combo_dominante.Text
        Adodc1.Recordset!impulsivo = Combo_impulsivo.Text
        Adodc1.Recordset.Update
      'Guardar Registro en Web Mascota
        Adodc1.RecordSource = "SELECT MAX(id_web_mascota) FROM web_mascotas"
        Adodc1.Refresh
        id_web = Adodc1.Recordset!Max + 1
        Adodc1.RecordSource = "Select * from web_mascotas"
        Adodc1.Refresh
        Adodc1.Recordset.AddNew
        Adodc1.Recordset!id_web_mascota = id_web
        Adodc1.Recordset!id_mascota = id_mas
        Adodc1.Recordset!f_activacion_web = frmWEB.txt_fpub.Text
        Adodc1.Recordset!publicacion_historia = frmWEB.Combo_historia.Text
        Adodc1.Recordset.Update
        'Guardar Registro en Detalle_Web
        Adodc1.RecordSource = "SELECT MAX(id_detalle_web) FROM detalle_web"
        Adodc1.Refresh
        id_det = Adodc1.Recordset!Max + 1
        Adodc1.RecordSource = "Select * from detalle_web"
        Adodc1.Refresh
        Adodc1.Recordset.AddNew
        Adodc1.Recordset!id_detalle_web = id_det
        Adodc1.Recordset!id_web_mascota = id_web
        Adodc1.Recordset!descripcion = frmWEB.txt_descweb.Text
        Adodc1.Recordset!historia = frmWEB.txt_historiaweb.Text
        Adodc1.Recordset.Update
        MsgBox ("Registro de Gato creado")
    End If
  End If
Else
  If Combo_nombre.Text = "" Then
     MsgBox ("Debe elegir un mascota")
  Else
     Adodc1.RecordSource = "Select id_estado from status where estado='" & Combo_estado.Text & "'"
     Adodc1.Refresh
     id_estado = Adodc1.Recordset!id_estado
     Adodc1.RecordSource = "Select id_color from color where nombre_color='" & Combo_color.Text & "'"
     Adodc1.Refresh
     id_color = Adodc1.Recordset!id_color
     Adodc1.RecordSource = "Select * from mascotas where nombre_mascota='" & Combo_nombre.Text & "'"
     Adodc1.Refresh
     id_mascota = CStr(Adodc1.Recordset!id_mascota)
     If Option1 = True Then
     activo_web = "Sí"
        If Option2 = True Then
             activo_web = "No"
         End If
     End If
     Adodc1.Recordset!numero_carnet = txtFields(0).Text
     Adodc1.Recordset!tipo = Combo_tipo.Text
     Adodc1.Recordset!f_registro_matchcota = txtFields(4).Text
     Adodc1.Recordset!f_ingreso_albergue = txtFields(5).Text
     Adodc1.Recordset!id_estado = id_estado
     Adodc1.Recordset!f_nacimiento = txtFields(7).Text
     Adodc1.Recordset!f_fallecimiento = txtFields(8).Text
     Adodc1.Recordset!microchip = txtFields(9).Text
     Adodc1.Recordset!activo_web = activo_web
     Adodc1.Recordset.Update
   'Actualizar descripcion_mascota
     Adodc1.RecordSource = "Select * from descripcion_mascota where id_mascota='" & id_mascota & "'"
     Adodc1.Refresh
     Adodc1.Recordset!sexo = Combo_sexo.Text
     Adodc1.Recordset!id_color = id_color
     Adodc1.Recordset!tipo_pelo = Combo_pelo.Text
     Adodc1.Recordset!tamano_adulto = Combo_tamano.Text
     Adodc1.Recordset!peso_adulto = Combo_peso.Text
     Adodc1.Recordset!alergias = Combo_alergia.Text
     Adodc1.Recordset!enfermedad_cronica = Combo_enfermedad.Text
     Adodc1.Recordset!esterilizado = Combo_esterilizado.Text
     Adodc1.Recordset!tratamiento = Combo_tratamiento.Text
     Adodc1.Recordset.Update
     If Combo_tipo.Text = "Perro" Then
     ' Actualizar personalidad_perro
       Adodc1.RecordSource = "Select * from personalidad_perro where id_mascota='" & id_mascota & "'"
       Adodc1.Refresh
       Adodc1.Recordset!carinoso = Combo_carinoso.Text
       Adodc1.Recordset!curioso = Combo_curioso.Text
       Adodc1.Recordset!deportista = Combo_deportista.Text
       Adodc1.Recordset!educado = Combo_educado.Text
       Adodc1.Recordset!independiente = Combo_independiente.Text
       Adodc1.Recordset!jugueton = Combo_jugueton.Text
       Adodc1.Recordset!tranquilo = Combo_tranquilo.Text
       Adodc1.Recordset!relacion_p_hembras = Combo_hembras.Text
       Adodc1.Recordset!relacion_p_machos = Combo_machos.Text
       Adodc1.Recordset!relacion_p_humanos = Combo_humanos.Text
       Adodc1.Recordset.Update
       MsgBox ("Registro de Perro actualizado")
     Else
        ' Actualizar personalidad_gatos
         Adodc1.RecordSource = "Select * from personalidad_gato where id_mascota='" & id_mascota & "'"
         Adodc1.Refresh
         Adodc1.Recordset!sociable_humanos = Combo_sociable.Text
         Adodc1.Recordset!amigable = Combo_amigable.Text
         Adodc1.Recordset!extrovertido = Combo_extrovertido.Text
         Adodc1.Recordset!temoroso = Combo_temeroso.Text
         Adodc1.Recordset!dominante = Combo_dominante.Text
         Adodc1.Recordset!impulsivo = Combo_impulsivo.Text
         Adodc1.Recordset.Update
        MsgBox ("Registro de Gato actualizado")
     End If
        ' Actualizar Web Mascota
         Adodc1.RecordSource = "Select * from web_mascotas where id_mascota='" & id_mascota & "'"
         Adodc1.Refresh
         Adodc1.Recordset!f_activacion_web = frmWEB.txt_fpub.Text
         Adodc1.Recordset!publicacion_historia = frmWEB.Combo_historia.Text
         Adodc1.Recordset.Update
                 'Actualizar Detalle_web
         Adodc1.RecordSource = "Select * from detalle_web where id_web_mascota='" & Adodc1.Recordset!id_web_mascota & "'"
         Adodc1.Refresh
         Adodc1.Recordset!descripcion = frmWEB.txt_descweb.Text
         Adodc1.Recordset!historia = frmWEB.txt_historiaweb.Text
         Adodc1.Recordset.Update
         MsgBox ("Registro actualizado")
 End If
End If
End Sub
Private Sub CmdNuevo_Click()
Dim i, X As Integer
Combo_tipo.Enabled = True
txtFields(4).Enabled = True
Picture2.Enabled = True
Picture3.Enabled = True
Picture1.Enabled = True
Picture5.Enabled = True
txtFields(7).Enabled = True
txtFields(9).Enabled = True
txtFields(0).Enabled = True
Combo_estado.Enabled = True
Combo_albergue.Enabled = True
txtFields(5).Enabled = True
Picture3.Enabled = True
txtFields(8).Enabled = True
Option1.Enabled = True
Option2.Enabled = True
TxtEdad.Enabled = True
TxtTAlbergue.Enabled = True
Combo_sexo.Enabled = True
Combo_alergia.Enabled = True
Combo_tamano.Enabled = True
Combo_peso.Enabled = True
Combo_pelo.Enabled = True
Combo_esterilizado.Enabled = True
Combo_color.Enabled = True
Combo_enfermedad.Enabled = True
Combo_tratamiento.Enabled = True
Combo_carinoso.Enabled = True
Combo_curioso.Enabled = True
Combo_deportista.Enabled = True
Combo_educado.Enabled = True
Combo_independiente.Enabled = True
Combo_tranquilo.Enabled = True
Combo_hembras.Enabled = True
Combo_machos.Enabled = True
Combo_humanos.Enabled = True
Combo_jugueton.Enabled = True
Combo_sociable.Enabled = True
Combo_amigable.Enabled = True
Combo_extrovertido.Enabled = True
Combo_temeroso.Enabled = True
Combo_dominante.Enabled = True
Combo_impulsivo.Enabled = True
frmWEB.txt_fpub.Enabled = True
frmWEB.Picture1.Enabled = True
frmWEB.Combo_historia.Enabled = True
frmWEB.txt_descweb.Enabled = True
frmWEB.txt_historiaweb.Enabled = True
Combo_nombre.Clear
Combo_tipo.Clear
Combo_estado.Clear
Combo_albergue.Clear
txtFields(0).Text = ""
txtFields(4).Text = ""
txtFields(5).Text = ""
txtFields(7).Text = ""
txtFields(8).Text = ""
txtFields(9).Text = ""
TxtEdad.Text = ""
TxtTAlbergue.Text = ""
Option1 = False
Option2 = False
'Descripcion mascota
 Combo_sexo.Clear
 Combo_pelo.Clear
 Combo_tamano.Clear
 Combo_peso.Clear
 Combo_color.Clear
 Combo_alergia.Clear
 Combo_enfermedad.Clear
 Combo_esterilizado.Clear
 Combo_tratamiento.Clear
'Personalidad Perro
Combo_sociable.Clear
Combo_carinoso.Clear
Combo_curioso.Clear
Combo_deportista.Clear
Combo_educado.Clear
Combo_independiente.Clear
Combo_tranquilo.Clear
Combo_hembras.Clear
Combo_machos.Clear
Combo_humanos.Clear
Combo_jugueton.Clear
'Personalidad Gato
Combo_sociable.Clear
Combo_amigable.Clear
Combo_extrovertido.Clear
Combo_temeroso.Clear
Combo_dominante.Clear
Combo_impulsivo.Clear
'Web_Macosta
frmWEB.txt_fpub.Text = ""
frmWEB.Combo_historia.Text = ""
'Detalle  WEB
frmWEB.txt_descweb = ""
frmWEB.txt_historiaweb = ""
Adodc1.RecordSource = "SELECT DISTINCT tipo FROM mascotas where tipo!=''"
Adodc1.Refresh
With Adodc1.Recordset
    Do Until .EOF
        Combo_tipo.AddItem Adodc1.Recordset!tipo
        .MoveNext
 Loop
End With
Adodc1.RecordSource = "select DISTINCT estado from status where estado!=''"
Adodc1.Refresh
With Adodc1.Recordset
   Do Until .EOF
     Combo_estado.AddItem Adodc1.Recordset!estado
       .MoveNext
  Loop
End With
Adodc1.RecordSource = "select DISTINCT nombre_albergue from albergues where nombre_albergue!=''"
Adodc1.Refresh
With Adodc1.Recordset
   Do Until .EOF
         Combo_albergue.AddItem Adodc1.Recordset!nombre_albergue
        .MoveNext
Loop
End With
i = 0
 Combo_sexo.Clear
 Combo_pelo.Clear
 Combo_tamano.Clear
 Combo_peso.Clear
 Combo_color.Clear
 Combo_alergia.Clear
 Combo_enfermedad.Clear
 Combo_esterilizado.Clear
 Combo_tratamiento.Clear
Do Until i = 11
   Combo_carinoso.AddItem (i)
   Combo_curioso.AddItem (i)
   Combo_deportista.AddItem (i)
   Combo_educado.AddItem (i)
   Combo_independiente.AddItem (i)
   Combo_tranquilo.AddItem (i)
   Combo_jugueton.AddItem (i)
   'Personalidad Gato
   Combo_amigable.AddItem (i)
   Combo_extrovertido.AddItem (i)
   Combo_temeroso.AddItem (i)
   Combo_dominante.AddItem (i)
   Combo_impulsivo.AddItem (i)
   i = i + 1
Loop
Do Until X = 51
    Combo_peso.AddItem (X)
    X = X + 1
Loop
   Combo_hembras.AddItem "Sí"
   Combo_hembras.AddItem "No"
   Combo_machos.AddItem "Sí"
   Combo_machos.AddItem "No"
   Combo_humanos.AddItem "Sí"
   Combo_humanos.AddItem "No"
   Combo_sociable.AddItem "Sí"
   Combo_sociable.AddItem "No"
   Combo_sexo.AddItem "Hembra"
   Combo_sexo.AddItem "Macho"
   Combo_pelo.AddItem "Corto"
   Combo_pelo.AddItem "Mediano"
   Combo_pelo.AddItem "Largo"
   Combo_tamano.AddItem "Pequeño"
   Combo_tamano.AddItem "Mediano"
   Combo_tamano.AddItem "Grande"
   Combo_alergia.AddItem "Sí"
   Combo_alergia.AddItem "No"
   Combo_enfermedad.AddItem "Sí"
   Combo_enfermedad.AddItem "No"
   Combo_esterilizado.AddItem "Sí"
   Combo_esterilizado.AddItem "No"
   Combo_tratamiento.AddItem "Sí"
   Combo_tratamiento.AddItem "No"
   frmWEB.Combo_historia.AddItem "Yes"
  		           frmWEB.Combo_historia.AddItem "No"
Adodc1.RecordSource = "select nombre_color from color"
Adodc1.Refresh
With Adodc1.Recordset
    Do Until .EOF
       Combo_color.AddItem Adodc1.Recordset!nombre_color
        .MoveNext
Loop
End With
Save = 1
End Sub
Private Sub cmdUpdate_Click()
Dim id_web_masc, id_web As String
Dim i, X As Integer
Combo_tipo.Enabled = True
txtFields(4).Enabled = True
Picture2.Enabled = True
Picture3.Enabled = True
Picture1.Enabled = True
Picture5.Enabled = True
txtFields(7).Enabled = True
txtFields(9).Enabled = True
txtFields(0).Enabled = True
Combo_estado.Enabled = True
Combo_albergue.Enabled = True
txtFields(5).Enabled = True
Picture3.Enabled = True
txtFields(8).Enabled = True
Option1.Enabled = True
Option2.Enabled = True
TxtEdad.Enabled = True
TxtTAlbergue.Enabled = True
Combo_sexo.Enabled = True
Combo_alergia.Enabled = True
Combo_tamano.Enabled = True
Combo_peso.Enabled = True
Combo_pelo.Enabled = True
Combo_esterilizado.Enabled = True
Combo_color.Enabled = True
Combo_enfermedad.Enabled = True
Combo_tratamiento.Enabled = True
Combo_carinoso.Enabled = True
Combo_curioso.Enabled = True
Combo_deportista.Enabled = True
Combo_educado.Enabled = True
Combo_independiente.Enabled = True
Combo_tranquilo.Enabled = True
Combo_hembras.Enabled = True
Combo_machos.Enabled = True
Combo_humanos.Enabled = True
Combo_jugueton.Enabled = True
Combo_sociable.Enabled = True
Combo_amigable.Enabled = True
Combo_extrovertido.Enabled = True
Combo_temeroso.Enabled = True
Combo_dominante.Enabled = True
Combo_impulsivo.Enabled = True
frmWEB.txt_fpub.Enabled = False
frmWEB.Picture1.Enabled = True
frmWEB.Combo_historia.Enabled = True
frmWEB.txt_descweb.Enabled = True
frmWEB.txt_historiaweb.Enabled = True
i = 0
Do Until i = 11
   Combo_carinoso.AddItem (i)
   Combo_curioso.AddItem (i)
   Combo_deportista.AddItem (i)
   Combo_educado.AddItem (i)
   Combo_independiente.AddItem (i)
   Combo_tranquilo.AddItem (i)
   Combo_jugueton.AddItem (i)
    'Personalidad Gato
   Combo_sociable.AddItem (i)
   Combo_amigable.AddItem (i)
   Combo_extrovertido.AddItem (i)
   Combo_temeroso.AddItem (i)
   Combo_dominante.AddItem (i)
   Combo_impulsivo.AddItem (i)
   i = i + 1
Loop
Do Until X = 51
    Combo_peso.AddItem (X)
    X = X + 1
Loop
  Combo_hembras.AddItem "Sí"
   Combo_hembras.AddItem "No"
   Combo_machos.AddItem "Sí"
   Combo_machos.AddItem "No"
   Combo_humanos.AddItem "Sí"
   Combo_humanos.AddItem "No"
   Combo_sociable.AddItem "Sí"
   Combo_sociable.AddItem "No"
   Combo_sexo.AddItem "Hembra"
   Combo_sexo.AddItem "Macho"
   Combo_pelo.AddItem "Corto"
   Combo_pelo.AddItem "Mediano"
   Combo_pelo.AddItem "Largo"
   Combo_tamano.AddItem "Pequeño"
   Combo_tamano.AddItem "Mediano"
   Combo_tamano.AddItem "Grande"
   Combo_alergia.AddItem "Sí"
   Combo_alergia.AddItem "No"
   Combo_enfermedad.AddItem "Sí"
   Combo_enfermedad.AddItem "No"
   Combo_esterilizado.AddItem "Sí"
   Combo_esterilizado.AddItem "No"
   Combo_tratamiento.AddItem "Sí"
   Combo_tratamiento.AddItem "No"
   frmWEB.Combo_historia.AddItem "Yes"
   frmWEB.Combo_historia.AddItem "No"
Adodc1.RecordSource = "select nombre_color from color"
Adodc1.Refresh
With Adodc1.Recordset
    Do Until .EOF
       Combo_color.AddItem Adodc1.Recordset!nombre_color
        .MoveNext
   Loop
End With
Save = 2
End Sub
Private Sub cmdClose_Click()
  Unload Me
  frmMenuOpciones.Show
End Sub
Private Sub Combo_albergue_Change()
Adodc1.RecordSource = "select DISTINCT nombre_albergue from albergues where nombre_albergue!=''"
Adodc1.Refresh
With Adodc1.Recordset
   Do Until .EOF
        Combo_albergue.AddItem Adodc1.Recordset!nombre_albergue
        .MoveNext
 Loop
			End With
End Sub
Private Sub Combo_nombre_Click()
Dim str As String
Dim valor As String
Dim a_web As String
Dim id_masc, Color, tipo, id_web, id_web_masc As String
Dim f1, f2, f3, f4, f5, f6, f7, f8, f9 As Variant
Dim id_estado, id_albergue, id_color As Integer
valor = Combo_nombre.Text
Combo_tipo.Clear
Combo_estado.Clear
Combo_albergue.Clear
txtFields(0).Text = ""
txtFields(4).Text = ""
txtFields(5).Text = ""
txtFields(7).Text = ""
txtFields(8).Text = ""
txtFields(9).Text = ""
TxtEdad.Text = ""
TxtTAlbergue.Text = ""
Option1 = False
Option2 = False
'Descripcion mascota
 Combo_sexo.Clear
 Combo_pelo.Clear
 Combo_tamano.Clear
 Combo_peso.Clear
 Combo_color.Clear
 Combo_alergia.Clear
 Combo_enfermedad.Clear
 Combo_esterilizado.Clear
 Combo_tratamiento.Clear
'Personalidad Perro
Combo_sociable.Clear
Combo_carinoso.Clear
Combo_curioso.Clear
Combo_deportista.Clear
Combo_educado.Clear
Combo_independiente.Clear
Combo_tranquilo.Clear
Combo_hembras.Clear
Combo_machos.Clear
Combo_humanos.Clear
Combo_jugueton.Clear
'Personalidad Gato
Combo_sociable.Clear
Combo_amigable.Clear
Combo_extrovertido.Clear
Combo_temeroso.Clear
Combo_dominante.Clear
Combo_impulsivo.Clear
'Web_Macosta
frmWEB.txt_fpub.Text = ""
frmWEB.Combo_historia.Text = ""
'Detalle  WEB
frmWEB.txt_descweb = ""
frmWEB.txt_historiaweb = ""
Adodc1.RecordSource = "select * from mascotas where nombre_mascota='" &valor & "'" 
Adodc1.Refresh
id_masc = CStr(Adodc1.Recordset!id_mascota)
If IsNull(Adodc1.Recordset!tipo) = True Or Adodc1.Recordset!tipo = "" Then
    
    Combo_tipo.AddItem ""
Else
    tipo = Adodc1.Recordset!tipo
   Combo_tipo.AddItem Adodc1.Recordset!tipo
    Combo_tipo.ListIndex = 0
End If
If IsNull(Adodc1.Recordset!f_registro_matchcota) = True Or Adodc1.Recordset!f_registro_matchcota = "" Then
    txtFields(4).Text = ""
Else
    txtFields(4).Text = Format$(Adodc1.Recordset!f_registro_matchcota, "dd/mm/yyyy")
End If
If IsNull(Adodc1.Recordset!f_ingreso_albergue) = True Or Adodc1.Recordset!f_ingreso_albergue = "" Then
    txtFields(5).Text = ""
Else
    txtFields(5).Text = Format$(Adodc1.Recordset!f_ingreso_albergue, "dd/mm/yyyy")
End If
If IsNull(Adodc1.Recordset!f_nacimiento) = True Or Adodc1.Recordset!f_nacimiento = "" Then
    txtFields(7).Text = ""
Else
    txtFields(7).Text = Format$(Adodc1.Recordset!f_nacimiento, "dd/mm/yyyy")
End If
If IsNull(Adodc1.Recordset!f_fallecimiento) = True Or Adodc1.Recordset!f_fallecimiento = "" Then
    txtFields(8).Text = ""
Else
    txtFields(8).Text = Format$(Adodc1.Recordset!f_fallecimiento, "dd/mm/yyyy")
End If
If IsNull(Adodc1.Recordset!microchip) = True Or Adodc1.Recordset!microchip = "" Then
    txtFields(9).Text = ""
Else
    txtFields(9).Text = Adodc1.Recordset!microchip
End If
If IsNull(Adodc1.Recordset!numero_carnet) = True Or Adodc1.Recordset!numero_carnet = "" Then
    txtFields(0).Text = ""
Else
    txtFields(0).Text = Adodc1.Recordset!numero_carnet
End If
If IsNull(Adodc1.Recordset!activo_web) = True Or Adodc1.Recordset!activo_web = "" Then
    a_web = Adodc1.Recordset!activo_web
    If a_web = "Sí" Then
        Option1 = True
    Else
        Option2 = True
    End If
End If
f1 = DateValue(txtFecha)
If txtFields(7) <> "" Then
    f2 = DateValue(txtFields(7))
    f3 = DateDiff("yyyy", f2, f1)
    If f3 = 0 Then
        f4 = DateDiff("m", f2, f1)
        If f4 = 0 Then
            f5 = DateDiff("d", f2, f1)
            TxtEdad.Text = f5 & " dias"
        Else
            TxtEdad.Text = f4 & " meses"
        End If
    Else
        TxtEdad.Text = f3 & " años"
    End If
End If

If txtFields(5) <> "" Then
    f6 = DateValue(txtFields(5))
    f7 = DateDiff("yyyy", f6, f1)
    If f7 = 0 Then
        f8 = DateDiff("m", f6, f1)
        If f8 = 0 Then
         f9 = DateDiff("d", f6, f1)
           TxtTAlbergue = f9 & " dias"
        Else
            TxtTAlbergue = f8 & " meses"
        End If
    Else
        TxtTAlbergue = f7 & " años"
    End If
End If

id_estado = Adodc1.Recordset!id_estado
id_albergue = Adodc1.Recordset!id_albergue
Adodc1.RecordSource = "select * from status where id_estado='" & id_estado & "'"
Adodc1.Refresh
If IsNull(Adodc1.Recordset!estado) = True Or Adodc1.Recordset!estado = "" Then
    Combo_estado.AddItem ""
Else
     Combo_estado.AddItem Adodc1.Recordset!estado
    Combo_estado.ListIndex = 0
End If
    Adodc1.RecordSource = "select * from albergues where id_albergue='" & id_albergue & "'"
    Adodc1.Refresh
    If IsNull(Adodc1.Recordset!nombre_albergue) = True OrAdodc1.Recordset!nombre_albergue = "" Then
     Combo_albergue.AddItem ""
Else
        Combo_albergue.AddItem Adodc1.Recordset!nombre_albergue
        Combo_albergue.ListIndex = 0
    End If
'Descripcion Mascota
Adodc1.RecordSource = "Select id_color from descripcion_mascota where id_mascota='" & id_masc & "'"
Adodc1.Refresh

    id_color = Adodc1.Recordset!id_color
    Adodc1.RecordSource = "Select nombre_color from color where id_color=" & id_color
    Adodc1.Refresh
    If IsNull(Adodc1.Recordset!nombre_color) = True Or Adodc1.Recordset!nombre_color = "" Then
        Combo_color.Text = ""
    Else
        Color = Adodc1.Recordset!nombre_color
        Combo_color.Text = Color
    End If
    Adodc1.RecordSource = "Select * from descripcion_mascota where id_mascota='" & id_masc & "'"
    Adodc1.Refresh
    If IsNull(Adodc1.Recordset!sexo) = True Or Adodc1.Recordset!sexo = "" Then
        Combo_sexo.Text = ""
    Else
        Combo_sexo.Text = Adodc1.Recordset!sexo
    End If
    If IsNull(Adodc1.Recordset!tipo_pelo) = True Or Adodc1.Recordset!tipo_pelo = "" Then
      Combo_pelo.Text = ""
    Else
        Combo_pelo.Text = Adodc1.Recordset!tipo_pelo
    End If
    If IsNull(Adodc1.Recordset!tamano_adulto) = True Or Adodc1.Recordset!tamano_adulto = "" Then
        Combo_tamano.Text = ""
    Else
	  Combo_tamano.Text = Adodc1.Recordset!tamano_adulto
    End If
    If IsNull(Adodc1.Recordset!peso_adulto) = True Or Adodc1.Recordset!peso_adulto = "" Then
        Combo_peso.Text = ""
    Else
        Combo_peso.Text = Adodc1.Recordset!peso_adulto
    End If
    If IsNull(Adodc1.Recordset!alergias) = True Or Adodc1.Recordset!alergias = "" Then
        Combo_alergia.Text = ""
    Else
        Combo_alergia.Text = Adodc1.Recordset!alergias
    End If
    If IsNull(Adodc1.Recordset!enfermedad_cronica) = True Or Adodc1.Recordset!enfermedad_cronica = "" Then
        Combo_enfermedad.Text = ""
    Else
        Combo_enfermedad.Text = Adodc1.Recordset!enfermedad_cronica
    End If
    If IsNull(Adodc1.Recordset!esterilizado) = True Or Adodc1.Recordset!esterilizado = "" Then
        Combo_esterilizado.Text = ""
    Else
        Combo_esterilizado.Text = Adodc1.Recordset!esterilizado
    End If
    If IsNull(Adodc1.Recordset!tratamiento) = True Or Adodc1.Recordset!tratamiento = "" Then
        Combo_tratamiento.Text = ""
    Else
        Combo_tratamiento.Text = Adodc1.Recordset!tratamiento
    End If
If Combo_tipo.Text = "Perro" Then
Adodc1.RecordSource = "Select * from personalidad_perro where id_mascota='" & id_masc & "'"
Adodc1.Refresh
'Personalidad Perro
    If IsNull(Adodc1.Recordset!carinoso) = True Or Adodc1.Recordset!carinoso = "" Then
        Combo_carinoso.Text = ""
    Else
        Combo_carinoso.Text = Adodc1.Recordset!carinoso
    End If
    If IsNull(Adodc1.Recordset!curioso) = True Or Adodc1.Recordset!curioso = "" Then
        Combo_curioso.Text = ""
    Else
        Combo_curioso.Text = Adodc1.Recordset!curioso
    End If
    If IsNull(Adodc1.Recordset!deportista) = True Or Adodc1.Recordset!deportista = "" Then
        Combo_deportista.Text = ""
    Else
        Combo_deportista.Text = Adodc1.Recordset!deportista
    End If
    If IsNull(Adodc1.Recordset!educado) = True Or Adodc1.Recordset!educado = "" Then
        Combo_educado.Text = ""
    Else
        Combo_educado.Text = Adodc1.Recordset!educado
    End If
    If IsNull(Adodc1.Recordset!tranquilo) = True Or Adodc1.Recordset!tranquilo = "" The
        Combo_tranquilo.Text = ""
    Else
        Combo_tranquilo.Text = Adodc1.Recordset!tranquilo
    End If
    If IsNull(Adodc1.Recordset!relacion_p_hembras) = True Or Adodc1.Recordset!relacion_p_hembras = "" Then
        Combo_hembras.Text = ""
    Else
        Combo_hembras.Text = Adodc1.Recordset!relacion_p_hembras
    End If
    If IsNull(Adodc1.Recordset!relacion_p_machos) = True Or Adodc1.Recordset!relacion_p_machos = "" Then
        Combo_machos.Text = ""
    Else
        Combo_machos.Text = Adodc1.Recordset!relacion_p_machos
    End If
    If IsNull(Adodc1.Recordset!relacion_p_humanos) = True Or Adodc1.Recordset!relacion_p_humanos = "" Then
        Combo_humanos.Text = ""
    Else
        Combo_humanos.Text = Adodc1.Recordset!relacion_p_humanos
    End If
    If IsNull(Adodc1.Recordset!jugueton) = True Or Adodc1.Recordset!jugueton = "" Then
        Combo_jugueton.Text = ""
    Else
        Combo_jugueton.Text = Adodc1.Recordset!jugueton
    End If
    If IsNull(Adodc1.Recordset!independiente) = True Or Adodc1.Recordset!independiente = "" Then
        Combo_independiente.Text = ""
    Else
        Combo_independiente.Text = Adodc1.Recordset!independiente
    End If
'Personalidad Gato
    Frame3.Enabled = False
    Label21.Enabled = False
    Label22.Enabled = False
    Label23.Enabled = False
    Label24.Enabled = False
    Label25.Enabled = False
    Label26.Enabled = False
			 Combo_sociable.Enabled = False
    Combo_amigable.Enabled = False
    Combo_extrovertido.Enabled = False
    Combo_temeroso.Enabled = False
    Combo_dominante.Enabled = False
    Combo_impulsivo.Enabled = False
Else
    Adodc1.RecordSource = "Select * from personalidad_gato where id_mascota='" & id_masc & "'"
    Adodc1.Refresh
    'Personalidad Gato
    Frame2.Enabled = False
    Label11.Enabled = False
    Label12.Enabled = False
    Label13.Enabled = False
    Label14.Enabled = False
    Label15.Enabled = False
    Label16.Enabled = False
    Label17.Enabled = False
    Label18.Enabled = False
    Label19.Enabled = False
    Label20.Enabled = False
    Combo_carinoso.Enabled = False
    Combo_curioso.Enabled = False
    Combo_deportista.Enabled = False
    Combo_educado.Enabled = False
    Combo_independiente.Enabled = False
    Combo_tranquilo.Enabled = False
    Combo_hembras.Enabled = False
    Combo_machos.Enabled = False
    Combo_humanos.Enabled = False
    Combo_jugueton.Enabled = False
    'Personalidad Gato
   If IsNull(Adodc1.Recordset!sociable_humanos) = True Or Adodc1.Recordset!sociable_humanos = "" Then
        Combo_sociable.Text = ""
    Else
        Combo_sociable.Text = Adodc1.Recordset!sociable_humanos

    End If
    If IsNull(Adodc1.Recordset!amigable) = True Or Adodc1.Recordset!amigable = "" Then
        Combo_amigable.Text = ""
    Else
        Combo_amigable.Text = Adodc1.Recordset!amigable
    End If
    If IsNull(Adodc1.Recordset!extrovertido) = True Or Adodc1.Recordset!extrovertido = "" Then
        Combo_extrovertido.Text = ""
    Else
        Combo_extrovertido.Text = Adodc1.Recordset!extrovertido
    End If
    If IsNull(Adodc1.Recordset!temoroso) = True Or Adodc1.Recordset!temoroso = "" Then
        Combo_temeroso.Text = ""
    Else
        Combo_temeroso.Text = Adodc1.Recordset!temoroso
    End If
    If IsNull(Adodc1.Recordset!dominante) = True Or Adodc1.Recordset!dominante = "" Then
        Combo_dominante.Text = ""
    Else
        Combo_dominante.Text = Adodc1.Recordset!dominante
    End If
    If IsNull(Adodc1.Recordset!impulsivo) = True Or Adodc1.Recordset!impulsivo = "" Then
        Combo_impulsivo.Text = ""
    Else
        Combo_impulsivo.Text = Adodc1.Recordset!impulsivo
    End If
End If
'Cargar informacion de WEB_MASCOTAS
id_web = "Select * from web_mascotas where id_mascota='" & id_masc & "'"
Adodc1.RecordSource = id_web
Adodc1.Refresh
If Adodc1.Recordset.EOF = True Then
   frmWEB.txt_fpub.Text = ""
    frmWEB.Combo_historia.Text = ""
    frmWEB.txt_descweb.Text = ""
        frmWEB.txt_historiaweb.Text = ""
Else
    id_web = CStr(Adodc1.Recordset!id_web_mascota)
    If IsNull(Adodc1.Recordset!f_activacion_web) = True Or Adodc1.Recordset!f_activacion_web = "" Then
        frmWEB.txt_fpub.Text = ""
    Else
        frmWEB.txt_fpub.Text = Format$(Adodc1.Recordset!f_activacion_web, "dd/mm/yyyy")
    End If
    If IsNull(Adodc1.Recordset!publicacion_historia) = True Or Adodc1.Recordset!publicacion_historia = "" Then
        frmWEB.Combo_historia.Text = ""
    Else
        frmWEB.Combo_historia.Text = Adodc1.Recordset!publicacion_historia
    End If
                  'Cargar informacion de DETALLE_WEB
Adodc1.RecordSource = "Select * from detalle_web where id_web_mascota='" & id_web & "'"
Adodc1.Refresh
        id_web_masc = CStr(Adodc1.Recordset!id_web_mascota)

    If IsNull(Adodc1.Recordset!descripcion) = True Or Adodc1.Recordset!descripcion = "" The
        frmWEB.txt_descweb.Text = ""
    Else
        frmWEB.txt_descweb.Text = Adodc1.Recordset!descripcion
    End If
    If IsNull(Adodc1.Recordset!historia) = True Or Adodc1.Recordset!historia = "" Then
        frmWEB.txt_historiaweb.Text = ""
    Else
        frmWEB.txt_historiaweb.Text = Adodc1.Recordset!historia
    End If
End If
End Sub
Private Sub Command_infoweb_Click()
frmMascotas.Hide
frmWEB.Show
End Sub
Private Sub Form_Load()

Adodc1.RecordSource = "select distinct nombre_mascota from mascotas order by nombre_mascota asc"
Adodc1.Refresh
With Adodc1.Recordset
 Do Until .EOF
       Combo_nombre.AddItem Adodc1.Recordset!nombre_mascota
        .MoveNext
 Loop
End With
txtFecha.Text = Format$(Date, "dd/mm/yyyy")
Combo_tipo.Enabled = False
txtFields(4).Enabled = False
Picture2.Enabled = False
		        Picture3.Enabled = False
Picture1.Enabled = False
Picture5.Enabled = False
txtFields(7).Enabled = False
txtFields(9).Enabled = False
txtFields(0).Enabled = False
Combo_estado.Enabled = False
Combo_albergue.Enabled = False
txtFields(5).Enabled = False
Picture3.Enabled = False
txtFields(8).Enabled = False
Option1.Enabled = False
Option2.Enabled = False
TxtEdad.Enabled = False
TxtTAlbergue.Enabled = False
Combo_sexo.Enabled = False
Combo_alergia.Enabled = False
Combo_tamano.Enabled = False
Combo_peso.Enabled = False
Combo_pelo.Enabled = False
Combo_esterilizado.Enabled = False
Combo_color.Enabled = False
Combo_enfermedad.Enabled = False
Combo_tratamiento.Enabled = False
Combo_carinoso.Enabled = False
Combo_curioso.Enabled = False
Combo_deportista.Enabled = False
Combo_educado.Enabled = False
Combo_independiente.Enabled = False
Combo_tranquilo.Enabled = False
Combo_hembras.Enabled = False
Combo_machos.Enabled = False
Combo_humanos.Enabled = False
Combo_jugueton.Enabled = False
Combo_sociable.Enabled = False
Combo_amigable.Enabled = False
Combo_extrovertido.Enabled = False
Combo_temeroso.Enabled = False
Combo_dominante.Enabled = False
Combo_impulsivo.Enabled = False
frmWEB.txt_fpub.Enabled = False
frmWEB.Picture1.Enabled = False
frmWEB.Combo_historia.Enabled = False
frmWEB.txt_descweb.Enabled = False
frmWEB.txt_historiaweb.Enabled = False
End Sub
Private Sub MonthView1_DateClick(ByVal DateClicked As Date)
		        txtFields(7).Text = MonthView1.Value
MonthView1.Visible = False
End Sub
Private Sub MonthView2_DateClick(ByVal DateClicked As Date)
txtFields(4).Text = MonthView2.Value
MonthView2.Visible = False
End Sub
Private Sub MonthView3_DateClick(ByVal DateClicked As Date)
txtFields(8).Text = MonthView3.Value
MonthView3.Visible = False
End Sub
Private Sub MonthView4_DateClick(ByVal DateClicked As Date)
txtFields(5).Text = MonthView4.Value
MonthView4.Visible = False
End Sub
Private Sub Picture1_Click()
MonthView1.Visible = True
End Sub
Private Sub Picture2_Click()
MonthView2.Visible = True
End Sub
Private Sub Picture3_Click()
MonthView4.Visible = True
End Sub
Private Sub Picture5_Click()
MonthView3.Visible = True    End Sub




'2.	frmAdopciones
	    Option Explicit 
	     Private Sub CmdSeguimiento_Click()
frmSeguimiento.Show
End Sub
Private Sub Combo1_Click()
Dim mascota As String
Dim id_mascota As Integer
Dim valor, id_etologo, nombre_etologo As String
Dim id_resp As Integer
mascota = Combo1.Text
Combo2.Clear
Combo4.Clear
Combo6.Clear
Combo7.Clear
Combo3.Clear
Option3.Value = False
Option4.Value = False
Option5.Value = False
Option6.Value = False
Option7.Value = False
Option8.Value = False
Text1.Text = ""
Text3.Text = ""
Text2.Text = ""
Text8.Text = ""
Text7.Text = ""
Adodc1.RecordSource = "select id_mascota from mascotas where nombre_mascota='" & mascota & "'"
Adodc1.Refresh
id_mascota = Adodc1.Recordset!id_mascota
Adodc1.RecordSource = "select persona.nombre, persona.id_persona from mascotas inner join entrevista on mascotas.id_mascota=CAST(entrevista.id_mascota AS Integer) inner join persona on persona.id_persona=CAST(entrevista.id_persona as integer) where mascotas.id_mascota=" & id_mascota
Adodc1.Refresh
    If Adodc1.Recordset.Fields.Count > 1 Then
        With Adodc1.Recordset
            Do Until .EOF
                Combo2.AddItem Adodc1.Recordset!nombre
                .MoveNext
            Loop
        End With
    Else
        id_persona = Adodc1.Recordset!id_persona
        If Save <> 7 Then
        Combo2.Text = Adodc1.Recordset!nombre
        Combo2.Enabled = False
          Adodc1.RecordSource = "select adopciones.* from adopciones inner join entrevista on entrevista.id_entrevista=CAST(adopciones.id_entrevista AS INTEGER) where entrevista.id_mascota='" & id_mascota & " and entrevista.id_persona='" & id_persona & "'"""
        If (Adodc1!adopcion_intento) = "Adopción" Then
            Option3.Value = True
        Else
            Option4.Value = True
        End If
        If Adodc1!f_adopcion = Null Then
            Text1.Text = ""
        Else
            Text1.Text = Format$(Adodc1!f_adopcion, "dd/mm/yyyy")
        End If
       If IsNull(Adodc1!riesgo_asociado = True) Or Adodc1!riesgo_asociado = "" Then
            Combo4.Text = ""
        Else
            Combo4.AddItem Adodc1!riesgo_asociado
            Combo4.ListIndex = 0
        End If
        If IsNull(Adodc1!motivo_riesgo = True) Or Adodc1!motivo_riesgo = "" Then
            Text2.Text = ""
        Else
            Text2.Text = Adodc1!motivo_riesgo
        End If
        If IsNull(Adodc1!doc_regularizada = True) Or Adodc1!doc_regularizada = "" Then
            Option5.Value = False
            Option6.Value = False
        Else
            If Adodc1!doc_regularizada = "Si" Then
                Option5.Value = True
            Else
                Option6.Value = True
            End If
        End If
       If IsNull(Adodc1!f_regularizacion = True) Or Adodc1!f_regularizacion = "" Then
            Text3.Text = ""
        Else
            Text3.Text = Format$(Adodc1!f_regularizacion, "dd/mm/yyyy")
        End If
        If Adodc1!req_etologo = Null Then
            Combo6.AddItem ""
        Else
            Combo6.AddItem Adodc1!req_etologo
            Combo6.ListIndex = 0
        End If
        If IsNull(Adodc1!concluida = True) Or Adodc1!concluida = "" Then
            Option7.Value = False
            Option8.Value = False
        Else
            If Adodc1!concluida = "Si" Then
            Option7.Value = True
            Else
            Option8.Value = True
            End If
        End If
        If IsNull(Adodc1!f_regularizacion = True) Or Adodc1!f_regularizacion = "" Then
            Text8.Text = ""
        Else
            Text8.Text = Format$(Adodc1!intento_dev, "dd/mm/yyyy")
      End If
        If IsNull(Adodc1!f_regularizacion = True) Or Adodc1!f_regularizacion = "" Then
            Text7.Text = ""
        Else
            Text7.Text = Adodc1!comentario
        End If
        If IsNull(Adodc1!id_etologo = True) Or Adodc1!id_etologo = "" Then
            Combo7.AddItem ""
        Else
            id_etologo = Adodc1!id_etologo
            Adodc1.RecordSource = "Select nombre_equipo from equipo_matchcota where id_etologo='" & id_etologo & "'"
            Adodc1.Refresh
            nombre_etologo = Adodc1.Recordset!nombre_equipo
            Combo7.AddItem nombre_etologo
            Combo7.ListIndex = 0
        End If
            Else
             Combo3.Enabled = True             
Combo4.Enabled = True
Combo5.Enabled = True
Combo6.Enabled = True
Combo7.Enabled = True
Text1.Enabled = True
Text2.Enabled = True
Text3.Enabled = True
Text4.Enabled = True
Text5.Enabled = True
Text8.Enabled = True
Option3.Enabled = True
Option4.Enabled = True
Option5.Enabled = True
Option6.Enabled = True
Option7.Enabled = True
Option8.Enabled = True
Picture1.Enabled = True
Picture2.Enabled = True
Picture3.Enabled = True
Picture4.Enabled = True
Adodc1.RecordSource = "select nombre_equipo from equipo_matchcota"
Adodc1.Refresh
With Adodc1.Recordse
 Do Until .EOF
      Combo3.AddItem Adodc1.Recordset!nombre_equipo
                Combo5.AddItem Adodc1.Recordset!nombre_equipo
                Combo7.AddItem Adodc1.Recordset!nombre_equipo
                .MoveNext
            Loop
End With
Combo4.AddItem "Alto"
Combo4.AddItem "Medio"
Combo4.AddItem "Bajo"
Combo6.AddItem "Si"
Combo6.AddItem "No"
End If
           End If
End Sub
Private Sub Combo2_Click()
Dim mascota, persona, id_mascota, id_persona, id_etologo, nombre_etologo As String
If Save = 7 Then
    Combo3.Enabled = True
    Combo4.Enabled = True
    Combo5.Enabled = True
    Combo6.Enabled = True
    Combo7.Enabled = True
    Combo_motivo.Enabled = True
    Text1.Enabled = False
    Text2.Enabled = True
    Text3.Enabled = False
    Text4.Enabled = False
    Text5.Enabled = True
    Text6.Enabled = True
    Text8.Enabled = False
    Option3.Enabled = True
    Option4.Enabled = True
    Option5.Enabled = True
    Option6.Enabled = True
    Option7.Enabled = True
    Option8.Enabled = True
    Picture1.Enabled = True
    Picture2.Enabled = True
    Picture3.Enabled = True
    Picture4.Enabled = True
    Combo3.Clear
    Combo4.Clear
    Combo5.Clear
    Combo6.Clear
    Combo7.Clear
    Combo_motivo.Clear
    Text1.Text = ""
    Text2.Text = ""
    Text3.Text = ""
    Text4.Text = ""
    Text5.Text = ""
    Text6.Text = ""
    Text8.Text = ""
    Option3.Value = False
    Option4.Value = False
    Option5.Value = False
    Option6.Value = False
    Option7.Value = False
    Option8.Value = False
    Adodc1.RecordSource = "select nombre_equipo from equipo_matchcota"
    Adodc1.Refresh
   With Adodc1.Recordset
                Do Until .EOF
                    Combo3.AddItem Adodc1.Recordset!nombre_equipo
                    Combo5.AddItem Adodc1.Recordset!nombre_equipo
                    Combo7.AddItem Adodc1.Recordset!nombre_equipo
                    .MoveNext
                Loop
    End With
    Combo4.AddItem "Alto"
    Combo4.AddItem "Medio"
    Combo4.AddItem "Bajo"
    Combo6.AddItem "Si"
    Combo6.AddItem "No"
    Combo_motivo.AddItem "Personalidad Mascota"
    Combo_motivo.AddItem "Problemas Personales del Adoptante"
    Combo_motivo.AddItem "Relación con Adoptantes"
    Combo_motivo.AddItem "Relación con otras Mascotas"
    Combo_motivo.AddItem "Enfermedad Mascota"
    Combo_motivo.AddItem "Otros"
    If Option5.Value = True Then
        Combo5.Enabled = True
    Else
        Combo5.Enabled = False
    End If
    If Combo6.Text = "Si" Or Combo6.Text = "Sí" Then
        Combo7.Enabled = True
    Else
        Combo7.Enabled = False
    End If
    
    Text8.Enabled = False
    Picture4.Enabled = False
    Frame3.Enabled = False
    Frame2.Enabled = False
Else
        mascota = Combo1.Text
        Adodc1.RecordSource = "select id_mascota from mascotas where nombre_mascota='" & mascota & "'"
        Adodc1.Refresh
        id_mascota = CStr(Adodc1.Recordset!id_mascota)
        persona = Combo2.Text
        Adodc1.RecordSource = "select id_persona from persona where nombre='" & persona & "'"
        Adodc1.Refresh
        id_persona = CStr(Adodc1.Recordset!id_persona)
        Adodc1.RecordSource = "select * from adopciones inner join entrevista on entrevista.id_entrevista=CAST(adopciones.id_entrevista AS INTEGER) where entrevista.id_mascota='" & id_mascota & "' and entrevista.id_persona='" & id_persona & "'"
        Adodc1.Refresh
        Text9.Text = Adodc1.Recordset!id_adopcion
        If IsNull(Adodc1.Recordset!adopcion_intento) = True Or Adodc1.Recordset!adopcion_intento = "" Then
            Option3.Value = False
            Option4.Value = False
        Else
            If Adodc1.Recordset!adopcion_intento = "Adopción" Then
                Option3.Value = True
            Else
                If (Adodc1.Recordset!adopcion_intento) = "Intento" Then
                    Option4.Value = True
                End If
            End If
        End If
        If IsNull(Adodc1.Recordset!f_adopcion) = True Or Adodc1.Recordset!f_adopcion = "" Then
            Text1.Text = ""
        Else
            Text1.Text = Format$(Adodc1.Recordset!f_adopcion, "dd/mm/yyyy")
        End If
      If IsNull(Adodc1.Recordset!riesgo_asociado) = True Or Adodc1.Recordset!riesgo_asociado = "" Then
            Combo4.AddItem ""
        Else
            Combo4.AddItem Adodc1.Recordset!riesgo_asociado
            Combo4.ListIndex = 0
        End If
        If IsNull(Adodc1.Recordset!motivo_riesgo) = True Or Adodc1.Recordset!motivo_riesgo = "" Then
            Text2.Text = ""
        Else
            Text2.Text = Adodc1.Recordset!motivo_riesgo
        End If
        If IsNull(Adodc1.Recordset!doc_regularizada) = True Or Adodc1.Recordset!doc_regularizada = "" Then
            Option5.Value = False
            Option6.Value = False
        Else
            If Adodc1.Recordset!doc_regularizada = "Si" Then
                Option5.Value = True
            Else
                If Adodc1.Recordset!doc_regularizada = "No" Then
                Option6.Value = True
                End If
            End If
        End If
      If IsNull(Adodc1.Recordset!f_regularizacion) = True Or Adodc1.Recordset!f_regularizacion = "" Then
            Text3.Text = ""
        Else
            Text3.Text = Format$(Adodc1.Recordset!f_regularizacion, "dd/mm/yyyy")
        End If
        If IsNull(Adodc1.Recordset!nombre_adoptado) = True Or Adodc1.Recordset!nombre_adoptado = "" Then
            Text6.Text = ""
        Else
            Text6.Text = Adodc1.Recordset!nombre_adoptado
        End If
        If IsNull(Adodc1.Recordset!req_etologo) = True Or Adodc1.Recordset!req_etologo = "" Then
            Combo6.AddItem ""
        Else
            Combo6.AddItem Adodc1.Recordset!req_etologo
            Combo6.ListIndex = 0
        End If
        If IsNull(Adodc1.Recordset!concluida) = True Or Adodc1.Recordset!concluida = "" Then
            Option7.Value = False
            Option8.Value = False
        Else
            If Adodc1.Recordset!concluida = "Si" Then
            Option7.Value = True
            Else
                If Adodc1.Recordset!concluida = "No" Then
                Option8.Value = True
                End If
            End If
        End If
        If IsNull(Adodc1.Recordset!f_regularizacion) = True Or Adodc1.Recordset!f_regularizacion = "" Then
            Text8.Text = ""
        Else
            Text8.Text = Format$(Adodc1.Recordset!intento_dev, "dd/mm/yyyy")
        
        End If
        If (Adodc1.Recordset!f_regularizacion) = True Or Adodc1.Recordset!f_regularizacion = "" Then
            Text7.Text = ""
        Else
            Text7.Text = Adodc1.Recordset!comentario
        End If
        If IsNull(Adodc1.Recordset!req_etologo) = True Or Adodc1.Recordset!req_etologo = "" Then
            Combo6.Text = ""
        Else
            Combo6.Text = Adodc1.Recordset!req_etologo
            If IsNull(Adodc1.Recordset!id_etologo) = True Or Adodc1.Recordset!id_etologo = "" Then
                Combo7.AddItem ""
            Else
                id_etologo = Adodc1.Recordset!id_etologo
                Adodc1.RecordSource = "Select nombre_equipo from equipo_matchcota where id_equipo='" & id_etologo & "'"
                Adodc1.Refresh
                nombre_etologo = Adodc1.Recordset!nombre_equipo
                Combo7.AddItem nombre_etologo
                Combo7.ListIndex = 0
            End If
        End If
    Adodc1.RecordSource = "select * from devoluciones where id_adopcion='" & Text9.Text & "'"
    Adodc1.Refresh
    If Adodc1.Recordset.EOF = True Then
        Text4.Text = ""
        Combo_motivo.Text = ""
        Text5.Text = ""
   Else
        If IsNull(Adodc1.Recordset!f_devolucion) = True Or Adodc1.Recordset!f_devolucion = "" Then
            Text4.Text = ""
        Else
            Text4.Text = Format$(Adodc1.Recordset!f_devolucion, "dd/mm/yyyy")
        End If
        If IsNull(Adodc1.Recordset!motivo_devolucion) = True Or Adodc1.Recordset!motivo_devolucion = "" Then
            Combo_motivo.Text = ""
        Else
            Combo_motivo.AddItem Adodc1.Recordset!motivo_devolucion
        End If
        If IsNull(Adodc1.Recordset!comentario_devolucion) = True Or Adodc1.Recordset!comentario_devolucion = "" Then
            Text5.Text = ""
        Else
            Text5.Text = Adodc1.Recordset!comentario
        End If
    End If
    End If
End Sub
Private Sub Command1_Click()
Adodc1.RecordSource = "select  distinct mascotas.nombre_mascota from mascotas inner join entrevista on mascotas.id_mascota=CAST(entrevista.id_mascota AS INTEGER) inner join persona on persona.id_persona=CAST(entrevista.id_persona AS INTEGER) where entrevista.resultado='Aprobado' and nombre_mascota not in( select  mascotas.nombre_mascota from mascotas inner join entrevista on mascotas.id_mascota=CAST(entrevista.id_mascota AS INTEGER) inner join persona on persona.id_persona=CAST(entrevista.id_persona AS INTEGER) inner join adopciones on entrevista.id_entrevista=CAST(adopciones.id_entrevista as INTEGER))"
Adodc1.Refresh
Combo1.Clear
Combo1.Enabled = True
Combo2.Clear
Combo2.Enabled = True
With Adodc1.Recordset
    Do Until .EOF
         Combo1.AddItem Adodc1.Recordset!nombre_mascota
        .MoveNext
    Loop
End With
Combo3.Enabled = True
Combo4.Enabled = True
Combo5.Enabled = True
Combo6.Enabled = True
Combo7.Enabled = True
Text1.Enabled = False
Text2.Enabled = True
Text3.Enabled = False
Text4.Enabled = False
Text5.Enabled = False
Combo_motivo.Enabled = False
Text6.Enabled = True
Text7.Enabled = True
Text8.Enabled = False
Option3.Enabled = True
Option4.Enabled = True
Option5.Enabled = True
Option6.Enabled = True
Option7.Enabled = True
Option8.Enabled = True
Picture1.Enabled = True
Picture2.Enabled = True
Picture3.Enabled = True
Picture4.Enabled = True
Combo3.Clear
Combo4.Clear
Combo5.Clear
Combo6.Clear
Combo7.Clear
Text1.Text = ""
Text2.Text = ""
Text3.Text = ""
Text4.Text = ""
Text5.Text = ""
Text8.Text = ""
Option3.Value = False
Option4.Value = False
Option5.Value = False
Option6.Value = False
Option7.Value = False
Option8.Value = False
Save = 7
End Sub
Private Sub Command2_Click()
Combo1.Enabled = False
Combo2.Enabled = False
Combo3.Enabled = True
Combo4.Enabled = True
Combo5.Enabled = True
Combo6.Enabled = True
Combo7.Enabled = True
Combo_motivo.Enabled = True
Text1.Enabled = False
Text2.Enabled = True
Text3.Enabled = False
Text4.Enabled = True
Text5.Enabled = True
Text6.Enabled = True
Text7.Enabled = True
Text8.Enabled = False
Option3.Enabled = True
Option4.Enabled = True
Option5.Enabled = True
Option6.Enabled = True
Option7.Enabled = True
Option8.Enabled = True
Picture1.Enabled = True
Picture2.Enabled = True
Picture3.Enabled = True
Picture4.Enabled = True
Frame2.Enabled = True
Frame3.Enabled = True
Adodc1.RecordSource = "select nombre_equipo from equipo_matchcota"
Adodc1.Refresh
With Adodc1.Recordset
            Do Until .EOF
               Combo3.AddItem Adodc1.Recordset!nombre_equipo
                .MoveNext
            Loop
End With
If Combo4.Text = "" Then
    Combo4.AddItem "Alto"
    Combo4.AddItem "Medio"
    Combo4.AddItem "Bajo"
Else
    If Combo4.Text = "Alto" Then
        Combo4.AddItem "Medio"
        Combo4.AddItem "Bajo"
    End If
    If Combo4.Text = "Bajo" Then
        Combo4.AddItem "Alto"
        Combo4.AddItem "Medio"
    End If
    If Combo4.Text = "Bajo" Then
        Combo4.AddItem "Alto"
        Combo4.AddItem "Medio"
   End If
End If
Combo_motivo.AddItem "Personalidad Mascota"
Combo_motivo.AddItem "Problemas Personales del Adoptante"
Combo_motivo.AddItem "Relación con Adoptantes"
Combo_motivo.AddItem "Relación con otras Mascotas"
Combo_motivo.AddItem "Enfermedad Mascota"
Combo_motivo.AddItem "Otros"
If Combo6.Text = "" Then
    Combo6.AddItem "Si"
    Combo6.AddItem "No"
Else
    If Combo6.Text = "Si" Then
        Combo4.AddItem "No"
    End If
    If Combo6.Text = "No" Then
        Combo6.AddItem "Si"
    End If
End If
If Option5.Value = True Then
    Combo5.Enabled = True
Else
    Combo5.Enabled = False
End If
If Combo6.Text = "Si" Then
    Combo7.Enabled = True
Else
    Combo7.Enabled = False
End If
Save = 8
End Sub
Private Sub Command3_Click()
Dim valor As Integer
Dim adop, devolu As Integer
Dim nombre_equipo, id_equipo, nombre_equipo1, id_equipo1, nombre_etologo, id_etologo, mascota, persona As String
mascota = Combo1.Text
        persona = Combo2.Text
        Adodc1.RecordSource = "select entrevista.id_entrevista from entrevista inner join mascotas on mascotas.id_mascota= CAST(entrevista.id_mascota as integer) inner join persona on persona.id_persona = cast(entrevista.id_persona as integer) where mascotas.nombre_mascota='" & mascota & "'and persona.nombre='" & persona & "'"
        Adodc1.Refresh
        valor = Adodc1.Recordset!id_entrevista
If Save = 7 Then
    If Combo1.Text = "" And Combo2.Text = "" And Combo3.Text = "" And Combo4.Text = "" And Text1.Text = "" And Text2.Text = "" Then
       MsgBox ("Debe completar todos los campos")
    Else
        nombre_equipo = Combo3.Text
        Adodc1.RecordSource = "Select id_equipo from equipo_matchcota where nombre_equipo= '" & nombre_equipo & "'"
        Adodc1.Refresh
        id_equipo = CStr(Adodc1.Recordset!id_equipo)
        nombre_equipo1 = Combo5.Text
        If nombre_equipo1 <> "" Then
            Adodc1.RecordSource = "Select id_equipo from equipo_matchcota where nombre_equipo= '" & nombre_equipo1 & "'"
            Adodc1.Refresh
            id_equipo1 = CStr(Adodc1.Recordset!id_equipo)
        End If
        nombre_etologo = Combo7.Text
        If nombre_etologo <> "" Then
            Adodc1.RecordSource = "Select id_equipo from equipo_matchcota where nombre_equipo= '" & nombre_etologo & "'"
            Adodc1.Refresh
            id_etologo = CStr(Adodc1.Recordset!id_equipo)
        End If
       Adodc1.RecordSource = "SELECT MAX(id_adopcion) FROM adopciones"
        Adodc1.Refresh
        adop = Adodc1.Recordset!Max + 1
        Adodc1.RecordSource = "SELECT * FROM adopciones"
        Adodc1.Refresh
        Adodc1.Recordset.AddNew
        Adodc1.Recordset!id_adopcion = CStr(adop)
        Adodc1.Recordset!id_entrevista = valor
        Adodc1.Recordset!nombre_adoptado = Text6.Text
        If Option3.Value = "True" Then
                Adodc1.Recordset!adopcion_intento = "Adopcion"
        Else
                Adodc1.Recordset!adopcion_intento = "Intento"
        End If
        Adodc1.Recordset!resp_adopcion = id_equipo
        Adodc1.Recordset!f_adopcion = Text1.Text
        Adodc1.Recordset!riesgo_asociado = Combo4.Text
        Adodc1.Recordset!motivo_riesgo = Text2.Text
        If Option5.Value = "True" Then
                Adodc1.Recordset!doc_regularizada = "Si"
                Adodc1.Recordset!f_regularizacion = Text3.Text
                Adodc1.Recordset!resp_regularizacion = id_equipo1
        Else
                Adodc1.Recordset!doc_regularizada = "No"
        End If
        Adodc1.Recordset!req_etologo = Combo6.Text
        Adodc1.Recordset!id_etologo = Text7.Text
        Adodc1.Recordset!comentario = Text2.Text
        Adodc1.Recordset!intento_dev = ""
        If Option7.Value = "True" Then
            Adodc1.Recordset!concluida = "Si"
        Else
            Adodc1.Recordset!concluida = "No"
        End If
        Adodc1.Recordset.Update
       Adodc1.RecordSource = "select * from mascotas where nombre_mascota='" & mascota & "'"
                Adodc1.Refresh
                Adodc1.Recordset!id_estado = "2"
                Adodc1.Recordset.Update
                MsgBox ("Registro de Adopcion creado")
    End If
  Else
        If Save = 8 Then
        nombre_equipo = Combo3.Text
        Adodc1.RecordSource = "Select id_equipo from equipo_matchcota where nombre_equipo= '" & nombre_equipo & "'"
        Adodc1.Refresh
        id_equipo = CStr(Adodc1.Recordset!id_equipo)
        nombre_equipo1 = Combo5.Text
        Adodc1.RecordSource = "Select id_equipo from equipo_matchcota where nombre_equipo= '" & nombre_equipo1 & "'"
        Adodc1.Refresh
        id_equipo1 = CStr(Adodc1.Recordset!id_equipo)
        nombre_etologo = Combo7.Text
        Adodc1.RecordSource = "Select id_equipo from equipo_matchcota where nombre_equipo= '" & nombre_etologo & "'"
        Adodc1.Refresh
        id_etologo = CStr(Adodc1.Recordset!id_equipo)
        Adodc1.RecordSource = "SELECT * FROM adopciones where id_entrevista='" & valor & "'"
        Adodc1.Refresh
        Adodc1.Recordset!nombre_adoptado = Text6.Text
        If Option3.Value = "True" Then
                Adodc1.Recordset!adopcion_intento = "Adopcion"
        Else
                Adodc1.Recordset!adopcion_intento = "Intento"
        End If
        Adodc1.Recordset!resp_adopcion = id_equipo
        Adodc1.Recordset!f_adopcion = Text1.Text
        Adodc1.Recordset!riesgo_asociado = Combo4.Text
        Adodc1.Recordset!rmotivo_riesgo = Text2.Text
        If Option5.Value = "True" Then
                Adodc1.Recordset!doc_regularizada = "Si"
                Adodc1.Recordset!f_regularizacion = Text3.Text
                Adodc1.Recordset!resp_regularizacion = id_equipo1
        Else
                Adodc1.Recordset!doc_regularizada = "No"
        End If
        Adodc1.Recordset!req_etologo = Combo6.Text
        Adodc1.Recordset!id_etologo = Text2.Text
        Adodc1.Recordset!comentario = Text7.Text
        Adodc1.Recordset!intento_dev = Text8.Text
        If Option7.Value = "True" Then
            Adodc1.Recordset!concluida = "Si"
        Else
            Adodc1.Recordset!concluida = "No"
        End If
        Adodc1.Recordset.Update
        If Option8.Value = "True" Then
            If Text4.Text = "" Or Text5.Text = "" Then
            MsgBox ("Complete los datos de la devolucion")
            Else
            If frmMascotas.Adodc1.Recordset.EOF = True Then
                Adodc1.RecordSource = "SELECT MAX(id_devoluciones) FROM devoluciones"
                Adodc1.Refresh
                devolu = Adodc1.Recordset!Max + 1
                Adodc1.RecordSource = "SELECT * FROM devoluciones"
                Adodc1.Refresh
                Adodc1.Recordset!id_devolucion = devolu
                Adodc1.Recordset!id_adopcion = CStr(adop)
                Adodc1.Recordset!f_devolucion = Text4.Text
                Adodc1.Recordset!motivos_devolucion = Combo_motivo.Text
                Adodc1.Recordset!comentario_devolucion = Text5.Text                
      Adodc1.Recordset.Update
             Else
                Adodc1.RecordSource = "SELECT * FROM devoluciones where id_adopcion='" & adop & "'"
                Adodc1.Recordset!f_devolucion = Text4.Text
                Adodc1.Recordset!motivos_devolucion = Text5.Text
                Adodc1.Recordset.Update
                frmMascotas.Adodc1.RecordSource = "select * from mascotas where nombre_mascota='" & mascota & "'"
                frmMascotas.Adodc1.Refresh
                frmMascotas.Adodc1.Recordset!id_estado = "6"
                frmMascotas.Adodc1.Recordset.Update
                MsgBox ("Devolucion Registrada")
            End If
            End If
        End If
        MsgBox ("Registro de Adopcion actualizado")
    End If
End If
End Sub
Private Sub Command4_Click()
Unload Me
frmMenuOpciones.Show
End Sub
Private Sub Form_Load()
Dim mascota, persona, Adopcion As String
Dim num As Integer
Dim registros As Variant
Adodc1.RecordSource = "select distinct mascotas.nombre_mascota from mascotas inner join entrevista on mascotas.id_mascota=CAST(entrevista.id_mascota AS INTEGER) inner join persona on persona.id_persona=CAST(entrevista.id_persona AS INTEGER) inner join adopciones on entrevista.id_entrevista=CAST(adopciones.id_entrevista as INTEGER) ORDER BY mascotas.nombre_mascota ASC"
frmMascotas.Refresh
With Adodc1.Recordset
    Do Until .EOF
         Combo1.AddItem Adodc1.Recordset!nombre_mascota
        .MoveNext
    Loop
End With
Combo3.Enabled = False
Combo4.Enabled = False
Combo5.Enabled = False
Combo6.Enabled = False
Combo7.Enabled = False
Text1.Enabled = False
Text2.Enabled = False
Text3.Enabled = False
Text4.Enabled = False
Text5.Enabled = False
Text6.Enabled = False
Text7.Enabled = False
Text8.Enabled = False
Option3.Enabled = False
Option4.Enabled = False
Option5.Enabled = False
Option6.Enabled = False
Option7.Enabled = False
Option8.Enabled = False
Picture1.Enabled = False
Picture2.Enabled = False
Picture3.Enabled = False
Picture4.Enabled = False
MonthView2.Visible = False
MonthView4.Visible = False
MonthView1.Visible = False
MonthView3.Visible = False
End Sub
Private Sub MonthView1_DateClick(ByVal DateClicked As Date)
Text1.Text = MonthView1.Value
MonthView1.Visible = False
End Sub
Private Sub MonthView2_DateClick(ByVal DateClicked As Date)
Text3.Text = MonthView2.Value
MonthView2.Visible = False
End Sub
Private Sub MonthView3_DateClick(ByVal DateClicked As Date)
Text4.Text = MonthView3.Value
MonthView3.Visible = False
End Sub
Private Sub MonthView4_DateClick(ByVal DateClicked As Date)
Text8.Text = MonthView4.Value
MonthView4.Visible = False
End Sub
Private Sub Option7_Click()
Text4.Enabled = True
End Sub
Private Sub Picture1_Click()
MonthView1.Visible = True
End Sub
Private Sub Picture2_Click()
MonthView2.Visible = True
End Sub

Private Sub Picture3_Click()
MonthView3.Visible = True
End Sub
Private Sub Picture4_Click()
MonthView4.Visible = True
End Sub







'3.	frmApadriamientos
Option Explicit
Private Sub cmdAdd_Click()
Dim i As Integer
Combo2.Enabled = True
Combo3.Enabled = True
Combo4.Enabled = True
txtFields(3).Enabled = True
txtFields(4).Enabled = False
txtFields(5).Enabled = False
txtFields(6).Enabled = True
txtFields(9).Enabled = True
txtFields(11).Enabled = True
i = 1
Do Until i = 30
     Combo2.AddItem (i)
        i = i + 1
Loop
Combo3.AddItem "Compartido"
Combo3.AddItem "Directo Albergue"
Combo3.AddItem "Directo Matchcota"
Combo3.AddItem "Único"
Combo4.AddItem "Si"
Combo4.AddItem "No"
Text1.Enabled = True
Save = 12
End Sub
Private Sub cmdClose_Click()
Unload Me
frmMenuOpciones.Show
 End Sub
Private Sub cmdUpdate_Click()
Dim Max As Integer
Dim id_persona, id_mascota, mascota, persona As String
mascota = Combo1.Text
persona = Combo5.Text
If Save = 11 Then
frmAdopciones.Adodc1.RecordSource = "Select Max(id_apadrinamiento) from apadrinamientos"
frmAdopciones.Adodc1.Refresh
Max = frmAdopciones.Adodc1.Recordset!Max
frmAdopciones.Adodc1.RecordSource = "Select id_mascota from mascotas where nombre_mascota='"& Combo1.Text & "'"
frmAdopciones.Adodc1.Refresh
id_mascota = CStr(frmAdopciones.Adodc1.Recordset!id_mascota)
frmAdopciones.Adodc1.RecordSource = "Select id_persona from persona where nombre='" & Combo5.Text & "'"
frmAdopciones.Adodc1.Refresh
id_persona = CStr(frmAdopciones.Adodc1.Recordset!id_persona)
frmAdopciones.Adodc1.Recordset.AddNew
frmAdopciones.Adodc1.Recordset!id_apadronamiento = Max + 1
frmAdopciones.Adodc1.Recordset!id_persona = id_persona
frmAdopciones.Adodc1.Recordset!id_mascota = id_mascota
frmAdopciones.Adodc1.Recordset!nom_correos = txtFields(3)
frmAdopciones.Adodc1.Recordset!f_inicio = txtFields(4)
frmAdopciones.Adodc1.Recordset!f_fin = txtFields(5)
frmAdopciones.Adodc1.Recordset!dia_pago = Combo2.Text
frmAdopciones.Adodc1.Recordset!comp_pago = txtFields(6)
frmAdopciones.Adodc1.Recordset!t_ingreso = Combo3.Text
frmAdopciones.Adodc1.Recordset!deb_aut = Combo4.Text
frmAdopciones.Adodc1.Recordset!comentarios = txtFields(9)
frmAdopciones.Adodc1.Recordset!reg_trans = txtFields(11)
frmAdopciones.Adodc1.Recordset!pag_prom_men = Text1.Text
frmAdopciones.Adodc1.Recordset.Update
Else
    If Save = 12 Then
        frmAdopciones.Adodc1.RecordSource = "Select id_apadrinamiento from apadrinamientos inner join persona on persona.id_persona=CAST(apadrinamientos.id_persona as integer) inner join mascotas on mascotas.id_mascota=cast(apadrinamientos.id_mascota as integer) where persona.nombre='" & persona & "' and mascotas.nombre_mascota='" & mascota & "'"
        frmAdopciones.Adodc1.Refresh
        frmAdopciones.Adodc1.Recordset!nom_correos = txtFields(3)
        frmAdopciones.Adodc1.Recordset!f_inicio = txtFields(4)
        frmAdopciones.Adodc1.Recordset!f_fin = txtFields(5)
        frmAdopciones.Adodc1.Recordset!dia_pago = Combo2.Text
        frmAdopciones.Adodc1.Recordset!comp_pago = txtFields(6)
        frmAdopciones.Adodc1.Recordset!t_ingreso = Combo3.Text
        frmAdopciones.Adodc1.Recordset!deb_aut = Combo4.Text
        frmAdopciones.Adodc1.Recordset!comentarios = txtFields(9)
        frmAdopciones.Adodc1.Recordset!reg_trans = txtFields(11)
        frmAdopciones.Adodc1.Recordset!pag_prom_men = Text1.Text
        frmAdopciones.Adodc1.Recordset.Update
    End If
End If
End Sub

Private Sub Combo1_Click()
Dim id_mascota, id_persona As String
frmAdopciones.Adodc1.RecordSource = "Select id_mascota from mascotas where nombre_mascota='"& Combo1.Text & "'"
frmAdopciones.Adodc1.Refresh
id_mascota = CStr(frmAdopciones.Adodc1.Recordset!id_mascota)
frmAdopciones.Adodc1.RecordSource = "Select  apadrinamientos.id_persona,apadrinamientos.id_mascota, persona.nombre, mascotas.nombre_mascota from apadrinamientos inner join mascotas on mascotas.id_mascota=CAST(apadrinamientos.id_mascota as integer) inner join persona on persona.id_persona=CAST(apadrinamientos.id_persona as integer) where apadrinamientos.id_mascota='" & id_mascota & "'"
frmAdopciones.Adodc1.Refresh
Combo5.Clear
With frmAdopciones.Adodc1.Recordset
     Do Until .EOF
      Combo5.AddItem frmAdopciones.Adodc1.Recordset!nombre
     .MoveNext
     Loop
End With
End Sub
Private Sub Combo5_Click()
Dim id_persona, id_mascota As String
frmAdopciones.Adodc1.RecordSource = "Select id_mascota from mascotas where nombre_mascota='" & Combo1.Text & "'"
frmAdopciones.Adodc1.Refresh
id_mascota = CStr(frmAdopciones.Adodc1.Recordset!id_mascota)
frmAdopciones.Adodc1.RecordSource = "Select id_persona from persona where nombre='" & Combo5.Text & "'"
frmAdopciones.Adodc1.Refresh
id_persona = CStr(frmAdopciones.Adodc1.Recordset!id_persona)
frmAdopciones.Adodc1.RecordSource = "Select * from apadrinamientos where id_persona='" & id_persona & "' and id_mascota='" & id_mascota & "'"
frmAdopciones.Adodc1.Refresh
If IsNull(frmAdopciones.Adodc1.Recordset!nom_correos) = True Or frmAdopciones.Adodc1.Recordset!nom_correos = "" Then
    txtFields(3).Text = ""
Else
    txtFields(3).Text = frmAdopciones.Adodc1.Recordset!nom_correos
End If
If IsNull(frmAdopciones.Adodc1.Recordset!f_inicio) = True Or frmAdopciones.Adodc1.Recordset!f_inicio = "" Then
    txtFields(4).Text = ""
Else
    txtFields(4).Text = Format$(frmAdopciones.Adodc1.Recordset!f_inicio, "dd/mm/yyyy")
End If
If IsNull(frmAdopciones.Adodc1.Recordset!f_fin) = True Or frmAdopciones.Adodc1.Recordset!f_fin = "" Then
    txtFields(5).Text = ""
Else
    txtFields(5).Text = Format$(frmAdopciones.Adodc1.Recordset!f_fin, "dd/mm/yyyy")
End If
If frmAdopciones.Adodc1.Recordset!dia_pago = True Or frmAdopciones.Adodc1.Recordset!dia_pago = "" Then
    Combo2.Text = ""
Else
    Combo2.Text = frmAdopciones.Adodc1.Recordset!dia_pago
End If
If IsNull(frmAdopciones.Adodc1.Recordset!comp_pago) = True Or frmAdopciones.Adodc1.Recordset!comp_pago = "" Then
    txtFields(6).Text = ""
Else
    txtFields(6).Text = frmAdopciones.Adodc1.Recordset!comp_pago
End If
If IsNull(frmAdopciones.Adodc1.Recordset!t_ingreso) = True Or frmAdopciones.Adodc1.Recordset!t_ingreso = "" Then
    Combo3.Text = ""
Else
    Combo3.Text = frmAdopciones.Adodc1.Recordset!t_ingreso
End If
If IsNull(frmAdopciones.Adodc1.Recordset!deb_aut) = True Or frmAdopciones.Adodc1.Recordset!deb_aut = "" Then
    Combo4.Text = ""
Else
    Combo4.Text = frmAdopciones.Adodc1.Recordset!deb_aut
End If
If IsNull(frmAdopciones.Adodc1.Recordset!reg_trans) = True Or frmAdopciones.Adodc1.Recordset!reg_trans = "" Then
    txtFields(11).Text = ""
Else
    txtFields(11).Text = frmAdopciones.Adodc1.Recordset!reg_trans
End If
If IsNull(frmAdopciones.Adodc1.Recordset!comentarios) = True Or frmAdopciones.Adodc1.Recordset!comentarios = "" Then
    txtFields(9).Text = ""
Else
    txtFields(9).Text = frmAdopciones.Adodc1.Recordset!comentarios
End If
If IsNull(frmAdopciones.Adodc1.Recordset!pag_prom_men) = True Or frmAdopciones.Adodc1.Recordset!pag_prom_men = "" Then
    Text1.Text = ""
Else
    Text1.Text = frmAdopciones.Adodc1.Recordset!pag_prom_men
End If
End Sub
Private Sub Command1_Click()
Dim i As Integer
Combo1.Clear
Combo2.Enabled = True
Combo2.Clear
Combo3.Enabled = True
Combo3.Clear
Combo4.Enabled = True
Combo4.Clear
Combo5.Clear
txtFields(3).Enabled = True
txtFields(4).Enabled = True
txtFields(5).Enabled = True
txtFields(6).Enabled = True
txtFields(9).Enabled = True
txtFields(11).Enabled = True
txtFields(3).Text = ""
txtFields(4).Text = ""
txtFields(5).Text = ""
txtFields(6).Text = ""
txtFields(9).Text = ""
txtFields(11).Text = ""
Text1.Text = ""
Text1.Enabled = True
Picture1.Enabled = True
Picture2.Enabled = True
Save = 11
frmAdopciones.Adodc1.RecordSource = "select nombre_mascota from mascotas"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
    Do Until .EOF
       Combo1.AddItem frmAdopciones.Adodc1.Recordset!nombre_mascota
        .MoveNext
 Loop
End With
frmAdopciones.Adodc1.RecordSource = "select nombre from persona"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
    Do Until .EOF
      Combo5.AddItem frmAdopciones.Adodc1.Recordset!nombre
        .MoveNext
  Loop
End With
i = 1
Do Until i = 31
       Combo2.AddItem (i)
        i = i + 1
Loop
Combo3.AddItem "Compartido"
Combo3.AddItem "Directo Albergue"
Combo3.AddItem "Directo Matchcota"
Combo3.AddItem "Único"
Combo4.AddItem "Si"
Combo4.AddItem "No"
End SubPrivate Sub Form_Load()
Combo2.Enabled = False
Combo3.Enabled = False
Combo4.Enabled = False
txtFields(3).Enabled = False
txtFields(4).Enabled = False
txtFields(5).Enabled = False
txtFields(6).Enabled = False
txtFields(9).Enabled = False
txtFields(11).Enabled = False
Text1.Enabled = False
frmAdopciones.Adodc1.RecordSource = "Select  distinct mascotas.nombre_mascota fromapadrinamientos inner join mascotas on mascotas.id_mascota=CAST(apadrinamientos.id_mascota as in teger) inner join persona on persona.id_persona=CAST(apadrinamientos.id_persona as integer) order by mascotas.nombre_mascota asc"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
    Do Until .EOF
        Combo1.AddItem frmAdopciones.Adodc1.Recordset!nombre_mascota
        .MoveNext
    Loop
End With
End Sub
Private Sub MonthView1_DateClick(ByVal DateClicked As Date)
txtFields(5).Text = MonthView1.Value
MonthView1.Visible = False
End Sub
Private Sub MonthView2_DateClick(ByVal DateClicked As Date)
txtFields(4).Text = MonthView2.Value
MonthView2.Visible = False
End Sub
Private Sub Picture1_Click()
MonthView2.Visible = True
End Sub
Private Sub Picture2_Click()
MonthView1.Visible = True
End Sub



'4.	frmEntrevistas
Private Sub cmdAdd_Click()
Dim personas, mascota, entrevistador As String
Dim id_persona, id_mascota, id_entrevista, id_equipo As Integer
mascota = Combo_mascota.Text
personas = Combo_entrevistado.Text
entrevistador = Combo_entrevistador.Text
If Save = 5 Then
If Combo_mascota.Text = "" And Combo_entrevistado.Text = "" And Combo_entrevistador.Text = "" And Combo_aprobado.Text = "" And _
Combo_puntuacion.Text = "" And txtFields(7).Text = "" And txtFields(3).Text = "" Then
    MsgBox ("Llene todos los campos obligatorios")
Else
frmMascotas.Adodc1.RecordSource = "Select id_persona from persona where nombre='" & personas & "'"
frmMascotas.Adodc1.Refresh
id_persona = frmMascotas.Adodc1.Recordset!id_persona
frmMascotas.Adodc1.RecordSource = "Select id_mascota from mascotas where nombre_mascota='" & mascota & "'"
frmMascotas.Adodc1.Refresh
id_mascota = frmMascotas.Adodc1.Recordset!id_mascota
frmMascotas.Adodc1.RecordSource = "Select id_equipo from equipo_matchcota where nombre_equipo='" & entrevistador & "'"
frmMascotas.Adodc1.Refresh
id_equipo = frmMascotas.Adodc1.Recordset!id_equipo
frmMascotas.Adodc1.RecordSource = "SELECT MAX(id_entrevista) FROM entrevista"
frmMascotas.Adodc1.Refresh
id_entrevista = frmMascotas.Adodc1.Recordset!Max + 1
frmMascotas.Adodc1.RecordSource = "Select * from entrevista"
frmMascotas.Adodc1.Refresh
frmMascotas.Adodc1.Recordset.AddNew
frmMascotas.Adodc1.Recordset!id_entrevista = id_entrevista
frmMascotas.Adodc1.Recordset!id_persona = id_persona
frmMascotas.Adodc1.Recordset!id_mascota = id_mascota
frmMascotas.Adodc1.Recordset!id_equipo = id_equipo
frmMascotas.Adodc1.Recordset!f_entrevista = txtFields(3).Text
frmMascotas.Adodc1.Recordset!resultado = Combo_aprobado.Text
frmMascotas.Adodc1.Recordset!puntuacion = Combo_puntuacion
frmMascotas.Adodc1.Recordset!comentarios = txtFields(7).Text
frmMascotas.Adodc1.Recordset.Update
MsgBox ("Entrevista guardada")
End If
Else
    If Save = 6 Then
frmMascotas.Adodc1.RecordSource = "Select id_persona from persona where nombre='" & personas & "'"
frmMascotas.Adodc1.Refresh
id_persona = frmMascotas.Adodc1.Recordset!id_persona
frmMascotas.Adodc1.RecordSource = "Select id_mascota from mascotas where nombre_mascota='" & mascota & "'"
frmMascotas.Adodc1.Refresh
id_mascota = frmMascotas.Adodc1.Recordset!id_mascota
frmMascotas.Adodc1.RecordSource = "Select id_equipo from equipo_matchcota where nombre_equipo='" & entrevistador & "'"
frmMascotas.Adodc1.Refresh
id_equipo = frmMascotas.Adodc1.Recordset!id_equipo
frmMascotas.Adodc1.RecordSource = "Select * from entrevista where id_persona='" & id_persona & "' and id_mascota='" & id_mascota & "'"
frmMascotas.Adodc1.Refresh
frmMascotas.Adodc1.Recordset!id_persona = CStr(id_persona)
frmMascotas.Adodc1.Recordset!id_mascota = CStr(id_mascota)
frmMascotas.Adodc1.Recordset!id_equipo = CStr(id_equipo)
frmMascotas.Adodc1.Recordset!f_entrevista = txtFields(3).Text
frmMascotas.Adodc1.Recordset!resultado = Combo_aprobado.Text
frmMascotas.Adodc1.Recordset!puntuacion = Combo_puntuacion.Text
frmMascotas.Adodc1.Recordset!comentarios = txtFields(7).Text
frmMascotas.Adodc1.Recordset.Update
MsgBox ("Entrevista actualizada")
End If
End If
End Sub
Private Sub cmdClose_Click()
Unload Me
frmMenuOpciones.Show
End Sub
Private Sub cmdUpdate_Click()
Dim i As Integer
Combo_entrevistador.Enabled = True
Combo_aprobado.Enabled = True
Combo_puntuacion.Enabled = True
txtFields(7).Enabled = True
txtFields(3).Enabled = False
Picture1.Enabled = True
MonthView1.Visible = False
frmMascotas.Adodc1.RecordSource = "select nombre from persona"
frmMascotas.Adodc1.Refresh
With frmMascotas.Adodc1.Recordset
    Do Until .EOF
        Combo_entrevistado.AddItem frmMascotas.Adodc1.Recordset!nombre
        .MoveNext
    Loop
End With
i = 0
Do Until i = 11
        Combo_puntuacion.AddItem (i)
        i = i + 1
Loop
Combo_aprobado.AddItem "Aprobado"
Combo_aprobado.AddItem "Desaprobado"
Save = 6
End Sub
Private Sub Combo_entrevistado_Click()
Dim valor, id_mascota, id_persona, mascota, persona As String
Dim id_entrevistador As Integer
mascota = Combo_mascota.Text
persona = Combo_entrevistado.Text
frmMascotas.Adodc1.RecordSource = "select id_mascota from mascotas where nombre_mascota='" & mascota & "'"
frmMascotas.Adodc1.Refresh
id_mascota = CStr(frmMascotas.Adodc1.Recordset!id_mascota)
frmMascotas.Adodc1.RecordSource = "select id_persona from persona where nombre='" & persona & "'"
frmMascotas.Adodc1.Refresh
id_persona = CStr(frmMascotas.Adodc1.Recordset!id_persona)
frmMascotas.Adodc1.RecordSource = "select * from entrevista where id_mascota='" & id_mascota & "' and id_persona='" & id_persona & "'"
frmMascotas.Adodc1.Refresh
     If frmMascotas.Adodc1.Recordset.EOF = True Then
        txtFields(3).Text = ""
        Combo_aprobado.Enabled = True
        Combo_aprobado.Clear
        Combo_aprobado.AddItem "Aprobado"
        Combo_aprobado.AddItem "No Aprobado"
        Combo_puntuacion.Clear
        Combo_puntuacion.Enabled = True
        i = 1
        Do Until i = 10
            Combo_puntuacion.AddItem (i)
            i = i + 1
        Loop
        txtFields(7).Enabled = True
        txtFields(7).Text = ""
        txtFields(3).Enabled = True
        txtFields(3).Text = ""
        Picture1.Enabled = True

        Save = 5
     Else
        
        If IsNull(frmMascotas.Adodc1.Recordset!f_entrevista) = True Or frmMascotas.Adodc1.Recordset!f_entrevista = "" Then
 txtFields(3).Text = ""
        Else
            txtFields(3).Text = Format$(frmMascotas.Adodc1.Recordset!f_entrevista, "dd/mm/yyyy")
        End If
        If IsNull(frmMascotas.Adodc1.Recordset!resultado) = True Or frmMascotas.Adodc1.Recordset!resultado = "" Then
            Combo_aprobado.AddItem ""
        Else
            Combo_aprobado.AddItem frmMascotas.Adodc1.Recordset!resultado
            Combo_aprobado.ListIndex = 0
        End If
        If IsNull(frmMascotas.Adodc1.Recordset!puntuacion) = True Or frmMascotas.Adodc1.Recordset!puntuacion = "" Then
            Combo_puntuacion.AddItem ""
        Else
            Combo_puntuacion.AddItem frmMascotas.Adodc1.Recordset!puntuacion
            Combo_puntuacion.ListIndex = 0
        End If
        If IsNull(frmMascotas.Adodc1.Recordset!comentarios) = True Or frmMascotas.Adodc1.Recordset!comentarios = "" Then
            txtFields(7).Text = ""
        Else
            txtFields(7).Text = frmMascotas.Adodc1.Recordset!comentarios
        End If
        If IsNull(frmMascotas.Adodc1.Recordset!id_equipo) = True Or frmMascotas.Adodc1.Recordset!id_equipo = "" Then
            Combo_entrevistador.AddItem ""
        Else
            id_entrevistador = CInt(frmMascotas.Adodc1.Recordset!id_equipo)
            frmMascotas.Adodc1.RecordSource = "Select nombre_equipo from equipo_matchcota where id_equipo=" & id_entrevistador
            frmMascotas.Adodc1.Refresh
            Combo_entrevistador.AddItem frmMascotas.Adodc1.Recordset!nombre_equipo
            Combo_entrevistador.ListIndex = 0
        End If
    End If

End Sub
Private Sub Combo_mascota_Click()
Dim valor, id_mascota, id_persona As String
Dim id_entrevistador As Integer
mascota = Combo_mascota.Text
frmMascotas.Adodc1.RecordSource = "select id_mascota from mascotas where nombre_mascota='" & mascota & "'"
frmMascotas.Adodc1.Refresh
id_mascota = frmMascotas.Adodc1.Recordset!id_mascota
frmMascotas.Adodc1.RecordSource = "select persona.nombre, persona.id_persona from mascotas inner join entrevista on mascotas.id_mascota=CAST(entrevista.id_mascota AS Integer) inner join persona on persona.id_persona=CAST(entrevista.id_persona as integer) where mascotas.id_mascota=" & id_mascota
frmMascotas.Adodc1.Refresh
    If frmMascotas.Adodc1.Recordset.Fields.Count > 1 Then
        With frmMascotas.Adodc1.Recordset
            Do Until .EOF
                Combo_entrevistado.AddItem frmMascotas.Adodc1.Recordset!nombre
                .MoveNext
            Loop
        End With
    Else
        id_persona = CStr(frmMascotas.Adodc1.Recordset!id_persona)
    End If
End Sub
Private Sub Command1_Click()
frmMascotas.Adodc1.RecordSource = "select nombre_mascota from mascotas where id_estado='4' or id_estado='6' or id_estado='7' order by nombre_mascota"
frmMascotas.Adodc1.Refresh
Combo_mascota.Clear
Combo_entrevistado.Clear
Combo_entrevistador.Clear
With frmMascotas.Adodc1.Recordset
    Do Until .EOF
        Combo_mascota.AddItem frmMascotas.Adodc1.Recordset!nombre_mascota
        .MoveNext
    Loop
End With
frmMascotas.Adodc1.RecordSource = "Select nombre from persona"
frmMascotas.Adodc1.Refresh
With frmMascotas.Adodc1.Recordset
    Do Until .EOF
        Combo_entrevistado.AddItem frmMascotas.Adodc1.Recordset!nombre
        .MoveNext
    Loop
End With
Combo_entrevistador.Enabled = True
frmMascotas.Adodc1.RecordSource = "Select nombre_equipo from equipo_matchcota"
frmMascotas.Adodc1.Refresh
With frmMascotas.Adodc1.Recordset
    Do Until .EOF
        Combo_entrevistador.AddItem frmMascotas.Adodc1.Recordset!nombre_equipo
        .MoveNext
    Loop
End With
Combo_aprobado.Enabled = True
Combo_aprobado.AddItem "Aprobado"
Combo_aprobado.AddItem "No Aprobado"
Combo_puntuacion.Enabled = True
i = 1
Do Until i = 10
        Combo_puntuacion.AddItem (i)
        i = i + 1
Loop
txtFields(7).Enabled = True
txtFields(7).Text = ""
txtFields(3).Enabled = True
txtFields(3).Text = ""
Picture1.Enabled = True
Save = 5
End Sub
Private Sub Command2_Click()
frmAdopciones.Show
frmEntrevistas.Hide
End Sub
Private Sub Form_Load()
Dim id_mascota As Integer
Dim mascota As String
frmMascotas.Adodc1.RecordSource = "select distinct mascotas.nombre_mascota from mascotas inner join entrevista on mascotas.id_mascota=CAST(entrevista.id_mascota AS Integer) inner join persona on persona.id_persona=CAST(entrevista.id_persona as integer) order by mascotas.nombre_mascota asc"
frmMascotas.Adodc1.Refresh
With frmMascotas.Adodc1.Recordset
    Do Until .EOF
        Combo_mascota.AddItem frmMascotas.Adodc1.Recordset!nombre_mascota
        .MoveNext
    Loop
End With
Combo_entrevistador.Enabled = False
Combo_aprobado.Enabled = False
Combo_puntuacion.Enabled = False
txtFields(7).Enabled = False
txtFields(3).Enabled = False
Picture1.Enabled = False
MonthView1.Visible = False
End Sub
Private Sub MonthView1_DateClick(ByVal DateClicked As Date)
txtFields(3).Text = MonthView1.Value
MonthView1.Visible = False
End Sub
Private Sub Picture1_Click()
MonthView1.Visible = True
End Sub






'5.	frmEquipoMatchcota
Private Sub cmdAdd_Click()
Combo2.Enabled = True
Combo3.Enabled = True
txtFields(1).Enabled = True
txtFields(2).Enabled = True
txtFields(3).Enabled = True
txtFields(5).Enabled = True
txtFields(6).Enabled = True
txtFields(7).Enabled = True
txtFields(8).Enabled = True
txtFields(9).Enabled = True
txtFields(10).Enabled = True
txtFields(11).Enabled = True
txtFields(13).Enabled = True
txtFields(14).Enabled = True
txtFields(17).Enabled = True
txtFields(18).Enabled = True
Option1.Enabled = True
Option2.Enabled = True
Option3.Enabled = True
Option4.Enabled = True
Picture1.Enabled = True
Picture2.Enabled = True
Picture3.Enabled = True
frmAdopciones.Adodc1.RecordSource = "Select puesto from detalle_puesto"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
    Do Until .EOF
        Combo3.AddItem frmAdopciones.Adodc1.Recordset!puesto
        .MoveNext
Loop
End With
frmAdopciones.Adodc1.RecordSource = "Select nombre_distrito from distrito"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
    Do Until .EOF
        Combo2.AddItem frmAdopciones.Adodc1.Recordset!nombre_distrito
        .MoveNext
Loop
End With
Save = 14
End Sub
Private Sub cmdUpdate_Click()
Dim reg As Integer
Dim id_distrito, id_detalle_puesto As String
frmAdopciones.Adodc1.RecordSource = "Select id_distrito from distrito where nombre_distrito='" & Combo3.Text & "'"
frmAdopciones.Adodc1.Refresh
id_distrito = frmAdopciones.Adodc1.Recordset!id_distrito
frmAdopciones.Adodc1.RecordSource = "Select id_detalle_puesto from distrito where puesto='" & Combo2.Text & "'"
frmAdopciones.Adodc1.Refresh
id_detalle_puesto = frmAdopciones.Adodc1.Recordset!id_detalle_puesto
If Save = 13 Then
frmAdopciones.Adodc1.RecordSource = "Select Max(id_equipo) from equipo_matchcota"
frmAdopciones.Adodc1.Refresh
reg = frmAdopciones.Adodc1.Recordset!Max + 1
frmAdopciones.Adodc1.RecordSource = "Select * from equipo_matchcota"
frmAdopciones.Adodc1.Refresh
frmAdopciones.Adodc1.Recordset.AddNew
frmAdopciones.Adodc1.Recordset!id_equipo = reg
frmAdopciones.Adodc1.Recordset!id_distrito = id_distrito
frmAdopciones.Adodc1.Recordset!id_detalle_puesto = id_detalle_puesto
frmAdopciones.Adodc1.Recordset!dni = txtFields(1).Text
frmAdopciones.Adodc1.Recordset!condicion = txtFields(2).Text
frmAdopciones.Adodc1.Recordset!email = txtFields(3).Text
frmAdopciones.Adodc1.Recordset!tel_celular = txtFields(5).Text
frmAdopciones.Adodc1.Recordset!email_matchcota = txtFields(6).Text
frmAdopciones.Adodc1.Recordset!f_nacimiento = txtFields(7).Text
frmAdopciones.Adodc1.Recordset!whatsapp = txtFields(8).Text
frmAdopciones.Adodc1.Recordset!direccion = txtFields(9).Text
frmAdopciones.Adodc1.Recordset!nacionalidad = txtFields(10).Text
frmAdopciones.Adodc1.Recordset!estudios_cursados = txtFields(11).Text
frmAdopciones.Adodc1.Recordset!ocupacion = txtFields(13).Text
frmAdopciones.Adodc1.Recordset!empresa = txtFields(14).Text
frmAdopciones.Adodc1.Recordset!f_cese = txtFields(17).Text
frmAdopciones.Adodc1.Recordset!f_ingreso = txtFields(18).Text
If Option1.Value = True Then
 frmAdopciones.Adodc1.Recordset!f_ingreso = "Si"
Else
    If Option2.Value = True Then
        frmAdopciones.Adodc1.Recordset!f_ingreso = "No"
    End If
End If
If Option3.Value = True Then
    frmAdopciones.Adodc1.Recordset!visito_albergue = "Si"
Else
    If Option4.Value = True Then
        frmAdopciones.Adodc1.Recordset!visito_albergue = "No"
    End If
End If
frmAdopciones.Adodc1.Recordset.Update
Else
    If Save = 14 Then
    frmAdopciones.Adodc1.RecordSource = "Select * from equipo_matchcota where nombre_equipo='" & Combo1.Text & "'"
    frmAdopciones.Adodc1.Refresh
    frmAdopciones.Adodc1.Recordset!id_distrito = id_distrito
    frmAdopciones.Adodc1.Recordset!id_detalle_puesto = id_detalle_puesto
    frmAdopciones.Adodc1.Recordset!dni = txtFields(1).Text
    frmAdopciones.Adodc1.Recordset!condicion = txtFields(2).Text
    frmAdopciones.Adodc1.Recordset!email = txtFields(3).Text
    frmAdopciones.Adodc1.Recordset!tel_celular = txtFields(5).Text
    frmAdopciones.Adodc1.Recordset!email_matchcota = txtFields(6).Text
    frmAdopciones.Adodc1.Recordset!f_nacimiento = txtFields(7).Text
    frmAdopciones.Adodc1.Recordset!whatsapp = txtFields(8).Text
    frmAdopciones.Adodc1.Recordset!direccion = txtFields(9).Text
    frmAdopciones.Adodc1.Recordset!nacionalidad = txtFields(10).Text
    frmAdopciones.Adodc1.Recordset!estudios_cursados = txtFields(11).Text
    frmAdopciones.Adodc1.Recordset!ocupacion = txtFields(13).Text
    frmAdopciones.Adodc1.Recordset!empresa = txtFields(14).Text
    frmAdopciones.Adodc1.Recordset!f_cese = txtFields(17).Text
    frmAdopciones.Adodc1.Recordset!f_ingreso = txtFields(18).Text
    frmAdopciones.Adodc1.Recordset.Update
    End If
End If
End Sub
Private Sub cmdClose_Click()
Unload Me
frmMenuOpciones.Show
End Sub
Private Sub Combo1_Click()
frmAdopciones.Adodc1.RecordSource = "select * from equipo_matchcota where nombre_equipo='" & Combo1.Text & "'"
frmAdopciones.Adodc1.Refresh
If IsNull(frmAdopciones.Adodc1.Recordset!dni) = True Or frmAdopciones.Adodc1.Recordset!dni = "" Then
    txtFields(1).Text = ""
Else
    txtFields(1).Text = frmAdopciones.Adodc1.Recordset!dni
End If
If IsNull(frmAdopciones.Adodc1.Recordset!condicion) = True Or frmAdopciones.Adodc1.Recordset!condicion = "" Then
    txtFields(2).Text = ""
Else
    txtFields(2).Text = frmAdopciones.Adodc1.Recordset!condicion
End If
If IsNull(frmAdopciones.Adodc1.Recordset!email) = True Or frmAdopciones.Adodc1.Recordset!email = "" Then
    txtFields(3).Text = ""
Else
    txtFields(3).Text = frmAdopciones.Adodc1.Recordset!email
End If
If IsNull(frmAdopciones.Adodc1.Recordset!tel_celular) = True Or frmAdopciones.Adodc1.Recordset!tel_celular = "" Then
    txtFields(5).Text = ""
Else
    txtFields(5).Text = frmAdopciones.Adodc1.Recordset!tel_celular
End If
If IsNull(frmAdopciones.Adodc1.Recordset!email_matchcota) = True Or frmAdopciones.Adodc1.Recordset!email_matchcota = "" Then
    txtFields(6).Text = ""
Else
    txtFields(6).Text = frmAdopciones.Adodc1.Recordset!email_matchcota
End If
If IsNull(frmAdopciones.Adodc1.Recordset!f_nacimiento) = True Or frmAdopciones.Adodc1.Recordset!f_nacimiento = "" Then
    txtFields(7).Text = ""
Else
    txtFields(7).Text = frmAdopciones.Adodc1.Recordset!f_nacimiento
End If
If IsNull(frmAdopciones.Adodc1.Recordset!whatsapp) = True Or frmAdopciones.Adodc1.Recordset!whatsapp = "" Then
    txtFields(8).Text = ""
Else
    txtFields(8).Text = frmAdopciones.Adodc1.Recordset!whatsapp
End If
If IsNull(frmAdopciones.Adodc1.Recordset!direccion) = True Or frmAdopciones.Adodc1.Recordset!direccion = "" Then
    txtFields(9).Text = ""
Else
    txtFields(9).Text = frmAdopciones.Adodc1.Recordset!direccion
End If
If IsNull(frmAdopciones.Adodc1.Recordset!nacionalidad) = True Or frmAdopciones.Adodc1.Recordset!nacionalidad = "" Then
    txtFields(10).Text = ""
Else
    txtFields(10).Text = frmAdopciones.Adodc1.Recordset!nacionalidad
End If
If IsNull(frmAdopciones.Adodc1.Recordset!estudios_cursados) = True Or frmAdopciones.Adodc1.Recordset!estudios_cursados = "" Then
    txtFields(11).Text = ""
Else
    txtFields(11).Text = frmAdopciones.Adodc1.Recordset!estudios_cursados
End If
If IsNull(frmAdopciones.Adodc1.Recordset!ocupacion) = True Or frmAdopciones.Adodc1.Recordset!ocupacion = "" Then
    txtFields(13).Text = ""
Else
    txtFields(13).Text = frmAdopciones.Adodc1.Recordset!ocupacion
End If
If IsNull(frmAdopciones.Adodc1.Recordset!empresa) = True Or frmAdopciones.Adodc1.Recordset!empresa = "" Then
    txtFields(14).Text = ""
Else
    txtFields(14).Text = frmAdopciones.Adodc1.Recordset!empresa
End If
If IsNull(frmAdopciones.Adodc1.Recordset!f_cese) = True Or frmAdopciones.Adodc1.Recordset!f_cese = "" Then
    txtFields(17).Text = ""
Else
    txtFields(17).Text = frmAdopciones.Adodc1.Recordset!f_cese
End If
If IsNull(frmAdopciones.Adodc1.Recordset!f_ingreso) = True Or frmAdopciones.Adodc1.Recordset!f_ingreso = "" Then
    txtFields(18).Text = ""
Else
    txtFields(18).Text = frmAdopciones.Adodc1.Recordset!f_ingreso
End If
If frmAdopciones.Adodc1.Recordset!f_ingreso = "Si" Then
    Option1.Value = True
Else
     If frmAdopciones.Adodc1.Recordset!f_ingreso = "No" Then
        Option2.Value = True
    End If
End If
If frmAdopciones.Adodc1.Recordset!visito_albergue = "Si" Then
    Option3.Value = True
Else
    If frmAdopciones.Adodc1.Recordset!visito_albergue = "No" Then
        Option4.Value = True
    End If
End If
End Sub
Private Sub Command1_Click()
Combo1.Clear
Combo1.Enabled = True
Combo2.Enabled = True
Combo2.Clear
Combo3.Enabled = True
Combo3.Clear
txtFields(1).Enabled = True
txtFields(2).Enabled = True
txtFields(3).Enabled = True
txtFields(5).Enabled = True
txtFields(6).Enabled = True
txtFields(7).Enabled = False
txtFields(8).Enabled = True
txtFields(9).Enabled = True
txtFields(10).Enabled = True
txtFields(11).Enabled = True
txtFields(13).Enabled = True
txtFields(14).Enabled = True
txtFields(17).Enabled = True
txtFields(18).Enabled = True
txtFields(1).Text = ""
txtFields(2).Text = ""
txtFields(3).Text = ""
txtFields(5).Text = ""
txtFields(6).Text = ""
txtFields(7).Text = ""
txtFields(8).Text = ""
txtFields(9).Text = ""
txtFields(10).Text = ""
txtFields(11).Text = ""
txtFields(13).Text = ""
txtFields(14).Text = ""
txtFields(17).Text = ""
txtFields(18).Text = ""
Option1.Value = False
Option2.Value = False
Option3.Value = False
Option4.Value = False
Picture1.Enabled = True
Picture2.Enabled = True
Picture3.Enabled = True
frmAdopciones.Adodc1.RecordSource = "Select puesto from detalle_puesto"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
    Do Until .EOF
        Combo3.AddItem frmAdopciones.Adodc1.Recordset!puesto
        .MoveNext
Loop
End With
frmAdopciones.Adodc1.RecordSource = "Select nombre_distrito from distrito"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
    Do Until .EOF
        Combo2.AddItem frmAdopciones.Adodc1.Recordset!nombre_distrito
        .MoveNext
Loop
End With
Save = 13
End Sub
Private Sub Form_Load()
frmAdopciones.Adodc1.RecordSource = "select nombre_equipo from equipo_matchcota order by nombre_equipo asc"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
    Do Until .EOF
        Combo1.AddItem frmAdopciones.Adodc1.Recordset!nombre_equipo
        .MoveNext
Loop
End With
Combo2.Enabled = False
Combo3.Enabled = False
txtFields(1).Enabled = False
txtFields(2).Enabled = False
txtFields(3).Enabled = False
txtFields(5).Enabled = False
txtFields(6).Enabled = False
txtFields(7).Enabled = False
txtFields(8).Enabled = False
txtFields(9).Enabled = False
txtFields(10).Enabled = False
txtFields(11).Enabled = False
txtFields(13).Enabled = False
txtFields(14).Enabled = False
txtFields(17).Enabled = False
txtFields(18).Enabled = False
Option1.Enabled = False
Option2.Enabled = False
Option3.Enabled = False
Option4.Enabled = False
Picture1.Enabled = False
Picture2.Enabled = False
Picture3.Enabled = False
MonthView1.Visible = False
MonthView2.Visible = False
MonthView3.Visible = False
End Sub
Private Sub MonthView1_DateClick(ByVal DateClicked As Date)
txtFields(7).Text = MonthView1.Value
MonthView1.Visible = False
End Sub
Private Sub MonthView2_DateClick(ByVal DateClicked As Date)
txtFields(18).Text = MonthView2.Value
MonthView2.Visible = False
End Sub
Private Sub MonthView3_DateClick(ByVal DateClicked As Date)
txtFields(17).Text = MonthView3.Value
MonthView3.Visible = False
End Sub
Private Sub Picture1_Click()
MonthView1.Visible = True
End Sub
Private Sub Picture2_Click()
MonthView2.Visible = True
End Sub
Private Sub Picture3_Click()
MonthView3.Visible = True
End Sub






'6.	frmMantenimiento
Private Sub Check1_Click()
Check2.Value = 0
Check3.Value = 0
Check4.Value = 0
Check5.Value = 0
Check6.Value = 0
Frame1.Enabled = True
Frame2.Enabled = False
Frame3.Enabled = False
Frame4.Enabled = False
Frame5.Enabled = False
Frame6.Enabled = False
Combo3.Enabled = False
Combo4.Enabled = False
Combo5.Enabled = False
Combo6.Enabled = False
Combo7.Enabled = False
Combo2.Enabled = True
End Sub
Private Sub Check2_Click()
Check1.Value = 0
Check3.Value = 0
Check4.Value = 0
Check5.Value = 0
Check6.Value = 0
Frame1.Enabled = False
Frame2.Enabled = True
Frame3.Enabled = False
Frame4.Enabled = False
Frame5.Enabled = False
Frame6.Enabled = False
Combo2.Enabled = False
Combo4.Enabled = False
Combo5.Enabled = False
Combo6.Enabled = False
Combo7.Enabled = False
Combo3.Enabled = True
End Sub
Private Sub Check3_Click()
Check2.Value = 0
Check1.Value = 0
Check4.Value = 0
Check5.Value = 0
Check6.Value = 0
Frame1.Enabled = False
Frame3.Enabled = True
Frame2.Enabled = False
Frame4.Enabled = False
Frame5.Enabled = False
Frame6.Enabled = False
Combo2.Enabled = False
Combo3.Enabled = False
Combo5.Enabled = False
Combo6.Enabled = False
Combo7.Enabled = False
Combo4.Enabled = True
End Sub
Private Sub Check4_Click()
Check2.Value = 0
Check3.Value = 0
Check1.Value = 0
Check5.Value = 0
Check6.Value = 0
Frame1.Enabled = False
Frame4.Enabled = True
Frame2.Enabled = False
Frame3.Enabled = False
Frame5.Enabled = False
Frame6.Enabled = False
Combo2.Enabled = False
Combo4.Enabled = False
Combo3.Enabled = False
Combo6.Enabled = False
Combo7.Enabled = False
Combo5.Enabled = True
End Sub
Private Sub Check5_Click()
Check2.Value = 0
Check3.Value = 0
Check4.Value = 0
Check1.Value = 0
Check6.Value = 0
Frame1.Enabled = False
Frame5.Enabled = True
Frame2.Enabled = False
Frame4.Enabled = False
Frame6.Enabled = False
Frame3.Enabled = False
Combo2.Enabled = False
Combo4.Enabled = False
Combo5.Enabled = False
Combo3.Enabled = False
Combo7.Enabled = False
Combo6.Enabled = True
End Sub
Private Sub Check6_Click()
Check2.Value = 0
Check3.Value = 0
Check4.Value = 0
Check5.Value = 0
Check1.Value = 0
Frame1.Enabled = False
Frame6.Enabled = True
Frame2.Enabled = False
Frame4.Enabled = False
Frame5.Enabled = False
Frame3.Enabled = False
Combo2.Enabled = False
Combo4.Enabled = False
Combo5.Enabled = False
Combo6.Enabled = False
Combo3.Enabled = False
Combo7.Enabled = True
End Sub
Private Sub Combo2_Click()
frmAdopciones.Adodc1.RecordSource = "Select * from albergues where nombre_albergue='" & Combo2.Text & "'"
frmAdopciones.Adodc1.Refresh
If IsNull(frmAdopciones.Adodc1.Recordset!fecha_ingreso_matchcota) = True Or frmAdopciones.Adodc1.Recordset!fecha_ingreso_matchcota = "" Then
    Text2.Text = ""
Else
    Text2.Text = Format$(frmAdopciones.Adodc1.Recordset!fecha_ingreso_matchcota, "dd/mm/yyyy")
End If
If IsNull(frmAdopciones.Adodc1.Recordset!ciudad) = True Or frmAdopciones.Adodc1.Recordset!ciudad = "" Then
    Text1.Text = ""
Else
    Text1.Text = frmAdopciones.Adodc1.Recordset!ciudad
End If
If IsNull(frmAdopciones.Adodc1.Recordset!direccion) = True Or frmAdopciones.Adodc1.Recordset!direccion = "" Then
    txtFields(3).Text = ""
Else
    txtFields(3) = frmAdopciones.Adodc1.Recordset!direccion
End If
If IsNull(frmAdopciones.Adodc1.Recordset!referencia) = True Or frmAdopciones.Adodc1.Recordset!referencia = "" Then
   txtFields(5).Text = ""
Else
    txtFields(5) = frmAdopciones.Adodc1.Recordset!referencia
End If
If IsNull(frmAdopciones.Adodc1.Recordset!duena) = True Or frmAdopciones.Adodc1.Recordset!duena = "" Then
    txtFields(7).Text = ""
Else
    txtFields(7) = frmAdopciones.Adodc1.Recordset!duena
End If
If IsNull(frmAdopciones.Adodc1.Recordset!dias_atencion) = True Or frmAdopciones.Adodc1.Recordset!dias_atencion = "" Then
    txtFields(8).Text = ""
Else
txtFields(8) = frmAdopciones.Adodc1.Recordset!dias_atencion
End If
If IsNull(frmAdopciones.Adodc1.Recordset!responsable) = True Or frmAdopciones.Adodc1.Recordset!responsable = "" Then
    txtFields(9).Text = ""
Else
    txtFields(9) = frmAdopciones.Adodc1.Recordset!responsable
End If
If IsNull(frmAdopciones.Adodc1.Recordset!cuidador) = True Or frmAdopciones.Adodc1.Recordset!cuidador = "" Then
    txtFields(10).Text = ""
Else
    txtFields(10) = frmAdopciones.Adodc1.Recordset!cuidador
End If
If IsNull(frmAdopciones.Adodc1.Recordset!horario_atencion) = True Or frmAdopciones.Adodc1.Recordset!horario_atencion = "" Then
    txtFields(11).Text = ""
Else
    txtFields(11) = frmAdopciones.Adodc1.Recordset!horario_atencion
End If
frmAdopciones.Adodc1.RecordSource = "Select nombre_distrito from distrito"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
     Do Until .EOF
      Combo1.AddItem frmAdopciones.Adodc1.Recordset!nombre_distrito
     .MoveNext
     Loop
End With
End Sub
Private Sub Command1_Click()
If Check1.Value = 1 Then
Combo2.Clear
Text2.Enabled = False
Text1.Enabled = True
txtFields(3).Enabled = True
txtFields(5).Enabled = True
txtFields(7).Enabled = True
txtFields(8).Enabled = True
txtFields(9).Enabled = True
txtFields(10).Enabled = True
txtFields(11).Enabled = True
Combo1.Enabled = True
Text2.Text = ""
Text1.Text = ""
txtFields(3).Text = ""
txtFields(5).Text = ""
txtFields(7).Text = ""
txtFields(8).Text = ""
txtFields(9).Text = ""
txtFields(10).Text = ""
txtFields(11).Text = ""
Combo1.Clear
Save = 15
frmAdopciones.Adodc1.RecordSource = "Select nombre_distrito from distrito"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
     Do Until .EOF
      Combo1.AddItem frmAdopciones.Adodc1.Recordset!nombre_distrito
     .MoveNext
     Loop
End With
End If
If Check2.Value = 1 Then
Combo3.Clear
End If
If Check3.Value = 1 Then
Combo4.Clear
End If
If Check4.Value = 1 Then
Combo5.Clear
End If
If Check5.Value = 1 Then
Combo6.Clear
End If
If Check6.Value = 1 Then
Combo7.Clear
End If
End Sub
Private Sub Command2_Click()
Unload Me
frmMenuOpciones.Show
End Sub
Private Sub Command3_Click()
Text2.Enabled = True
Text1.Enabled = True
txtFields(3).Enabled = True
txtFields(5).Enabled = True
txtFields(7).Enabled = True
txtFields(8).Enabled = True
txtFields(9).Enabled = True
txtFields(10).Enabled = True
txtFields(11).Enabled = True
Combo1.Enabled = True
frmAdopciones.Adodc1.RecordSource = "Select nombre_distrito from distrito"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
     Do Until .EOF
      Combo1.AddItem frmAdopciones.Adodc1.Recordset!nombre_distrito
     .MoveNext
     Loop
End With
Save = 16
End Sub
Private Sub Command4_Click()
Dim id_distrito As String
Dim Max As Integer
If Check1.Value = 1 Then
    frmAdopciones.Adodc1.RecordSource = "Select id_distrito from distrito where nombre_distrito='" & Combo1.Text & "'"
    frmAdopciones.Adodc1.Refresh
    id_distrito = frmAdopciones.Adodc1.Recordset!id_distrito
    If Save = 15 Then
    frmAdopciones.Adodc1.RecordSource = "Select Max(id_albergue) from albergues"
    frmAdopciones.Adodc1.Refresh
    reg = frmAdopciones.Adodc1.Recordset!Max + 1
    frmAdopciones.Adodc1.RecordSource = "Select * from albergues"
 frmAdopciones.Adodc1.Refresh
    frmAdopciones.Adodc1.Recordset.AddNew
    frmAdopciones.Adodc1.Recordset!id_albergue = reg
    frmAdopciones.Adodc1.Recordset!nombre_albergue = Combo2.Text
    frmAdopciones.Adodc1.Recordset!ciudad = Text1.Text
    frmAdopciones.Adodc1.Recordset!direccion = txtFields(3).Text
    frmAdopciones.Adodc1.Recordset!id_distrito = id_distrito
    frmAdopciones.Adodc1.Recordset!referencia = txtFields(5).Text
    frmAdopciones.Adodc1.Recordset!duena = txtFields(7).Text
    frmAdopciones.Adodc1.Recordset!responsable = txtFields(9).Text
    frmAdopciones.Adodc1.Recordset!cuidador = txtFields(10).Text
    frmAdopciones.Adodc1.Recordset!horario_atencion = txtFields(11).Text
    frmAdopciones.Adodc1.Recordset!dia_atencion = txtFields(8).Text
    frmAdopciones.Adodc1.Recordset!fecha_ingreso_matchcota = Text2.Text
    frmAdopciones.Adodc1.Recordset.Update
    Else
        If Save = 16 Then
        frmAdopciones.Adodc1.RecordSource = "Select * from albergues where nombre_albergue='" & Combo2.Text & "'"
        frmAdopciones.Adodc1.Refresh
        frmAdopciones.Adodc1.Recordset!nombre_albergue = Combo2.Text
        frmAdopciones.Adodc1.Recordset!cod_albergue = "AB0" & reg
        frmAdopciones.Adodc1.Recordset!ciudad = Text1.Text
        frmAdopciones.Adodc1.Recordset!direccion = txtFields(3).Text
        frmAdopciones.Adodc1.Recordset!id_distrito = id_distrito
        frmAdopciones.Adodc1.Recordset!referencia = txtFields(5).Text
        frmAdopciones.Adodc1.Recordset!duena = txtFields(7).Text
        frmAdopciones.Adodc1.Recordset!responsable = txtFields(9).Text
        frmAdopciones.Adodc1.Recordset!cuidador = txtFields(10).Text
        frmAdopciones.Adodc1.Recordset!horario_atencion = txtFields(11).Text
        frmAdopciones.Adodc1.Recordset!dia_atencion = txtFields(8).Text
        frmAdopciones.Adodc1.Recordset!fecha_ingreso_matchcota = Text2.Text
        frmAdopciones.Adodc1.Recordset.Update
        End If
    End If
End If
If Check2.Value = 1 Then
    frmAdopciones.Adodc1.RecordSource = "Select Max(id_color) from color"
    frmAdopciones.Adodc1.Refresh
    reg = frmAdopciones.Adodc1.Recordset!Max + 1
    frmAdopciones.Adodc1.RecordSource = "Select * from color"
    frmAdopciones.Adodc1.Refresh
    frmAdopciones.Adodc1.Recordset.AddNew
    frmAdopciones.Adodc1.Recordset!id_color = reg
    frmAdopciones.Adodc1.Recordset!nombre_color = Combo3.Text
    frmAdopciones.Adodc1.Recordset.Update
End If
If Check3.Value = 1 Then
    frmAdopciones.Adodc1.RecordSource = "Select Max(id_distrito) from distrito"
    frmAdopciones.Adodc1.Refresh
    reg = frmAdopciones.Adodc1.Recordset!Max + 1
    frmAdopciones.Adodc1.RecordSource = "Select * from distrito"
    frmAdopciones.Adodc1.Refresh
    frmAdopciones.Adodc1.Recordset.AddNew
    frmAdopciones.Adodc1.Recordset!id_distrito = reg
    frmAdopciones.Adodc1.Recordset!nombre_distrito = Combo4.Text
    frmAdopciones.Adodc1.Recordset!cod_postal = Text3.Text
    frmAdopciones.Adodc1.Recordset.Update
End If

If Check4.Value = 1 Then
    frmAdopciones.Adodc1.RecordSource = "Select Max(id_estado) from status"
 frmAdopciones.Adodc1.Refresh
    reg = frmAdopciones.Adodc1.Recordset!Max + 1
    frmAdopciones.Adodc1.RecordSource = "Select * from status"
    frmAdopciones.Adodc1.Refresh
    frmAdopciones.Adodc1.Recordset.AddNew
    frmAdopciones.Adodc1.Recordset!id_estado = reg
    frmAdopciones.Adodc1.Recordset!estado = Combo5.Text
    frmAdopciones.Adodc1.Recordset.Update
End If
If Check5.Value = 1 Then
    frmAdopciones.Adodc1.RecordSource = "Select Max(id_detalle_puesto)  from detalle_puesto"
    frmAdopciones.Adodc1.Refresh
    reg = frmAdopciones.Adodc1.Recordset!Max + 1
    frmAdopciones.Adodc1.RecordSource = "Select * from detalle_puesto"
    frmAdopciones.Adodc1.Refresh
    frmAdopciones.Adodc1.Recordset.AddNew
    frmAdopciones.Adodc1.Recordset!id_detalle_puesto = reg
    frmAdopciones.Adodc1.Recordset!puesto = Combo6.Text
    frmAdopciones.Adodc1.Recordset.Update
End If
If Check6.Value = 1 Then
    frmAdopciones.Adodc1.RecordSource = "Select Max(id_medio) from medio_contacto"
    frmAdopciones.Adodc1.Refresh
    reg = frmAdopciones.Adodc1.Recordset!Max + 1
    frmAdopciones.Adodc1.RecordSource = "Select * from medio_contacto"
    frmAdopciones.Adodc1.Refresh
    frmAdopciones.Adodc1.Recordset.AddNew
    frmAdopciones.Adodc1.Recordset!id_medio = reg
    frmAdopciones.Adodc1.Recordset!descripcion = Combo7.Text
    frmAdopciones.Adodc1.Recordset.Update
End If
End Sub
Private Sub Form_Load()
frmAdopciones.Adodc1.RecordSource = "Select * from albergues order by nombre_albergue asc"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
     Do Until .EOF
      Combo2.AddItem frmAdopciones.Adodc1.Recordset!nombre_albergue
     .MoveNext
     Loop
End With
     Text2.Enabled = False
     Text1.Enabled = False
     txtFields(3).Enabled = False
     txtFields(5).Enabled = False
     txtFields(7).Enabled = False
     txtFields(8).Enabled = False
     txtFields(9).Enabled = False
     txtFields(10).Enabled = False
     txtFields(11).Enabled = False
     Combo1.Enabled = False
     Picture1.Enabled = False
     MonthView1.Enabled = False
frmAdopciones.Adodc1.RecordSource = "Select * from color order by nombre_color asc"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
     Do Until .EOF
      Combo3.AddItem frmAdopciones.Adodc1.Recordset!nombre_color
     .MoveNext
     Loop
End With
frmAdopciones.Adodc1.RecordSource = "Select * from status"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
     Do Until .EOF
     Combo5.AddItem frmAdopciones.Adodc1.Recordset!estado
     .MoveNext
     Loop
End With
frmAdopciones.Adodc1.RecordSource = "Select * from distrito order by nombre_distrito asc"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
     Do Until .EOF
      Combo4.AddItem frmAdopciones.Adodc1.Recordset!nombre_distrito
     .MoveNext
     Loop
End With
frmAdopciones.Adodc1.RecordSource = "Select * from medio_contacto order by descripcion asc"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
     Do Until .EOF
      Combo7.AddItem frmAdopciones.Adodc1.Recordset!descripcion
     .MoveNext
     Loop
End With
frmAdopciones.Adodc1.RecordSource = "Select * from detalle_puesto order by puesto asc"
frmAdopciones.Adodc1.Refresh
With frmAdopciones.Adodc1.Recordset
     Do Until .EOF
      Combo6.AddItem frmAdopciones.Adodc1.Recordset!puesto
     .MoveNext
     Loop
End With
End Sub
Private Sub MonthView1_DateClick(ByVal DateClicked As Date)
Text2.Text = MonthView1.Value
End Sub
Private Sub Picture1_Click()
MonthView1.Visible = True
End Sub




'7.	frmMenuOpciones
Private Sub CmdMascotas_Click()
frmMascotas.Show
frmMenuOpciones.Hide
End Sub
Private Sub CmdPersonas_Click()
frmPersonas.Show
frmMenuOpciones.Hide
End Sub
Private Sub CmdSalir_Click()
End
End Sub
Private Sub Command1_Click()
frmEntrevistas.Show
frmMenuOpciones.Hide
End Sub
Private Sub Command2_Click()
frmAdopciones.Show
frmMenuOpciones.Hide
End Sub
Private Sub Command3_Click()
frmApadrinamientos.Show
frmMenuOpciones.Hide
End Sub
Private Sub Command4_Click()
frmEquipo_Matchcota.Show
frmMenuOpciones.Hide
End Sub
Private Sub Command5_Click()
frmMantenimiento.Show
frmMenuOpciones.Hide
End Sub






'8.	frmPersonas
Private Sub Cmd_InfoAdicional_Click()
frmVivienda_Familia.Show
End Sub
Private Sub Cmd_nuevo_Click()
Combo_persona.Clear
txtFields(1).Enabled = True
txtFields(1).Text = ""
Combo_sexo.Enabled = True
Combo_sexo.AddItem "Hombre"
Combo_sexo.AddItem "Mujer"
txtFields(3).Enabled = True
txtFields(3).Text = ""
txtfnacimiento.Enabled = True
txtfnacimiento.Text = ""
txtFields(4).Enabled = True
txtFields(4).Text = ""
Picture1.Enabled = True
txtfijo.Enabled = True
txtfijo.Text = ""
txtFields(6).Enabled = True
txtFields(6).Text = ""
txtFields(7).Enabled = True
xtFields(7).Text = ""
txtFields(11).Enabled = True
txtFields(11).Text = ""
Combo_distrito.Enabled = True
Combo_distrito.Clear
Combo_sexo.Clear
txtFields(8).Enabled = True
txtFields(8).Text = ""
Combo_contacto.Enabled = True
Combo_tipo_interes.Enabled = True
Combo_tipo_interes.Clear
Combo_tipo_interes.AddItem "Adoptante"
Combo_tipo_interes.AddItem "Adoptante + Padrino/Mascota"
Combo_tipo_interes.AddItem "Padrino/Madrina"
Combo_contacto.Clear
txt_otros.Enabled = True
txt_otros.Text = ""
txtFRegistro.Enabled = True
txtFRegistro.Text = ""
Picture2.Enabled = True
txtfcontacto.Enabled = True
txtfcontacto.Text = ""
Picture3.Enabled = True
Combo_tipov.Enabled = True
Combo_tipov.AddItem "Casa"
Combo_tipov.AddItem "Depa"
Combo_permiso.Enabled = True
Combo_permiso.AddItem "Sí"
Combo_permiso.AddItem "No"
Combo_alq.Enabled = True
Combo_alq.AddItem "Propia"
Combo_alq.AddItem "Alquilada"
Combo_mudanza.Enabled = True
Combo_mudanza.AddItem "Lo devuelvo al albergue"
Combo_mudanza.AddItem "Se va conmigo"
Combo_mudanza.AddItem "Depende de las nuevas condiciones"
Combo_segura.Enabled = True
Combo_segura.AddItem "Sí"
Combo_segura.AddItem "No"
Combo1.Enabled = True
Combo1.AddItem "No"
Combo1.AddItem "Rejas"
Combo1.AddItem "Malla"
Check1.Enabled = True
Check2.Enabled = True
Check3.Enabled = True
Check4.Enabled = True
Check5.Enabled = True
Option_fumsi.Enabled = True
Option_fumno.Enabled = True
frmVivienda_Familia.Combo_persona.AddItem Combo_persona.Text
frmVivienda_Familia.Combo_persona.Enabled = True
frmVivienda_Familia.Combo_alergias.Enabled = True
frmVivienda_Familia.Combo_alergias.AddItem "Sí"
frmVivienda_Familia.Combo_alergias.AddItem "No"
frmVivienda_Familia.Text2.Enabled = True
frmVivienda_Familia.Combo_embarazo.Enabled = True
frmVivienda_Familia.Combo_embarazo.AddItem "No"
frmVivienda_Familia.Combo_embarazo.AddItem "Si, hay un embarazo"
frmVivienda_Familia.Combo_embarazo.AddItem "Tenemos planes en el corto tiempo"
frmVivienda_Familia.Combo_hfueras.Enabled = True
frmVivienda_Familia.Combo_npersonas.Enabled = True
frmVivienda_Familia.Combo_rmasc.Enabled = True
frmVivienda_Familia.Combo_rmasc.AddItem "Bien"
frmVivienda_Familia.Combo_rmasc.AddItem "Mal"
frmVivienda_Familia.Combo_tpersonas.Enabled = True
frmVivienda_Familia.Combo_tpersonas.AddItem "Adulto(s)"
frmVivienda_Familia.Combo_tpersonas.AddItem "Familia"
frmVivienda_Familia.Combo_tpersonas.AddItem "Joven<25"
frmVivienda_Familia.Combo_tpersonas.AddItem "Senior"
frmVivienda_Familia.Combo_viajes.Enabled = True
frmVivienda_Familia.Combo_viajes.AddItem "No"
frmVivienda_Familia.Combo_viajes.AddItem "Viaje_semanas"
frmVivienda_Familia.Combo_viajes.AddItem "Viaje_1_2_meses"
frmVivienda_Familia.Combo_viajes.AddItem "Viajes_2_anos"
frmVivienda_Familia.Combo_viajes.Enabled = True
frmVivienda_Familia.Option_cuidadon.Enabled = True
frmVivienda_Familia.Option_cuidados.Enabled = True
frmVivienda_Familia.Option_gato.Enabled = False
frmVivienda_Familia.Option_mas.Enabled = True
frmVivienda_Familia.Option_man.Enabled = True
frmVivienda_Familia.Option_perro.Enabled = False
frmVivienda_Familia.Optionmcsi.Enabled = True
frmVivienda_Familia.Optionmn.Enabled = True
frmVivienda_Familia.Option_cuidadon.Value = False
frmVivienda_Familia.Option_cuidados.Value = False
frmVivienda_Familia.Option_gato.Value = False
frmVivienda_Familia.Option_mas.Value = 0
frmVivienda_Familia.Option_perro.Value = False
frmVivienda_Familia.Optionmcsi.Value = False
frmVivienda_Familia.Optionmn.Value = False
frmVivienda_Familia.txtDesc.Enabled = True
frmVivienda_Familia.txtDesc.Text = ""
frmVivienda_Familia.txtmotivo.Enabled = True
frmVivienda_Familia.txtmotivo.Text = ""
frmResponComp.Combo_Edad.Enabled = True
frmResponComp.Combo_frecuencia.Enabled = True
frmResponComp.Combo_frecuencia.AddItem "1 vez al día"
frmResponComp.Combo_frecuencia.AddItem "2 veces al día"
frmResponComp.Combo_frecuencia.AddItem "3 veces al día"
frmResponComp.Combo_persona.AddItem Combo_persona.Text
frmResponComp.Combo_persona.Enabled = False
frmResponComp.Combo_Resp.Enabled = True
frmResponComp.Combo_Resp.AddItem "Yo"
frmResponComp.Combo_Resp.AddItem "Otro"
frmResponComp.txtLista_acceso.Enabled = True
frmResponComp.txtLista_acceso.Text = ""
frmResponComp.Option_abandonon.Enabled = True
frmResponComp.Option_abandonos.Enabled = True
frmResponComp.Option_acuerdon.Enabled = True
frmResponComp.Option_acuerdos.Enabled = True
frmResponComp.Option_centvetn.Enabled = True
frmResponComp.Option_centvets.Enabled = True
frmResponComp.Optionbrindarlen.Enabled = True
frmResponComp.Optionbrindarles.Enabled = True
frmResponComp.Optioncuidadon.Enabled = True
frmResponComp.Optioncuidados.Enabled = True
frmResponComp.Optionimpren.Enabled = True
frmResponComp.Optionimpres.Enabled = True
frmResponComp.Optiontiempon.Enabled = True
frmResponComp.Optiontiempos.Enabled = True
frmResponComp.Option_abandonon.Value = False
frmResponComp.Option_abandonos.Value = False
frmResponComp.Option_acuerdon.Value = False
frmResponComp.Option_acuerdos.Value = False
frmResponComp.Option_centvetn.Value = False
frmResponComp.Option_centvets.Value = False
frmResponComp.Optionbrindarlen.Value = False
frmResponComp.Optionbrindarles.Value = False
frmResponComp.Optioncuidadon.Value = False
frmResponComp.Optioncuidados.Value = False
frmResponComp.Optionimpren.Value = False
frmResponComp.Optionimpres.Value = False
frmResponComp.Optiontiempon.Value = False
frmResponComp.Optiontiempos.Value = False
frmResponComp.txt1.Enabled = True
frmResponComp.txt1.Text = ""
frmResponComp.txt2.Enabled = True
frmResponComp.txt3.Enabled = True
frmResponComp.txt4.Enabled = True
frmResponComp.txt5.Enabled = True
frmResponComp.txt6.Enabled = True
frmResponComp.txtCuidados.Enabled = True
frmResponComp.txtCent.Enabled = True
frmResponComp.txt2.Text = ""
frmResponComp.txt3.Text = ""
frmResponComp.txt4.Text = ""
frmResponComp.txt5.Text = ""
frmResponComp.txt6.Text = ""
frmResponComp.txtCuidados.Text = ""
frmResponComp.txtCent.Text = ""
frmResponComp.Frame1.Enabled = True
frmResponComp.Frame2.Enabled = True
Picture1.Enabled = True
Picture3.Enabled = True
Picture2.Enabled = True
frmResponComp.Combo_Resp.AddItem "Yo"
frmResponComp.Combo_Resp.AddItem "Otro"
frmVivienda_Familia.Combo_masc_act.Enabled = True
frmVivienda_Familia.Combo_masc_act.AddItem "1"
frmVivienda_Familia.Combo_masc_act.AddItem "2"
frmVivienda_Familia.Combo_masc_act.AddItem "3"
frmVivienda_Familia.Combo_masc_act.AddItem "4"
frmVivienda_Familia.Combo_masc_act.AddItem "5"
frmVivienda_Familia.Combo_npersonas.AddItem "1"
frmVivienda_Familia.Combo_npersonas.AddItem "2"
frmVivienda_Familia.Combo_npersonas.AddItem "3"
frmVivienda_Familia.Combo_npersonas.AddItem "4"
frmVivienda_Familia.Combo_npersonas.AddItem "5"
frmVivienda_Familia.Combo_npersonas.AddItem "6"
frmVivienda_Familia.Combo_npersonas.AddItem "7"
frmVivienda_Familia.Combo_npersonas.AddItem "8"
frmVivienda_Familia.Combo_npersonas.AddItem "9"
frmVivienda_Familia.Combo_npersonas.AddItem "10"
frmVivienda_Familia.Combo_paciencia.AddItem "Sí"
frmVivienda_Familia.Combo_paciencia.AddItem "No"
i = 1
Do Until i = 75
   frmResponComp.Combo_Edad.AddItem (i)
   i = i + 1
Loop
i = 1
Do Until i = 20
   frmVivienda_Familia.Combo_hfueras.AddItem (i)
   i = i + 1
Loop
frmMascotas.Adodc1.RecordSource = "Select nombre_distrito from distrito"
frmMascotas.Adodc1.Refresh
With frmMascotas.Adodc1.Recordset
   Do Until .EOF
      Combo_distrito.AddItem frmMascotas.Adodc1.Recordset!nombre_distrito
       .MoveNext
   Loop
End With
frmMascotas.Adodc1.RecordSource = "Select descripcion from medio_contacto"
frmMascotas.Adodc1.Refresh
With frmMascotas.Adodc1.Recordset
   Do Until .EOF
      Combo_contacto.AddItem frmMascotas.Adodc1.Recordset!descripcion
       .MoveNext
   Loop
End With
Combo_sexo.AddItem "Hombre"
Combo_sexo.AddItem "Mujer"
frmResponComp.Combo_juego.AddItem "30 minutos"
frmResponComp.Combo_juego.AddItem "1-2 horas"
frmResponComp.Combo_juego.AddItem "2-3 horas"
frmResponComp.Combo_juego.AddItem "3-4 horas"
frmResponComp.Combo_juego.AddItem "4-5 horas"
Save = 3
End Sub
Private Sub cmdAdd_Click()
Dim id_reg_per, id_pers As Integer
Dim distrito, id_distrito, medio, id_medio As String
        distrito = Combo_distrito.Text
        frmMascotas.Adodc1.RecordSource = "select id_distrito from distrito where nombre_distrito='" & distrito & "'"
        frmMascotas.Adodc1.Refresh
        id_distrito = CStr(frmMascotas.Adodc1.Recordset!id_distrito)
        medio = Combo_contacto.Text
        If medio = "Otros" Then
            frmMascotas.Adodc1.RecordSource = "select id_medio from medio_contacto where descripcion='" & medio & "'"
            frmMascotas.Adodc1.Refresh
            id_medio = CStr(frmMascotas.Adodc1.Recordset!id_medio)
            frmMascotas.Adodc1.Recordset!txt_otros = txt_otros.Text
        Else
            frmMascotas.Adodc1.RecordSource = "select id_medio from medio_contacto where descripcion='" & medio & "'"
            frmMascotas.Adodc1.Refresh
            id_medio = CStr(frmMascotas.Adodc1.Recordset!id_medio)
        End If
If Save = 3 Then
    If Combo_persona.Text = "" And txtFields(1).Text = "" And Combo_sexo.Text = "" And txtFields(3).Text = "" And txtfnacimiento.Text = "" And txtFields(4).Text = "" And _
            txtFields(6).Text = "" And txtFields(7).Text = "" And txtFields(8).Text = "" And txtFields(11).Text = "" And Combo_distrito.Text = "" And _
            Combo_contacto.Text = "" And txtFRegistro.Text = "" And txtfcontacto.Text = "" And Combo_tipov.Text = "" And _
            Combo_permiso.Text = "" And Combo_alq.Text = "" And Combo_mudanza.Text = "" And Combo_segura.Text = "" And _
            Combo1.Text = "" And frmVivienda_Familia.Combo_alergias.Text = "" And frmVivienda_Familia.Combo_embarazo.Text = "" And frmVivienda_Familia.Combo_npersonas.Text = "" And  frmVivienda_Familia.Combo_tpersonas.Text = "" And frmVivienda_Familia.Combo_viajes.Text = "" And frmResponComp.Combo_frecuencia.Text = "" And _
            frmResponComp.Combo_Resp.Text = "" And frmResponComp.txtLista_acceso.Text = "" And _
            frmVivienda_Familia.txtmotivo = "" And frmVivienda_Familia.Combo_paciencia.Text = "" And Combo_tipo_interes.Text = "" Then
            MsgBox ("Debe rellenar todos los campos obligatorios")
    Else
            frmMascotas.Adodc1.RecordSource = "SELECT MAX(id_persona) FROM persona"
            frmMascotas.Adodc1.Refresh
            id_reg_per = frmMascotas.Adodc1.Recordset!Max + 1
            frmMascotas.Adodc1.RecordSource = "Select * from persona"
            frmMascotas.Adodc1.Refresh
            frmMascotas.Adodc1.Recordset.AddNew
            frmMascotas.Adodc1.Recordset!id_persona = id_reg_per
            frmMascotas.Adodc1.Recordset!nombre = Combo_persona.Text
            frmMascotas.Adodc1.Recordset!dni = txtFields(1).Text
            frmMascotas.Adodc1.Recordset!nacionalidad = txtFields(3)
            frmMascotas.Adodc1.Recordset!sexo = Combo_sexo.Text
            frmMascotas.Adodc1.Recordset!f_nacimiento = txtfnacimiento.Text
            frmMascotas.Adodc1.Recordset!email = txtFields(4).Text
            frmMascotas.Adodc1.Recordset!tel_fijo = txtfijo.Text
            frmMascotas.Adodc1.Recordset!tel_cel = txtFields(6).Text
            frmMascotas.Adodc1.Recordset!ocupacion = txtFields(7).Text
            frmMascotas.Adodc1.Recordset!direccion = txtFields(11).Text
            frmMascotas.Adodc1.Recordset!centro_trabajo = txtFields(8).Text
            frmMascotas.Adodc1.Recordset!f_registro = txtFRegistro.Text
            frmMascotas.Adodc1.Recordset!f_contacto = txtfcontacto.Text
            frmMascotas.Adodc1.Recordset!id_medio = id_medio
            frmMascotas.Adodc1.Recordset!id_distrito = id_distrito
            frmMascotas.Adodc1.Recordset!tipo_interes = Combo_tipo_interes.Text
           frmMascotas.Adodc1.Recordset.Update
            'DESCRIPCION_VIVIENDA
            frmMascotas.Adodc1.RecordSource = "Select * from descripcion_vivienda"
            frmMascotas.Adodc1.Refresh
            frmMascotas.Adodc1.Recordset.AddNew
            frmMascotas.Adodc1.Recordset!id_tipo_vivienda = id_reg_per
            frmMascotas.Adodc1.Recordset!id_persona = id_reg_per
            frmMascotas.Adodc1.Recordset!descripcion = Combo_tipov.Text
            If Combo_tipov.Text = "Depa" Then
                frmMascotas.Adodc1.Recordset!permiten_mascotas = Combo_permiso.Text
            End If
            frmMascotas.Adodc1.Recordset!alquilada = Combo_alq.Text
            If Combo_alq.Text = "Alquilada" Then
                frmMascotas.Adodc1.Recordset!mudanza = Combo_mudanza
            End If
            frmMascotas.Adodc1.Recordset!adecuado_mascotas = Combo_segura.Text
            If Check1.Value = 1 Then
                frmMascotas.Adodc1.Recordset!jardin_interno = "Sí"
            Else
                    frmMascotas.Adodc1.Recordset!jardin_interno = "No"
            End If
            If Check2.Value = 1 Then
                frmMascotas.Adodc1.Recordset!jardin_externo = "Sí"
            Else
                    frmMascotas.Adodc1.Recordset!jardin_externo = "No"
            End If
            If Check3.Value = 1 Then
                frmMascotas.Adodc1.Recordset!patio_interno = "Sí"
            Else
                    frmMascotas.Adodc1.Recordset!patio_interno = "No"
            End If
            If Check4.Value = 1 Then
                frmMascotas.Adodc1.Recordset!patio_externo = "Sí"
            Else
                    frmMascotas.Adodc1.Recordset!patio_externo = "No"
            End If
            If Check5.Value = 1 Then
                frmMascotas.Adodc1.Recordset!ventanas_calle = "Sí"
            Else
                frmMascotas.Adodc1.Recordset!ventanas_calle = "No"
            End If
            If Combo1.Text = "Rejas" Then
                frmMascotas.Adodc1.Recordset!rejas_malla = "Rejas"
            End If
         If Combo1.Text = "Malla" Then
                  frmMascotas.Adodc1.Recordset!rejas_malla = "Malla"
            Else
                    If Combo1.Text = "No" Then
                      frmMascotas.Adodc1.Recordset!rejas_malla = "No"
                    End If
            End If
            If Option_fumsi = "True" Then
                frmMascotas.Adodc1.Recordset!fumigado = "Sí"
            Else
                frmMascotas.Adodc1.Recordset!fumigado = "No"
            End If
           frmMascotas.Adodc1.Recordset.Update
            'DESCRIPCION_FAMILIA
            frmMascotas.Adodc1.RecordSource = "Select * from descripcion_familia"
            frmMascotas.Adodc1.Refresh
            frmMascotas.Adodc1.Recordset.AddNew
            frmMascotas.Adodc1.Recordset!id_desc_familia = id_reg_per
            frmMascotas.Adodc1.Recordset!id_persona = id_reg_per
            frmMascotas.Adodc1.Recordset!tipo = frmVivienda_Familia.Combo_tpersonas.Text
            frmMascotas.Adodc1.Recordset!num_persona = frmVivienda_Familia.Combo_npersonas
            frmMascotas.Adodc1.Recordset!alergico_pelo = frmVivienda_Familia.Combo_alergias.Text
            If frmVivienda_Familia.Combo_alergias.Text = "Sí" Then
                If frmVivienda_Familia.Option_perro.Value = "True" Then
                   frmMascotas.Adodc1.Recordset!talergia = "Perro"
                Else
                    If frmVivienda_Familia.Option_gato.Value = "True" Then
                        frmMascotas.Adodc1.Recordset!talergia = "Gato"
                    End If
                End If
            End If
            frmMascotas.Adodc1.Recordset!embarazadas = frmVivienda_Familia.Combo_embarazo.Text
            If frmVivienda_Familia.Combo_embarazo.Text = "Sí" Then
                frmMascotas.Adodc1.Recordset!sit_bebe = frmVivienda_Familia.Text1.Text
            End If
            If frmVivienda_Familia.Optionmcsi.Value = True Then
               frmMascotas.Adodc1.Recordset!num_mascotas_actual = frmVivienda_Familia.Combo_masc_act.Text
               frmMascotas.Adodc1.Recordset!relacion_otras_mascotas = frmVivienda_Familia.Combo_rmasc.Text
            Else
               frmMascotas.Adodc1.Recordset!num_mascotas_actual = "0"
            End If
            frmMascotas.Adodc1.Recordset!horas_mascota_solo = frmVivienda_Familia.Combo_hfueras.Text
            frmMascotas.Adodc1.Recordset.Update
            'INTERESES_ADOPTANTES
            frmMascotas.Adodc1.RecordSource = "Select * from intereses_adoptante"
            frmMascotas.Adodc1.Refresh
            frmMascotas.Adodc1.Recordset.AddNew
            frmMascotas.Adodc1.Recordset!id_interes = id_reg_per
            frmMascotas.Adodc1.Recordset!id_persona = id_reg_per
            frmMascotas.Adodc1.Recordset!motivo_adopcion = frmVivienda_Familia.txtmotivo.Text
            If frmVivienda_Familia.Option_mas.Value = 1 Then
                frmMascotas.Adodc1.Recordset!tuvo_mascotas = "Sí"
                frmMascotas.Adodc1.Recordset!sit_mascota_anterior = frmVivienda_Familia.Text2.Text
            Else
                frmMascotas.Adodc1.Recordset!tuvo_mascotas = "No"
            End If
            If frmVivienda_Familia.Option_cuidados.Value = "True" Then
                frmMascotas.Adodc1.Recordset!conocimiento_cuidados = "Sí"
                frmMascotas.Adodc1.Recordset!detalle_conocimientos = frmVivienda_Familia.txtDescText
            Els
                frmMascotas.Adodc1.Recordset!conocimiento_cuidados = "No"
            End If
            frmMascotas.Adodc1.Recordset!viaje_planeado = frmVivienda_Familia.Combo_viajes.Text
            frmMascotas.Adodc1.Recordset!detalle_viaje = frmVivienda_Familia.Text3.Text
            frmMascotas.Adodc1.Recordset!tiempo_paciencia = frmVivienda_Familia.Combo_paciencia.Text
            frmMascotas.Adodc1.Recordset.Update
            'RESPONSABILIDADES
            frmMascotas.Adodc1.RecordSource = "Select * from responsabilidades"
            frmMascotas.Adodc1.Refresh
            frmMascotas.Adodc1.Recordset.AddNew
            frmMascotas.Adodc1.Recordset!id_responsabilidades = id_reg_per
            frmMascotas.Adodc1.Recordset!id_persona = id_reg_per
            frmMascotas.Adodc1.Recordset!responsable_directo = frmResponComp.Combo_Resp.Text
            If frmMascotas.Adodc1.Recordset!responsable_directo = "Otro" Then
               frmMascotas.Adodc1.Recordset!edad_responsable = frmResponComp.Combo_Edad
            End If
            frmMascotas.Adodc1.Recordset!ambientes_habilitados = frmResponComp.txtLista_acceso.Text
            frmMascotas.Adodc1.Recordset!frecuencia_paseo = frmResponComp.Combo_frecuencia.Text
            frmMascotas.Adodc1.Recordset!paseo_cuidados = frmResponComp.txtCuidados.Text
            frmMascotas.Adodc1.Recordset!horas_juego = frmResponComp.Combo_juego.Text
            If frmResponComp.Option_centvets.Value = "True" Then
                frmMascotas.Adodc1.Recordset!conoce_vet = "Sí"
                frmMascotas.Adodc1.Recordset!nombre_vet = frmResponComp.txtCent.Text
            Else
                frmMascotas.Adodc1.Recordset!conoce_vet = "No"
            End If
            frmMascotas.Adodc1.Recordset!ausencia_dueno_lugar = frmResponComp.txtSitMasc.Text
            frmMascotas.Adodc1.Recordset!escape_mascota = frmResponComp.txtAcc.Text
            frmMascotas.Adodc1.Recordset!si_viaja = frmResponComp.txtsiviaja.Text
            frmMascotas.Adodc1.Recordset!comportamiento = frmResponComp.txtComp.Text
            frmMascotas.Adodc1.Recordset.Update
            'COMPROMISO_PERSONA
            frmMascotas.Adodc1.RecordSource = "Select * from compromiso_persona"
         frmMascotas.Adodc1.Refresh
            frmMascotas.Adodc1.Recordset.AddNew
            frmMascotas.Adodc1.Recordset!id_compromiso_persona = id_reg_per
            frmMascotas.Adodc1.Recordset!id_persona = id_reg_per
            If frmResponComp.Option_acuerdos.Value = 1 Then
                frmMascotas.Adodc1.Recordset!todos_acuerdo = "Sí"
            Else
                frmMascotas.Adodc1.!todos_acuerdo = "No"
            End If
            frmMascotas.Adodc1.Recordset!txt_acuerdo = frmResponComp.txt1.Text
            If frmResponComp.Optiontiempos.Value = 1 Then
                frmMascotas.Adodc1.Recordset!tiempo_dedicacion = "Sí"
            Else
                frmMascotas.Adodc1.Recordset!tiempo_dedicacion = "No"
            End If
            frmMascotas.Adodc1.Recordset!txttiempo = frmResponComp.txt2.Text
            If frmResponComp.Option_abandonos.Value = 1 Then
                frmMascotas.Adodc1.Recordset!compromiso_mudanza = "Sí"
            Else
                frmMascotas.Adodc1.Recordset!compromiso_mudanza = "No"
            End If
            frmMascotas.Adodc1.Recordset!txtabandono = frmResponComp.txt3.Text
            If frmResponComp.Optioncuidados.Value = 1 Then
                frmMascotas.Adodc1.Recordset!compromiso_cuidado = "Sí"
            Else
                frmMascotas.Adodc1.Recordset!compromiso_cuidado = "No"
            End If
            frmMascotas.Adodc1.Recordset!txtcuidado1 = frmResponComp.txt4.Text
            If frmResponComp.Optionimpres.Value = 1 Then
                frmMascotas.Adodc1.Recordset!compromiso_cuidado_imprescindible = "Sí"
            Else
                frmMascotas.Adodc1.Recordset!compromiso_cuidado_imprescindible = "No"
            End If
            frmMascotas.Adodc1.Recordset!txtimpres = frmResponComp.txt5.Text
            If frmResponComp.Optionbrindarles.Value = 1 Then
                frmMascotas.Adodc1.Recordset!compromiso_vida = "Sí"
            Else
                frmMascotas.Adodc1.Recordset!compromiso_vida = "No"
            End If
            frmMascotas.Adodc1.Recordset!txtvida = frmResponComp.txt6.Text
            frmMascotas.Adodc1.Recordset.Update
            MsgBox ("Registro de Persona creado")
    End If
Else
    If Save = 4 Then
            persona = Combo_persona.Text
            frmMascotas.Adodc1.RecordSource = "Select id_persona from persona where nombre='" & persona & "'"
            frmMascotas.Adodc1.Refresh
            id_pers = frmMascotas.Adodc1.Recordset!id_persona
            frmMascotas.Adodc1.RecordSource = "Select * from persona where id_persona=" & id_pers
            frmMascotas.Adodc1.Refresh
            frmMascotas.Adodc1.Recordset!nombre = Combo_persona.Text
            frmMascotas.Adodc1.Recordset!dni = txtFields(1).Text
            frmMascotas.Adodc1.Recordset!nacionalidad = txtFields(3)
            frmMascotas.Adodc1.Recordset!sexo = Combo_sexo.Text
            frmMascotas.Adodc1.Recordset!f_nacimiento = txtfnacimiento.Text
            frmMascotas.Adodc1.Recordset!email = txtFields(4).Text
            frmMascotas.Adodc1.Recordset!tel_fijo = txtfijo.Text
            frmMascotas.Adodc1.Recordset!tel_cel = txtFields(6).Text
            frmMascotas.Adodc1.Recordset!ocupacion = txtFields(7).Text
            frmMascotas.Adodc1.Recordset!direccion = txtFields(11).Text
            frmMascotas.Adodc1.Recordset!centro_trabajo = txtFields(8).Text
          frmMascotas.Adodc1.Recordset!f_registro = txtFRegistro.Text
            frmMascotas.Adodc1.Recordset!f_contacto = txtfcontacto.Text
            frmMascotas.Adodc1.Recordset!id_medio = id_medio
            frmMascotas.Adodc1.Recordset!id_distrito = id_distrito
            frmMascotas.Adodc1.Recordset!tipo_interes = Combo_tipo_interes.Text
            frmMascotas.Adodc1.Recordset.Update
            'DESCRIPCION_FAMILIA
            frmMascotas.Adodc1.RecordSource = "Select * from descripcion_familia where id_persona='" & id_pers & "'"
            frmMascotas.Adodc1.Refresh
            If frmMascotas.Adodc1.Recordset.EOF = True Then
                frmMascotas.Adodc1.RecordSource = "Select * from descripcion_familia"
                frmMascotas.Adodc1.Refresh
                frmMascotas.Adodc1.Recordset.AddNew
                frmMascotas.Adodc1.Recordset!id_desc_familia = CInt(id_pers)
                frmMascotas.Adodc1.Recordset!id_persona = id_pers
                frmMascotas.Adodc1.Recordset!tipo = frmVivienda_Familia.Combo_tpersonas.Text
                frmMascotas.Adodc1.Recordset!num_persona = frmVivienda_Familia.Combo_npersonas
                frmMascotas.Adodc1.Recordset!alergico_pelo = frmVivienda_Familia.Combo_alergias.Text
                If frmVivienda_Familia.Combo_alergias.Text = "Sí" Then
                    If frmVivienda_Familia.Option_perro.Value = "True" Then
                       frmMascotas.Adodc1.Recordset!talergia = "Perro"
                    Else
                        If frmVivienda_Familia.Option_gato.Value = "True" Then
                            frmMascotas.Adodc1.Recordset!talergia = "Gato"
                        End If
                    End If
                End If
                frmMascotas.Adodc1.Recordset!embarazadas = frmVivienda_Familia.Combo_embarazo.Text
                If frmVivienda_Familia.Combo_embarazo.Text = "Sí" Then
                    frmMascotas.Adodc1.Recordset!sit_bebe = frmVivienda_Familia.Text1.Text
                End If
                If frmVivienda_Familia.Optionmcsi.Value = True Then
                   frmMascotas.Adodc1.Recordset!num_mascotas_actual = frmVivienda_Familia.Combo_masc_act.Text
                   frmMascotas.Adodc1.Recordset!relacion_otras_mascotas = frmVivienda_Familia.Combo_rmasc.Text
                Else
                   frmMascotas.Adodc1.Recordset!num_mascotas_actual = "0"
                End If
                frmMascotas.Adodc1.Recordset!horas_mascota_solo = frmVivienda_Familia.Combo_hfueras.Text
                frmMascotas.Adodc1.Recordset.Update
            Else
                frmMascotas.Adodc1.Recordset!tipo = frmVivienda_Familia.Combo_tpersonas.Text
                frmMascotas.Adodc1.Recordset!num_persona = frmVivienda_Familia.Combo_npersonas
                frmMascotas.Adodc1.Recordset!alergico_pelo = frmVivienda_Familia.Combo_alergias.Text
                If frmVivienda_Familia.Combo_alergias.Text = "Sí" Then
                  If frmVivienda_Familia.Option_perro.Value = "True" Then
                       frmMascotas.Adodc1.Recordset!talergia = "Perro"
                    Else
                        If frmVivienda_Familia.Option_gato.Value = "True" Then
                            frmMascotas.Adodc1.Recordset!talergia = "Gato"
                        End If
                    End If
                End If
                frmMascotas.Adodc1.Recordset!embarazadas = frmVivienda_Familia.Combo_embarazo.Text
                    frmMascotas.Adodc1.Recordset!sit_bebe = frmVivienda_Familia.Text1.Text
                End If
                If frmVivienda_Familia.Optionmcsi.Value = True Then
                   frmMascotas.Adodc1.Recordset!num_mascotas_actual = frmVivienda_Familia.Combo_masc_act.Text
                   frmMascotas.Adodc1.Recordset!relacion_otras_mascotas = frmVivienda_Familia.Combo_rmasc.Text
                Else
                   frmMascotas.Adodc1.Recordset!num_mascotas_actual = "0"
                End If
                frmMascotas.Adodc1.Recordset!horas_mascota_solo = frmVivienda_Familia.Combo_hfueras.Text
                frmMascotas.Adodc1.Recordset.Update
            End If
            'RESPONSABILIDADES
            frmMascotas.Adodc1.RecordSource = "Select * from responsabilidades where id_persona='" & id_pers & "'"
            frmMascotas.Adodc1.Refresh
            If frmMascotas.Adodc1.Recordset.EOF = True Then
                frmMascotas.Adodc1.RecordSource = "Select * from responsabilidades"
                frmMascotas.Adodc1.Refresh
                frmMascotas.Adodc1.Recordset.AddNew
                frmMascotas.Adodc1.Recordset!id_responsabilidades = CInt(id_pers)
                frmMascotas.Adodc1.Recordset!id_persona = id_pers
                frmMascotas.Adodc1.Recordset!responsable_directo = frmResponComp.Combo_Resp.Text
                If frmMascotas.Adodc1.Recordset!responsable_directo = "Otro" Then
                   frmMascotas.Adodc1.Recordset!edad_responsable = frmResponComp.Combo_Edad
                End If
                frmMascotas.Adodc1.Recordset!ambientes_habilitados = frmResponComp.txtLista_acceso.Text
                frmMascotas.Adodc1.Recordset!frecuencia = frmResponComp.Combo_frecuencia.Text
                frmMascotas.Adodc1.Recordset!paseo_cuidados = frmResponComp.txtCuidados.Text
                frmMascotas.Adodc1.Recordset!horas_juego = frmResponComp.Combo_juego.Text
                If frmResponComp.Option_centvets.Value = "True" Then
                    frmMascotas.Adodc1.Recordset!conoce_vet = "Sí"
                    frmMascotas.Adodc1.Recordset!nombre_vet = frmResponComp.txtCent.Text
                Else
                    frmMascotas.Adodc1.Recordset!conoce_vet = "No"
                End If
                frmMascotas.Adodc1.Recordset!ausencia_dueno_lugar = frmResponComp.txtSitMasc.Text
                frmMascotas.Adodc1.Recordset!escape_mascota = frmResponComp.txtAcc.Text
                frmMascotas.Adodc1.Recordset!si_viaja = frmResponComp.txtsiviaja.Text
                frmMascotas.Adodc1.Recordset!comportamiento = frmResponComp.txtComp.Text
                frmMascotas.Adodc1.Recordset.Update
            Else 
frmMascotas.Adodc1.Recordset!responsable_directo = frmResponComp.Combo_Resp.Text
                If frmMascotas.Adodc1.Recordset!responsable_directo = "Otro" Then
                   frmMascotas.Adodc1.Recordset!edad_responsable = frmResponComp.Combo_Edad
                End If
                frmMascotas.Adodc1.Recordset!ambientes_habilitados = frmResponComp.txtLista_acceso
                frmMascotas.Adodc1.Recordset!frecuencia_paseo = frmResponComp.Combo_frecuencia.Text
                frmMascotas.Adodc1.Recordset!paseo_cuidados = frmResponComp.txtCuidados.Text
                frmMascotas.Adodc1.Recordset!horas_juego = frmResponComp.Combo_juego.Text
                If frmResponComp.Option_centvets.Value = "True" Then
                    frmMascotas.Adodc1.Recordset!conoce_vet = "Sí"
                    frmMascotas.Adodc1.Recordset!nombre_vet = frmResponComp.txtCent.Text
                Else
                    frmMascotas.Adodc1.Recordset!conoce_vet = "No"
                End If
                frmMascotas.Adodc1.Recordset!ausencia_dueno_lugar = frmResponComp.txtSitMasc.Text
                frmMascotas.Adodc1.Recordset!escape_mascota = frmResponComp.txtAcc.Text
                frmMascotas.Adodc1.Recordset!si_viaja = frmResponComp.txtsiviaja.Text
                frmMascotas.Adodc1.Recordset!comportamiento = frmResponComp.txtComp.Text
                frmMascotas.Adodc1.Recordset.Update
            End If
            'COMPROMISO_PERSONA
            frmMascotas.Adodc1.RecordSource = "Select * from compromiso_persona where id_persona='" & id_pers & "'"
            frmMascotas.Adodc1.Refresh
            If frmMascotas.Adodc1.Recordset.EOF = True Then
                frmMascotas.Adodc1.RecordSource = "Select * from compromiso_persona"
                frmMascotas.Adodc1.Refresh
                frmMascotas.Adodc1.Recordset.AddNew
                frmMascotas.Adodc1.Recordset!id_compromiso_persona = CInt(id_pers)
                frmMascotas.Adodc1.Recordset!id_persona = id_pers
                If frmResponComp.Option_acuerdos.Value = "True" Then
                    frmMascotas.Adodc1.Recordset!todos_acuerdo = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!todos_acuerdo = "No"
                End If
                frmMascotas.Adodc1.Recordset!txtacuerdo = frmResponComp.txt1.Text
                If frmResponComp.Optiontiempos.Value = "True" Then
                    frmMascotas.Adodc1.Recordset!tiempo_dedicacion = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!tiempo_dedicacion = "No"
                End If
                frmMascotas.Adodc1.Recordset!txttiempo = frmResponComp.txt2.Text
                If frmResponComp.Option_abandonos.Value = "True" Then
                    frmMascotas.Adodc1.Recordset!compromiso_mudanza = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!compromiso_mudanza = "No"
                End If
                frmMascotas.Adodc1.Recordset!txtabandono = frmResponComp.txt3.Text
                If frmResponComp.Optioncuidados.Value = "True" Then
                    frmMascotas.Adodc1.Recordset!compromiso_cuidado = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!compromiso_cuidado = "No"
                End If
                frmMascotas.Adodc1.Recordset!txtcuidado1 = frmResponComp.txt4.Text
                If frmResponComp.Optionimpres.Value = "True" Then
                    frmMascotas.Adodc1.Recordset!compromiso_cuidado_imprescindibles = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!compromiso_cuidado_imprescindibles = "No"
                End If
                frmMascotas.Adodc1.Recordset!txtimpres = frmResponComp.txt5.Text
                If frmResponComp.Optionbrindarles.Value = "True" Then
                    frmMascotas.Adodc1.Recordset!compromiso_vida = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!compromiso_vida = "No"
                End If
                frmMascotas.Adodc1.Recordset!txtvida = frmResponComp.txt6.Text
                frmMascotas.Adodc1.Recordset.Update
            Else
                If frmResponComp.Option_acuerdos.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!todos_acuerdo = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!todos_acuerdo = "No"
                End If
                frmMascotas.Adodc1.Recordset!txt_acuerdo = frmResponComp.txt1.Text
                If frmResponComp.Optiontiempos.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!tiempo_dedicacion = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!tiempo_dedicacion = "No"
                End If
                frmMascotas.Adodc1.Recordset!txttiempo = frmResponComp.txt2.Text
                If frmResponComp.Option_abandonos.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!compromiso_mudanza = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!compromiso_mudanza = "No"
                End If
                frmMascotas.Adodc1.Recordset!txtabandono = frmResponComp.txt3.Text
                If frmResponComp.Optioncuidados.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!compromiso_cuidado = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!compromiso_cuidado = "No"
                End If
                frmMascotas.Adodc1.Recordset!txtcuidado1 = frmResponComp.txt4.Text
                If frmResponComp.Optionimpres.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!compromiso_cuidado_imprescindible = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!compromiso_cuidado_imprescindible = "No"
                End If
                frmMascotas.Adodc1.Recordset!txtimpres = frmResponComp.txt5.Text
                If frmResponComp.Optionbrindarles.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!compromiso_vida = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!compromiso_vida = "No"
                End If
                frmMascotas.Adodc1.Recordset!txtvida = frmResponComp.txt6.Text
                frmMascotas.Adodc1.Recordset.Update
            End If
            
            'DESCRIPCION_VIVIENDA
            frmMascotas.Adodc1.RecordSource = "Select * from descripcion_vivienda where id_persona='" & id_pers & "'"
            frmMascotas.Adodc1.Refresh
            If frmMascotas.Adodc1.Recordset.EOF = True Then
                'CREAR EL REGISTRO SI NO EXISTE
                frmMascotas.Adodc1.RecordSource = "Select * from descripcion_vivienda"
                frmMascotas.Adodc1.Refresh
                frmMascotas.Adodc1.Recordset.AddNew
                frmMascotas.Adodc1.Recordset!id_tipo_vivienda = CInt(id_pers)
                frmMascotas.Adodc1.Recordset!id_persona = id_pers
                frmMascotas.Adodc1.Recordset!descripcion = Combo_tipov.Text
                If Combo_tipov.Text = "Depa" Then
                    frmMascotas.Adodc1.Recordset!permiten_mascotas = Combo_permiso.Text
                End If
                frmMascotas.Adodc1.Recordset!alquilada = Combo_alq.Text
                If Combo_alq.Text = "Alquilada" Then
                    frmMascotas.Adodc1.Recordset!mudanza = Combo_mudanza
                End If
                frmMascotas.Adodc1.Recordset!adecuado_mascotas = Combo_segura.Text
                If Check1.Value = "1" Then
                    frmMascotas.Adodc1.Recordset!jardin_interno = "Sí"
                Else
                        frmMascotas.Adodc1.Recordset!jardin_interno = "No"
                End If
                If Check2.Value = "1" Then
                    frmMascotas.Adodc1.Recordset!jardin_externo = "Sí"
                Else
                        frmMascotas.Adodc1.Recordset!jardin_externo = "No"
                End If
                If Check3.Value = "1" Then
                    frmMascotas.Adodc1.Recordset!patio_interno = "Sí"
                Else
                        frmMascotas.Adodc1.Recordset!patio_interno = "No"
                End If
                If Check4.Value = "1" Then
                    frmMascotas.Adodc1.Recordset!patio_externo = "Sí"
                Else
                        frmMascotas.Adodc1.Recordset!patio_externo = "No"
                End If
                If Check5.Value = "1" Then
                    frmMascotas.Adodc1.Recordset!ventanas_calle = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!ventanas_calle = "No" 
                End If
                If Combo1.Text = "Rejas" Then
                    frmMascotas.Adodc1.Recordset!rejas_malla = "Rejas"
                Else
                        frmMascotas.Adodc1.Recordset!rejas_malla = "Malla"
                End If
                If Option_fumsi = "True" Then
                    frmMascotas.Adodc1.Recordset!fumigado = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!fumigado = "No"
                End If
                frmMascotas.Adodc1.Recordset.Update
            Else
             frmMascotas.Adodc1.Recordset!descripcion = Combo_tipov.Text
                If Combo_tipov.Text = "Depa" Then
                    frmMascotas.Adodc1.Recordset!permiten_mascotas = Combo_permiso.Text
                End If
                frmMascotas.Adodc1.Recordset!alquilada = Combo_alq.Text
                If Combo_alq.Text = "Alquilada" Then
                    frmMascotas.Adodc1.Recordset!mudanza = Combo_mudanza.Text
                End If
                frmMascotas.Adodc1.Recordset!adecuado_mascotas = Combo_segura.Text
                If Check1.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!jardin_interno = "Sí"
                Else
                        frmMascotas.Adodc1.Recordset!jardin_interno = "No"
                End If
                If Check2.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!jardin_externo = "Sí"
                Else
                        frmMascotas.Adodc1.Recordset!jardin_externo = "No"
                End If
                If Check3.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!patio_interno = "Sí"
                Else
                        frmMascotas.Adodc1.Recordset!patio_interno = "No"
                End If
                If Check4.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!patio_externo = "Sí"
                Else
                        frmMascotas.Adodc1.Recordset!patio_externo = "No"
                End If
                If Check5.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!ventanas_calle = "Sí"
                Else
                        frmMascotas.Adodc1.Recordset!ventanas_calle = "No"
                End If
                If Option_fumsi = "True" Then
                    frmMascotas.Adodc1.Recordset!fumigado = "Sí"
                Else
                    frmMascotas.Adodc1.Recordset!fumigado = "No"
                End If
                frmMascotas.Adodc1.Recordset!rejas_malla = Combo1.Text
                frmMascotas.Adodc1.Recordset.Update
            End If
            'INTERESES_ADOPTANTES
            frmMascotas.Adodc1.RecordSource = "Select * from intereses_adoptante where id_persona ='"& id_pers & "'"
            frmMascotas.Adodc1.Refresh
            If frmMascotas.Adodc1.Recordset.EOF = True Then
                frmMascotas.Adodc1.RecordSource = "Select * from intereses_adoptante"
                frmMascotas.Adodc1.Refresh
                frmMascotas.Adodc1.Recordset.AddNew
                frmMascotas.Adodc1.Recordset!id_interes = CInt(id_pers)
                frmMascotas.Adodc1.Recordset!id_persona = id_pers
                frmMascotas.Adodc1.Recordset!motivo_adopcion = frmVivienda_Familia.txtmotivo.Text
                If frmVivienda_Familia.Option_mas.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!tuvo_mascotas = "Sí"
                    frmMascotas.Adodc1.Recordset!sit_mascota_anterior = frmVivienda_Familia.Text2.Text
                Else
                    frmMascotas.Adodc1.Recordset!tuvo_mascotas = "No"
                End If
                If frmVivienda_Familia.Option_cuidados.Value = "True" Then
                    frmMascotas.Adodc1.Recordset!conocimiento_cuidados = "Sí"
                    frmMascotas.Adodc1.Recordset!detalle_conocimientos = frmVivienda_Familia.txtDesc.Text
                Else
                    frmMascotas.Adodc1.Recordset!conocimiento_cuidados = "No"
                End If
                frmMascotas.Adodc1.Recordset!viaje_planeado = frmVivienda_Familia.Combo_viajes.Text
                frmMascotas.Adodc1.Recordset!detalle_viaje = frmVivienda_Familia.Text3.Text
                frmMascotas.Adodc1.Recordset!tiempo_paciencia =frmVivienda_Familia.Combo_paciencia.Text
                frmMascotas.Adodc1.Recordset.Update
            Else
                frmMascotas.Adodc1.Recordset!motivo_adopcion = frmVivienda_Familia.txtmotivo.Text
                If frmVivienda_Familia.Option_mas.Value = 1 Then
                    frmMascotas.Adodc1.Recordset!tuvo_mascotas = "Sí"
                    frmMascotas.Adodc1.Recordset!sit_mascota_anterior = frmVivienda_Familia.Text2.Text
                Else
                    frmMascotas.Adodc1.Recordset!tuvo_mascotas = "No"
                End If
                If frmVivienda_Familia.Option_cuidados.Value = "True" Then
                    frmMascotas.Adodc1.Recordset!conocimiento_cuidados = "Sí"
                    frmMascotas.Adodc1.Recordset!detalle_conocimientos = frmVivienda_Familia.txtDesc.Text
                Else
                    frmMascotas.Adodc1.Recordset!conocimiento_cuidados = "No"
                End If
                frmMascotas.Adodc1.Recordset!viaje_planeado = frmVivienda_Familia.Combo_viajes.Text
                frmMascotas.Adodc1.Recordset!detalle_viaje = frmVivienda_Familia.Text3.Text
                frmMascotas.Adodc1.Recordset!tiempo_paciencia = frmVivienda_Familia.Combo_paciencia.Text
                frmMascotas.Adodc1.Recordset.Update
                MsgBox ("Registro de Persona actualizado")
            End If
End If
End Sub
Private Sub cmdUpdate_Click()
frmVivienda_Familia.Combo_persona.AddItem Combo_persona.Text
frmVivienda_Familia.Combo_persona.Enabled = False
frmResponComp.Combo_persona.AddItem Combo_persona.Text
frmResponComp.Combo_persona.Enabled = False
txtFields(1).Enabled = True
Combo_sexo.Enabled = True
txtFields(3).Enabled = True
txtfnacimiento.Enabled = False
txtFields(4).Enabled = True
Picture1.Enabled = True
txtfijo.Enabled = True
txtFields(6).Enabled = True
txtFields(7).Enabled = True
txtFields(11).Enabled = True
Combo_distrito.Enabled = True
txtFields(8).Enabled = True
Combo_contacto.Enabled = True
txt_otros.Enabled = True
txtFRegistro.Enabled = True
Picture2.Enabled = True
txtfcontacto.Enabled = True
Picture3.Enabled = True
Combo_tipov.Enabled = True
Combo_permiso.Enabled = True
Combo_alq.Enabled = True
Combo_mudanza.Enabled = True
Combo_segura.Enabled = True
Combo1.Enabled = True
Combo1.AddItem "No"
Combo1.AddItem "Rejas"
Combo1.AddItem "Malla"
Combo_tipo_interes.Enabled = True
Check1.Enabled = True
Check2.Enabled = True
Check3.Enabled = True
Check4.Enabled = True
Check5.Enabled = True
Option_fumsi.Enabled = True
Option_fumno.Enabled = True
frmVivienda_Familia.Combo_persona.Enabled = True
frmVivienda_Familia.Combo_alergias.Enabled = True
frmVivienda_Familia.Text2.Enabled = True
frmVivienda_Familia.Combo_embarazo.Enabled = True
frmVivienda_Familia.Combo_hfueras.Enabled = True
frmVivienda_Familia.Combo_npersonas.Enabled = True
frmVivienda_Familia.Combo_rmasc.Enabled = True
frmVivienda_Familia.Combo_tpersonas.Enabled = True
frmVivienda_Familia.Combo_viajes.Enabled = True
frmVivienda_Familia.Option_cuidadon.Enabled = True
frmVivienda_Familia.Option_cuidados.Enabled = True
frmVivienda_Familia.Option_gato.Enabled = False
frmVivienda_Familia.Option_mas.Enabled = True
frmVivienda_Familia.Option_perro.Enabled = False
frmVivienda_Familia.Optionmcsi.Enabled = True
frmVivienda_Familia.Optionmn.Enabled = True
frmVivienda_Familia.txtDesc.Enabled = True
frmVivienda_Familia.txtmotivo.Enabled = True
frmVivienda_Familia.Text1.Enabled = False
frmVivienda_Familia.Combo_paciencia.Enabled = False
frmResponComp.txtAcc.Enabled = False
frmResponComp.txtSitMasc.Enabled = False
frmResponComp.txtsiviaja.Enabled = False
frmResponComp.Combo_Edad.Enabled = True
frmResponComp.Combo_frecuencia.Enabled = True
frmResponComp.Combo_persona.Enabled = True
frmResponComp.Combo_Resp.Enabled = True
frmResponComp.txtLista_acceso.Enabled = True
frmResponComp.Option_abandonon.Enabled = True
frmResponComp.Option_abandonos.Enabled = True
frmResponComp.Option_acuerdon.Enabled = True
frmResponComp.Option_acuerdos.Enabled = True
frmResponComp.Option_centvetn.Enabled = True
frmResponComp.Option_centvets.Enabled = True
frmResponComp.Optionbrindarlen.Enabled = True
frmResponComp.Optionbrindarles.Enabled = True
frmResponComp.Optioncuidadon.Enabled = True
frmResponComp.Optioncuidados.Enabled = True
frmResponComp.Optionimpren.Enabled = True
frmResponComp.Optionimpres.Enabled = True
frmResponComp.Optiontiempon.Enabled = True
frmResponComp.Optiontiempos.Enabled = True
frmResponComp.txt1.Enabled = True
frmResponComp.txt2.Enabled = True
frmResponComp.txt3.Enabled = True
frmResponComp.txt4.Enabled = True
frmResponComp.txt5.Enabled = True
frmResponComp.txt6.Enabled = True
frmResponComp.txtCuidados.Enabled = True
frmResponComp.txtCent.Enabled = True
frmResponComp.Frame1.Enabled = True
frmResponComp.Frame2.Enabled = True
Picture1.Enabled = True
Picture3.Enabled = True 
Picture2.Enabled = True
txtFields(3).Enabled = True
txtfnacimiento.Enabled = True
txtFields(4).Enabled = False
Picture1.Enabled = True
txtfijo.Enabled = True
txtFields(6).Enabled = True
txtFields(7).Enabled = True
txtFields(11).Enabled = True
Combo_distrito.Enabled = True
txtFields(8).Enabled = True
Combo_contacto.Enabled = True
txt_otros.Enabled = True
txtFRegistro.Enabled = False
Picture2.Enabled = True
txtfcontacto.Enabled = True
Combo_tipov.Enabled = True
Combo_tipov.AddItem "Casa"
Combo_tipov.AddItem "Depa"
Combo_permiso.Enabled = True
Combo_permiso.AddItem "Sí"
Combo_permiso.AddItem "No"
Combo_alq.Enabled = True
Combo_alq.AddItem "Propia"
Combo_alq.AddItem "Alquilada"
Combo_mudanza.Enabled = True
Combo_mudanza.AddItem "Lo devuelvo al albergue"
Combo_mudanza.AddItem "Se va conmigo"
Combo_mudanza.AddItem "Depende de las nuevas condiciones"
Combo_segura.Enabled = True
Combo_segura.AddItem "Sí"
Combo_segura.AddItem "No"
frmVivienda_Familia.Combo_paciencia.AddItem "Sí"
frmVivienda_Familia.Combo_paciencia.AddItem "No"
Option_fumsi.Enabled = True
Option_fumno.Enabled = True
frmVivienda_Familia.Combo_alergias.AddItem "Sí"
frmVivienda_Familia.Combo_alergias.AddItem "No"
frmVivienda_Familia.Combo_embarazo.AddItem "No"
frmVivienda_Familia.Combo_embarazo.AddItem "Si, hay un embarazo"
frmVivienda_Familia.Combo_embarazo.AddItem "Tenemos planes en el corto tiempo"
frmVivienda_Familia.Combo_rmasc.AddItem "Bien"
frmVivienda_Familia.Combo_rmasc.AddItem "Mal"
frmVivienda_Familia.Combo_tpersonas.AddItem "Adulto(s)"
frmVivienda_Familia.Combo_tpersonas.AddItem "Familia"
frmVivienda_Familia.Combo_tpersonas.AddItem "Joven<25"
frmVivienda_Familia.Combo_tpersonas.AddItem "Senior"
frmVivienda_Familia.Combo_viajes.AddItem "No"
frmVivienda_Familia.Combo_viajes.AddItem "Viaje_semanas"
frmVivienda_Familia.Combo_viajes.AddItem "Viaje_1_2_meses"
frmVivienda_Familia.Combo_viajes.AddItem "Viajes_2_anos"
frmResponComp.Combo_frecuencia.AddItem "1 vez al día"
frmResponComp.Combo_frecuencia.AddItem "2 veces al día"
frmResponComp.Combo_frecuencia.AddItem "3 veces al día"
i = 1
Do Until i = 75
   frmResponComp.Combo_Edad.AddItem (i)
   i = i + 1
Loop
i = 1
Do Until i = 20
   frmVivienda_Familia.Combo_hfueras.AddItem (i)
   i = i + 1
Loop
frmMascotas.Adodc1.RecordSource = "Select nombre_distrito from distrito"
frmMascotas.Adodc1.Refresh
With frmMascotas.Adodc1.Recordset
   Do Until .EOF
       Combo_distrito.AddItem frmMascotas.Adodc1.Recordset!nombre_distrito
       .MoveNext
   Loop
End With
frmMascotas.Adodc1.RecordSource = "Select descripcion from medio_contacto"
frmMascotas.Adodc1.Refresh
With frmMascotas.Adodc1.Recordset
   Do Until .EOF
       Combo_contacto.AddItem frmMascotas.Adodc1.Recordset!descripcion
       .MoveNext
   Loop
End With
frmResponComp.Combo_Resp.AddItem "Yo"
frmResponComp.Combo_Resp.AddItem "Otro"
frmVivienda_Familia.Combo_masc_act.Enabled = True
frmVivienda_Familia.Combo_masc_act.AddItem "1"
frmVivienda_Familia.Combo_masc_act.AddItem "2"
frmVivienda_Familia.Combo_masc_act.AddItem "3"
frmVivienda_Familia.Combo_masc_act.AddItem "4"
frmVivienda_Familia.Combo_masc_act.AddItem "5"
frmVivienda_Familia.Combo_npersonas.AddItem "1"
frmVivienda_Familia.Combo_npersonas.AddItem "2"
frmVivienda_Familia.Combo_npersonas.AddItem "3"
frmVivienda_Familia.Combo_npersonas.AddItem "4"
frmVivienda_Familia.Combo_npersonas.AddItem "5"
frmVivienda_Familia.Combo_npersonas.AddItem "6"
frmVivienda_Familia.Combo_npersonas.AddItem "7"
frmVivienda_Familia.Combo_npersonas.AddItem "8"
frmVivienda_Familia.Combo_npersonas.AddItem "9"
frmVivienda_Familia.Combo_npersonas.AddItem "10"
frmResponComp.Combo_juego.AddItem "30 minutos"
frmResponComp.Combo_juego.AddItem "1-2 horas"
frmResponComp.Combo_juego.AddItem "2-3 horas"
frmResponComp.Combo_juego.AddItem "3-4 horas"
frmResponComp.Combo_juego.AddItem "4-5 horas"
Save = 4
End Sub
Private Sub cmdClose_Click()
Unload Me
frmMenuOpciones.Show
End Sub
Private Sub Combo_persona_Click()
Dim str As String
Dim valor As String
Dim a_web As String
Dim id_pers, fum, aler, tmasc, cuid, vet, acuerdos, tiempos, abandono, cuidados1, impresc, vida, Color, tipo As String
Dim f1, f2, f3, f4, f5, f6, f7, f8, f9, sit_bebe As Variant
Dim id_distrito, id_medio, id_color, apad, adop As Integer
valor = Combo_persona.Text
frmMascotas.Adodc1.RecordSource = "select * from persona where nombre='" & valor & "'"
frmMascotas.Adodc1.Refresh
id_pers = CStr(frmMascotas.Adodc1.Recordset!id_persona)
If IsNull(frmMascotas.Adodc1.Recordset!dni) = True Or frmMascotas.Adodc1.Recordset!dni = "" Then
    txtFields(1).Text = ""
Else
    txtFields(1).Text = frmMascotas.Adodc1.Recordset!dni
End If
If IsNull(frmMascotas.Adodc1.Recordset!nacionalidad) = True Or frmMascotas.Adodc1.Recordset!nacionalidad = "" Then
    txtFields(3).Text = ""
Else
    txtFields(3).Text = frmMascotas.Adodc1.Recordset!nacionalidad
End If
If IsNull(frmMascotas.Adodc1.Recordset!tipo_interes) = True Or frmMascotas.Adodc1.Recordset!tipo_interes = "" Then
    Combo_tipo_interes.Text = ""
Else
    Combo_tipo_interes.AddItem frmMascotas.Adodc1.Recordset!tipo_interes
End If
If IsNull(frmMascotas.Adodc1.Recordset!email) = True Or frmMascotas.Adodc1.Recordset!email = "" Then
    txtFields(4).Text = ""
Else
    txtFields(4).Text = frmMascotas.Adodc1.Recordset!email
End If
If IsNull(frmMascotas.Adodc1.Recordset!tel_cel) = True Or frmMascotas.Adodc1.Recordset!tel_cel = "" Then
    txtFields(6).Text = ""
Else
 txtFields(6).Text = frmMascotas.Adodc1.Recordset!tel_cel
End If
If IsNull(frmMascotas.Adodc1.Recordset!direccion) = True Or frmMascotas.Adodc1.Recordset!direccion = "" Then
txtFields(11).Text = ""
Else
    txtFields(11).Text = frmMascotas.Adodc1.Recordset!direccion
End If
If IsNull(frmMascotas.Adodc1.Recordset!sexo) = True Or frmMascotas.Adodc1.Recordset!sexo = "" Then
    Combo_sexo.AddItem ""
Else
    Combo_sexo.AddItem frmMascotas.Adodc1.Recordset!sexo
    Combo_sexo.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!f_nacimiento) = True Or frmMascotas.Adodc1.Recordset!f_nacimiento = "" Then
    txtfnacimiento.Text = ""
Else
    txtfnacimiento.Text = Format$(frmMascotas.Adodc1.Recordset!f_nacimiento, "dd/mm/yyyy")
End If
If IsNull(frmMascotas.Adodc1.Recordset!tel_fijo) = True Or frmMascotas.Adodc1.Recordset!tel_fijo = "" Then
    txtfijo.Text = ""
Else
    txtfijo.Text = frmMascotas.Adodc1.Recordset!tel_fijo
End If
If IsNull(frmMascotas.Adodc1.Recordset!ocupacion) = True Or frmMascotas.Adodc1.Recordset!ocupacion = "" Then
    txtFields(7).Text = ""
Else
    txtFields(7).Text = frmMascotas.Adodc1.Recordset!ocupacion
End If
If IsNull(frmMascotas.Adodc1.Recordset!centro_trabajo) = True Or frmMascotas.Adodc1.Recordset!centro_trabajo = "" Then
    txtFields(8).Text = ""
Else
  txtFields(8).Text = frmMascotas.Adodc1.Recordset!centro_trabajo
End If
If IsNull(frmMascotas.Adodc1.Recordset!f_registro) = True Or frmMascotas.Adodc1.Recordset!f_registro = "" Then
    txtFRegistro.Text = ""
Else
    txtFRegistro.Text = Format$(frmMascotas.Adodc1.Recordset!f_registro, "dd/mm/yyyy")
End If
If IsNull(frmMascotas.Adodc1.Recordset!f_contacto) = True Or frmMascotas.Adodc1.Recordset!f_contacto = "" Then
    txtfcontacto.Text = ""
Else
    txtfcontacto.Text = Format$(frmMascotas.Adodc1.Recordset!f_contacto, "dd/mm/yyyy")
End If
If IsNull(frmMascotas.Adodc1.Recordset!id_distrito) = True Or frmMascotas.Adodc1.Recordset!id_distrito = "" Then
    id_distrito = 0
Else
    id_distrito = CInt(frmMascotas.Adodc1.Recordset!id_distrito)
End If
If IsNull(frmMascotas.Adodc1.Recordset!id_medio) = True Or frmMascotas.Adodc1.Recordset!id_medio = "" Then
    id_distrito = 0
Else
    id_medio = CInt(frmMascotas.Adodc1.Recordset!id_medio)
End If
If id_distrito = 0 Then
    Combo_distrito.Text = ""
Else
    frmMascotas.Adodc1.RecordSource = "select nombre_distrito from distrito where id_distrito=" & id_distrito
    frmMascotas.Adodc1.Refresh
    Combo_distrito.AddItem frmMascotas.Adodc1.Recordset!nombre_distrito
    Combo_distrito.ListIndex = 0
End If
If id_medio = 0 Then
Combo_contacto.Text = ""
Else
    frmMascotas.Adodc1.RecordSource = "Select descripcion from medio_contacto where id_medio=" & id_medio
    frmMascotas.Adodc1.Refresh
    Combo_contacto.AddItem frmMascotas.Adodc1.Recordset!descripcion
    Combo_contacto.ListIndex = 0
End If
' descripcion_familia
frmMascotas.Adodc1.RecordSource = "select * from descripcion_familia where id_persona='" & id_pers & "'"
frmMascotas.Adodc1.Refresh
If frmMascotas.Adodc1.Recordset.EOF = True Then
Else
If IsNull(frmMascotas.Adodc1.Recordset!tipo) = True Or frmMascotas.Adodc1.Recordset!tipo = "" Then
    frmVivienda_Familia.Combo_tpersonas.Text = ""
Else
    frmVivienda_Familia.Combo_tpersonas.AddItem frmMascotas.Adodc1.Recordset!tipo
    frmVivienda_Familia.Combo_tpersonas.ListIndex = 0
End If
If frmMascotas.Adodc1.Recordset!num_persona = "" Or IsNull(frmMascotas.Adodc1.Recordset!num_persona) = True Then
    frmVivienda_Familia.Combo_npersonas.Text = ""
Else
    frmVivienda_Familia.Combo_npersonas.AddItem frmMascotas.Adodc1.Recordset!num_persona
    frmVivienda_Familia.Combo_npersonas.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!alergico_pelo) = True Or frmMascotas.Adodc1.Recordset!alergico_pelo = "" Then
    frmVivienda_Familia.Combo_alergias.Text = ""
Else
    frmVivienda_Familia.Combo_alergias.AddItem frmMascotas.Adodc1.Recordset!alergico_pelo
    frmVivienda_Familia.Combo_alergias.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!embarazadas) = True Or frmMascotas.Adodc1.Recordset!embarazadas = "" Then
    frmVivienda_Familia.Combo_embarazo.Text = ""
Else
    frmVivienda_Familia.Combo_embarazo.AddItem frmMascotas.Adodc1.Recordset!embarazadas
    frmVivienda_Familia.Combo_embarazo.ListIndex = 0
End If
If frmMascotas.Adodc1.Recordset!num_mascotas_actual <> 0 Then
    frmVivienda_Familia.Optionmcsi = True
Else
        frmVivienda_Familia.Optionmn = True
End If
If IsNull(frmMascotas.Adodc1.Recordset!sit_bebe) = True Or frmMascotas.Adodc1.Recordset!sit_bebe = "" Then
    frmVivienda_Familia.Text1.Text = ""
Else
    frmVivienda_Familia.Text1.Text = frmMascotas.Adodc1.Recordset!sit_bebe
End If
If IsNull(frmMascotas.Adodc1.Recordset!talergia) = True Or frmMascotas.Adodc1.Recordset!talergia = "" Then
    frmVivienda_Familia.Option_perro = False
    frmVivienda_Familia.Option_gato = False
Else
    aler = frmMascotas.Adodc1.Recordset!talergia
    If aler = "Sí" Then
        frmVivienda_Familia.Option_perro = True
        frmVivienda_Familia.Option_gato = False
    Else
        frmVivienda_Familia.Option_gato = True
        frmVivienda_Familia.Option_perro = False
    End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!num_mascotas_actual) = True Or frmMascotas.Adodc1.Recordset!num_mascotas_actual = "" Then
    frmVivienda_Familia.Combo_masc_act.AddItem ""
Else
    frmVivienda_Familia.Combo_masc_act.AddItem frmMascotas.Adodc1.Recordset!num_mascotas_actual
    frmVivienda_Familia.Combo_masc_act.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!horas_mascota_solo) = True Or frmMascotas.Adodc1.Recordset!horas_mascota_solo = "" Then
    frmVivienda_Familia.Combo_hfueras.AddItem ""
Else
    frmVivienda_Familia.Combo_hfueras.AddItem frmMascotas.Adodc1.Recordset!horas_mascota_solo
    frmVivienda_Familia.Combo_hfueras.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!relacion_otras_mascotas) = True Or frmMascotas.Adodc1.Recordset!relacion_otras_mascotas = "" Then
    frmVivienda_Familia.Combo_rmasc.AddItem ""
Else
    frmVivienda_Familia.Combo_rmasc.AddItem frmMascotas.Adodc1.Recordset!relacion_otras_mascotas
    frmVivienda_Familia.Combo_rmasc.ListIndex = 0
End If
End If
' Intereses_Adoptante
frmMascotas.Adodc1.RecordSource = "Select * from intereses_adoptante where id_persona='" & id_pers & "'"
frmMascotas.Adodc1.Refresh
If frmMascotas.Adodc1.Recordset.EOF = True Then
Else
If IsNull(frmMascotas.Adodc1.Recordset!tuvo_mascotas) = True Or frmMascotas.Adodc1.Recordset!tuvo_mascotas = "" Then
    frmVivienda_Familia.Option_mas.Value = 0
    frmVivienda_Familia.Option_man.Value = 0
Else
    tmasc = frmMascotas.Adodc1.Recordset!tuvo_mascotas
    If tmasc = "Sí" Then
        frmVivienda_Familia.Option_mas.Value = 1
        frmVivienda_Familia.Text2.Enabled = True
    Else
        If tmasc = "No" Then
            frmVivienda_Familia.Option_man.Value = 0
        End If
    End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!sit_mascota_anterior) = True Or frmMascotas.Adodc1.Recordset!sit_mascota_anterior = "" Then
    frmVivienda_Familia.Text2.Text = ""
Else
    frmVivienda_Familia.Text2.Text = frmMascotas.Adodc1.Recordset!sit_mascota_anterior
End If
If IsNull(frmMascotas.Adodc1.Recordset!conocimiento_cuidados) = True Or frmMascotas.Adodc1.Recordset!conocimiento_cuidados = "" Then
    frmVivienda_Familia.Option_cuidados = False
    frmVivienda_Familia.Option_cuidadon = False
Else
    cuid = frmMascotas.Adodc1.Recordset!conocimiento_cuidados
    If cuid = "Sí" Then
        frmVivienda_Familia.Option_cuidados = True
        frmVivienda_Familia.Option_cuidadon = False
   Else
        If cuid = "No" Then
        frmVivienda_Familia.Option_cuidadon = True
        frmVivienda_Familia.Option_cuidados = False
        End If
    End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!detalle_conocimientos) = True Or frmMascotas.Adodc1.Recordset!detalle_conocimientos = "" Then
    frmVivienda_Familia.txtDesc.Text = ""
Else
    frmVivienda_Familia.txtDesc.Text = frmMascotas.Adodc1.Recordset!detalle_conocimientos
End If
If IsNull(frmMascotas.Adodc1.Recordset!motivo_adopcion) = True Or frmMascotas.Adodc1.Recordset!motivo_adopcion = "" Then
    frmVivienda_Familia.txtmotivo = ""
Else
    frmVivienda_Familia.txtmotivo.Text = frmMascotas.Adodc1.Recordset!motivo_adopcion
End If
If IsNull(frmMascotas.Adodc1.Recordset!viaje_planeado) = True Or frmMascotas.Adodc1.Recordset!viaje_planeado = "" Then
    frmVivienda_Familia.Combo_viajes.AddItem ""
Else
    frmVivienda_Familia.Combo_viajes.AddItem frmMascotas.Adodc1.Recordset!viaje_planeado
    frmVivienda_Familia.Combo_viajes.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!detalle_viaje) = True Or frmMascotas.Adodc1.Recordset!detalle_viaje = "" Then
    frmVivienda_Familia.Text3 = ""
Else
    frmVivienda_Familia.Text3 = frmMascotas.Adodc1.Recordset!detalle_viaje
End If
If IsNull(frmMascotas.Adodc1.Recordset!tiempo_paciencia) = True Or frmMascotas.Adodc1.Recordset!tiempo_paciencia = "" Then
    frmVivienda_Familia.Combo_paciencia.Text = ""
Else
    frmVivienda_Familia.Combo_paciencia.AddItem frmMascotas.Adodc1.Recordset!tiempo_paciencia
    frmVivienda_Familia.Combo_paciencia.ListIndex = 0
End If
End If
'Compromiso_persona
frmMascotas.Adodc1.RecordSource = "Select * from compromiso_persona where id_persona='" & id_pers & "'"
frmMascotas.Adodc1.Refresh
If frmMascotas.Adodc1.Recordset.EOF = True Then
Else
If IsNull(frmMascotas.Adodc1.Recordset!todos_acuerdo) = True Or frmMascotas.Adodc1.Recordset!todos_acuerdo = "" Then
    frmResponComp.Option_acuerdos.Value = 0
    frmResponComp.Option_acuerdon.Value = 0
Else
acuerdos = frmMascotas.Adodc1.Recordset!todos_acuerdo
If acuerdos = "Sí" Then
    frmResponComp.Option_acuerdos.Value = 1
    frmResponComp.Option_acuerdon.Value = 0
Else
    If acuerdos = "No" Then
    frmResponComp.Option_acuerdon.Value = 1
    frmResponComp.Option_acuerdos.Value = 0
    End If
End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!txt_acuerdo) = True Or frmMascotas.Adodc1.Recordset!txt_acuerdo = "" Then
    frmResponComp.txt1.Text = ""
Else 
    frmResponComp.txt1.Text = frmMascotas.Adodc1.Recordset!txtacuerdo
End If
tiempos = frmMascotas.Adodc1.Recordset!tiempo_dedicacion
If tiempos = "Sí" Then
    frmResponComp.Optiontiempos.Value = 1
    frmResponComp.Optiontiempon.Value = 0
Else
    If tiempos = "No" Then
        frmResponComp.Optiontiempon.Value = 1
        frmResponComp.Optiontiempos.Value = 0
    End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!txttiempo) = True Or frmMascotas.Adodc1.Recordset!txttiempo = "" Then
    frmResponComp.txt2.Text = ""
Else
    frmResponComp.txt2.Text = frmMascotas.Adodc1.Recordset!txttiempo
End If
abandon = frmMascotas.Adodc1.Recordset!compromiso_mudanza
If abandon = "Sí" Then
    frmResponComp.Option_abandonos.Value = 1
    frmResponComp.Option_abandonon.Value = 0
Else
    If abandon = "No" Then
    frmResponComp.Option_abandonon.Value = 1
    frmResponComp.Option_abandonos.Value = 0
    End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!txtabandono) = True Or frmMascotas.Adodc1.Recordset!txtabandono = "" Then
    frmResponComp.txt3.Text = ""
 Else
    frmResponComp.txt3.Text = frmMascotas.Adodc1.Recordset!txtabandono
End If
cuidados1 = frmMascotas.Adodc1.Recordset!compromiso_cuidado
If cuidados1 = "Sí" Then
    frmResponComp.Optioncuidados.Value = 1
    frmResponComp.Optioncuidadon.Value = 0
 Else
    If cuidados1 = "No" Then
    frmResponComp.Optioncuidadon.Value = 1
    frmResponComp.Optioncuidados.Value = 0
    End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!txtcuidado1) = True Or frmMascotas.Adodc1.Recordset!txtcuidado1 = "" Then

    frmResponComp.txt4.Text = ""
    
Else
    frmResponComp.txt4.Text = frmMascotas.Adodc1.Recordset!txtcuidado1
End If
impresc = frmMascotas.Adodc1.Recordset!compromiso_cuidado_imprescindible
If impresc = "Sí" Then
    frmResponComp.Optionimpres.Value = 1
    frmResponComp.Optionimpren.Value = 0
    
Else
    If impresc = "No" Then
    frmResponComp.Optionimpren.Value = 1
    frmResponComp.Optionimpres.Value = 0
    End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!txtimpres) = True Or frmMascotas.Adodc1.Recordset!txtimpres = "" Then

    frmResponComp.txt5.Text = ""
    
Else
    frmResponComp.txt5.Text = frmMascotas.Adodc1.Recordset!txtimpres
End If
vida = frmMascotas.Adodc1.Recordset!compromiso_vida
If vida = "Sí" Then
    frmResponComp.Optionbrindarles.Value = 1
    frmResponComp.Optionbrindarlen.Value = 0
    
Else
    If vida = "No" Then
    frmResponComp.Optionbrindarlen.Value = 1
    frmResponComp.Optionbrindarles.Value = 0
    End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!txtvida) = True Or frmMascotas.Adodc1.Recordset!txtvida = "" Then
    frmResponComp.txt6.Text = ""
else
    frmResponComp.txt6.Text = frmMascotas.Adodc1.Recordset!txtvida
End If
End If
'Responsabilidades
frmMascotas.Adodc1.RecordSource = "select * from responsabilidades where id_persona='" & id_pers & "'"
frmMascotas.Adodc1.Refresh
If frmMascotas.Adodc1.Recordset.EOF = True Then
Else
If IsNull(frmMascotas.Adodc1.Recordset!responsable_directo) = True Or frmMascotas.Adodc1.Recordset!responsable_directo = "" Then
    frmResponComp.Combo_Resp.Text = ""
Else
    frmResponComp.Combo_Resp.AddItem frmMascotas.Adodc1.Recordset!responsable_directo
    frmResponComp.Combo_Resp.ListIndex = 0
    If frmResponComp.Combo_Resp.Text = "Otro" Then
        If IsNull(frmMascotas.Adodc1.Recordset!edad_responsable) = True Then
            Combo_Edad.Text = ""
        Else
            frmResponComp.Combo_Edad.AddItem frmMascotas.Adodc1.Recordset!edad_responsable
            frmResponComp.Combo_Edad.ListIndex = 0
        End If
    Else
        frmResponComp.Combo_Edad.Text = ""
    End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!ambientes_habilitados) = True Or frmMascotas.Adodc1.Recordset!ambientes_habilitados = "" Then
    frmResponComp.txtLista_acceso.Text = ""
else
    frmResponComp.txtLista_acceso.Text = frmMascotas.Adodc1.Recordset!ambientes_habilitados
End If
If IsNull(frmMascotas.Adodc1.Recordset!frecuencia_paseo) = True Or frmMascotas.Adodc1.Recordset!frecuencia_paseo = "" Then
    frmResponComp.Combo_frecuencia.Text = ""
else
    frmResponComp.Combo_frecuencia.AddItem frmMascotas.Adodc1.Recordset!frecuencia_paseo
    frmResponComp.Combo_frecuencia.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!paseo_cuidados) = True Or frmMascotas.Adodc1.Recordset!paseo_cuidados = "" Then
    frmResponComp.txtCuidados.Text = ""
Else
    frmResponComp.txtCuidados.Text = frmMascotas.Adodc1.Recordset!paseo_cuidados
End If
If IsNull(frmMascotas.Adodc1.Recordset!horas_juego) = True Or frmMascotas.Adodc1.Recordset!horas_juego = "" Then
    frmResponComp.Combo_juego.Text = ""
Else
    frmResponComp.Combo_juego.AddItem frmMascotas.Adodc1.Recordset!horas_juego
    frmResponComp.Combo_juego.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!conoce_vet) = True Or frmMascotas.Adodc1.Recordset!conoce_vet = "" Then
    frmResponComp.Option_centvetn = False
    frmResponComp.Option_centvets = False
else
    vet = frmMascotas.Adodc1.Recordset!conoce_vet
    If vet = "Sí" Then
        frmResponComp.Option_centvets = True
        frmResponComp.Option_centvetn = False
        If IsNull(frmMascotas.Adodc1.Recordset!nombre_vet) = True Then
            frmResponComp.txtCent.Text = ""
        Else
            frmResponComp.txtCent.Text = frmMascotas.Adodc1.Recordset!nombre_vet
        End If
    Else
        If vet = "No" Then
        frmResponComp.Option_centvetn = True
        frmResponComp.Option_centvets = False
        End If
    End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!escape_mascota) = True Or frmMascotas.Adodc1.Recordset!escape_mascota = "" Then
    frmResponComp.txtAcc.Text = ""
    
Else
    frmResponComp.txtAcc.Text = frmMascotas.Adodc1.Recordset!escape_mascota
End If
If IsNull(frmMascotas.Adodc1.Recordset!ausencia_dueno_lugar) = True Then
    frmResponComp.txtSitMasc.Text = ""
Else
    frmResponComp.txtSitMasc.Text = frmMascotas.Adodc1.Recordset!ausencia_dueno_lugar
end If
If IsNull(frmMascotas.Adodc1.Recordset!si_viaja) = True Or frmMascotas.Adodc1.Recordset!si_viaja = "" Then
    frmResponComp.txtsiviaja = ""
Else
    frmResponComp.txtsiviaja.Text = frmMascotas.Adodc1.Recordset!si_viaja
End If
If IsNull(frmMascotas.Adodc1.Recordset!comportamiento) = True Or frmMascotas.Adodc1.Recordset!comportamiento = "" Then
    frmResponComp.txtComp = ""
Else
    frmResponComp.txtComp.Text = frmMascotas.Adodc1.Recordset!comportamiento
End If
End If
' descripcion_ vivienda
frmMascotas.Adodc1.RecordSource = "Select * from descripcion_vivienda where id_persona='" & id_pers & "'"
frmMascotas.Adodc1.Refresh
If frmMascotas.Adodc1.Recordset.EOF = True Then
Else
If IsNull(frmMascotas.Adodc1.Recordset!descripcion) = True Or frmMascotas.Adodc1.Recordset!descripcion = "" Then
    Combo_tipov.Text = ""
Else
    Combo_tipov.AddItem frmMascotas.Adodc1.Recordset!descripcion
    Combo_tipov.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!permiten_mascotas) = True Or frmMascotas.Adodc1.Recordset!permiten_mascotas = "" Then
    Combo_permiso.Text = ""
Else
    Combo_permiso.AddItem frmMascotas.Adodc1.Recordset!permiten_mascotas
    Combo_permiso.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!alquilada) = True Or frmMascotas.Adodc1.Recordset!alquilada = "" Then
	    Combo_alq.Text = ""
	Else
    Combo_alq.AddItem frmMascotas.Adodc1.Recordset!alquilada
    Combo_alq.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!mudanza) = True Or frmMascotas.Adodc1.Recordset!mudanza = "" Then
    Combo_mudanza.Text = ""
Else
    Combo_mudanza.AddItem frmMascotas.Adodc1.Recordset!mudanza
    Combo_mudanza.ListIndex = 0
End If
If IsNull(frmMascotas.Adodc1.Recordset!adecuado_mascotas) = True Or frmMascotas.Adodc1.Recordset!adecuado_mascotas = "" Then
    Combo_segura.AddItem ""
Else
    Combo_segura.AddItem frmMascotas.Adodc1.Recordset!adecuado_mascotas
    Combo_segura.ListIndex = 0
    If IsNull(frmMascotas.Adodc1.Recordset!rejas_malla) = True Or frmMascotas.Adodc1.Recordset!rejas_malla = "" Then
        Combo1.Text = ""
    Else
        Combo1.AddItem frmMascotas.Adodc1.Recordset!rejas_malla
        Combo1.ListIndex = 0
    End If
End If
If IsNull(frmMascotas.Adodc1.Recordset!fumigado) = True Or frmMascotas.Adodc1.Recordset!fumigado = "" Then
    Option_fumsi = False
    Option_fumno = False
Else
fum = frmMascotas.Adodc1.Recordset!fumigado
    If fum = "Sí" Then
        Option_fumsi = True
    Else
        If fum = "No" Then
        Option_fumno = True
        End If
    End If
End If
fum = frmMascotas.Adodc1.Recordset!jardin_interno
    If fum = "Sí" Then
        Check1.Value = True
    End If
fum = frmMascotas.Adodc1.Recordset!patio_interno
    If fum = "Sí" Then
        Check2.Value = True
    
    End If
fum = frmMascotas.Adodc1.Recordset!jardin_externo
    If fum = "Sí" Then
        Check3.Value = True
    End If
fum = frmMascotas.Adodc1.Recordset!patio_externo
    If fum = "Sí" Then
        Check4.Value = True
    End If
fum = frmMascotas.Adodc1.Recordset!ventanas_calle
    If fum = "Sí" Then
        Check5.Value = 1
    End If
End If
frmVivienda_Familia.Combo_persona.Clear
frmVivienda_Familia.Combo_persona.AddItem valor
frmVivienda_Familia.Combo_persona.ListIndex = 0
frmVivienda_Familia.Combo_persona.Enabled = False
frmResponComp.Combo_persona.Clear
frmResponComp.Combo_persona.AddItem valor
frmResponComp.Combo_persona.ListIndex = 0
frmResponComp.Combo_persona.Enabled = False
txtFields(1).Enabled = False
Combo_sexo.Enabled = False
txtFields(3).Enabled = False
txtfnacimiento.Enabled = False
txtFields(4).Enabled = False
frmVivienda_Familia.Text3.Enabled = False
Picture1.Enabled = False
txtfijo.Enabled = False
txtFields(6).Enabled = False
txtFields(7).Enabled = False
txtFields(11).Enabled = False
Combo_distrito.Enabled = False
txtFields(8).Enabled = False
Combo_contacto.Enabled = False
txt_otros.Enabled = False
Picture1.Enabled = False
Picture3.Enabled = False
Picture2.Enabled = False
txtFRegistro.Enabled = False
Picture2.Enabled = False
txtfcontacto.Enabled = False
Picture3.Enabled = False
Combo_tipov.Enabled = False
Combo_permiso.Enabled = False
Combo_alq.Enabled = False
Combo_mudanza.Enabled = False
Combo_segura.Enabled = False
Combo1.Enabled = False
Check1.Enabled = False
Check2.Enabled = False
Check3.Enabled = False
Check4.Enabled = False
Check5.Enabled = False
Option_fumsi.Enabled = False
Option_fumno.Enabled = False
frmVivienda_Familia.Combo_persona.Enabled = False
frmVivienda_Familia.Combo_alergias.Enabled = False
frmVivienda_Familia.Combo_masc_act.Enabled = False
frmVivienda_Familia.Combo_embarazo.Enabled = False
frmVivienda_Familia.Combo_hfueras.Enabled = False
frmVivienda_Familia.Combo_npersonas.Enabled = False
frmVivienda_Familia.Combo_rmasc.Enabled = False
frmVivienda_Familia.Combo_tpersonas.Enabled = False
frmVivienda_Familia.Combo_viajes.Enabled = False
frmVivienda_Familia.Option_cuidadon.Enabled = False
frmVivienda_Familia.Option_cuidados.Enabled = False
frmVivienda_Familia.Option_gato.Enabled = False
frmVivienda_Familia.Option_man.Enabled = False
frmVivienda_Familia.Option_mas.Enabled = False
frmVivienda_Familia.Option_perro.Enabled = False
frmVivienda_Familia.Optionmcsi.Enabled = False
frmVivienda_Familia.Optionmn.Enabled = False
frmVivienda_Familia.Text1.Enabled = False
frmVivienda_Familia.Combo_paciencia.Enabled = False
frmResponComp.txtAcc.Enabled = False
frmResponComp.txtSitMasc.Enabled = False
frmResponComp.txtsiviaja.Enabled = False
frmVivienda_Familia.txtDesc.Enabled = False
frmVivienda_Familia.txtmotivo.Enabled = False
frmVivienda_Familia.Text2.Enabled = False
frmResponComp.Combo_Edad.Enabled = False
frmResponComp.Combo_frecuencia.Enabled = False
frmResponComp.Combo_persona.Enabled = False
frmResponComp.Combo_Resp.Enabled = False
frmResponComp.txtLista_acceso.Enabled = False
frmResponComp.Option_abandonon.Enabled = False
frmResponComp.Option_abandonos.Enabled = False
frmResponComp.Option_acuerdon.Enabled = False
frmResponComp.Option_acuerdos.Enabled = False
frmResponComp.Option_centvetn.Enabled = False
frmResponComp.Option_centvets.Enabled = False
frmResponComp.Optionbrindarlen.Enabled = False
frmResponComp.Optionbrindarles.Enabled = False
frmResponComp.Optioncuidadon.Enabled = False
frmResponComp.Optioncuidados.Enabled = False
frmResponComp.Optionimpren.Enabled = False
frmResponComp.Optionimpres.Enabled = False
frmResponComp.Optiontiempon.Enabled = False
frmResponComp.Optiontiempos.Enabled = False
frmResponComp.txt1.Enabled = False
frmResponComp.txt2.Enabled = False
frmResponComp.txt3.Enabled = False
frmResponComp.txt4.Enabled = False
frmResponComp.txt5.Enabled = False
frmResponComp.txt6.Enabled = False
frmResponComp.txtCuidados.Enabled = False
frmResponComp.txtCent.Enabled = False
frmResponComp.Frame1.Enabled = False
frmResponComp.Frame2.Enabled = False
MonthView2.Visible = False
MonthView1.Visible = False
MonthView3.Visible = False
Picture1.Enabled = False
Picture2.Enabled = False
Picture3.Enabled = False
End Sub
Private Sub Command1_Click()
frmVivienda_Familia.Show
frmPersonas.Hide
End Sub
Private Sub Form_Load()
frmMascotas.Adodc1.RecordSource = "select nombre from persona order by nombre asc"
frmMascotas.Adodc1.Refresh
With frmMascotas.Adodc1.Recordset
    Do Until .EOF
          Combo_persona.AddItem frmMascotas.Adodc1.Recordset!nombre
        .MoveNext
    Loop
End With
txtFields(1).Enabled = False
Combo_sexo.Enabled = False
txtFields(3).Enabled = False
txtfnacimiento.Enabled = False
txtFields(4).Enabled = False
Picture1.Enabled = False
txtfijo.Enabled = False
txtFields(6).Enabled = False
txtFields(7).Enabled = False
txtFields(11).Enabled = False
Combo_distrito.Enabled = False
txtFields(8).Enabled = False
Combo_contacto.Enabled = False
txt_otros.Enabled = False
Picture1.Enabled = False
Picture3.Enabled = False
Picture2.Enabled = False
txtFRegistro.Enabled = False
Picture2.Enabled = False
txtfcontacto.Enabled = False
Picture3.Enabled = False
Combo_tipov.Enabled = False
Combo_permiso.Enabled = False
Combo_alq.Enabled = False
Combo_mudanza.Enabled = False
Combo_segura.Enabled = False
Combo1.Enabled = False
Check1.Enabled = False
Check2.Enabled = False
Check3.Enabled = False
Check4.Enabled = False
Check5.Enabled = False
Option_fumsi.Enabled = False
Option_fumno.Enabled = False
frmVivienda_Familia.Combo_persona.Enabled = False
frmVivienda_Familia.Combo_alergias.Enabled = False
frmVivienda_Familia.Combo_embarazo.Enabled = False
frmVivienda_Familia.Combo_hfueras.Enabled = False
frmVivienda_Familia.Combo_npersonas.Enabled = False
frmVivienda_Familia.Combo_rmasc.Enabled = False
frmVivienda_Familia.Combo_tpersonas.Enabled = False
frmVivienda_Familia.Combo_viajes.Enabled = False
frmVivienda_Familia.Option_cuidadon.Enabled = False
frmVivienda_Familia.Option_cuidados.Enabled = False
frmVivienda_Familia.Option_gato.Enabled = False
frmVivienda_Familia.Option_man.Enabled = False
frmVivienda_Familia.Option_mas.Enabled = False
frmVivienda_Familia.Option_perro.Enabled = False
frmVivienda_Familia.Optionmcsi.Enabled = False
frmVivienda_Familia.Optionmn.Enabled = False
frmVivienda_Familia.txtDesc.Enabled = False
frmVivienda_Familia.txtmotivo.Enabled = False
frmVivienda_Familia.Text2.Enabled = False
frmResponComp.Combo_Edad.Enabled = False
frmResponComp.Combo_frecuencia.Enabled = False
frmResponComp.Combo_persona.Enabled = False
frmResponComp.Combo_Resp.Enabled = False
frmResponComp.txtLista_acceso.Enabled = False
frmResponComp.Option_abandonon.Enabled = False
frmResponComp.Option_abandonos.Enabled = False
frmResponComp.Option_acuerdon.Enabled = False
frmResponComp.Option_acuerdos.Enabled = False
frmResponComp.Option_centvetn.Enabled = False
frmResponComp.Option_centvets.Enabled = False
frmResponComp.Optionbrindarlen.Enabled = False
frmResponComp.Optionbrindarles.Enabled = False
frmResponComp.Optioncuidadon.Enabled = False
frmResponComp.Optioncuidados.Enabled = False
frmResponComp.Optionimpren.Enabled = False
frmResponComp.Optionimpres.Enabled = False
frmResponComp.Optiontiempon.Enabled = False
frmResponComp.Optiontiempos.Enabled = False
frmResponComp.txt1.Enabled = False
frmResponComp.txt2.Enabled = False
frmResponComp.txt3.Enabled = False
frmResponComp.txt4.Enabled = False
frmResponComp.txt5.Enabled = False
frmResponComp.txt6.Enabled = False
frmResponComp.txtCuidados.Enabled = False
frmResponComp.txtCent.Enabled = False
frmResponComp.Frame1.Enabled = False
frmResponComp.Frame2.Enabled = False
MonthView4.Visible = False
MonthView1.Visible = False
MonthView3.Visible = False
Picture1.Enabled = False
Picture2.Enabled = False
Picture3.Enabled = False
End Sub
Private Sub Limpiar()
txtFields(1).Text = ""
Combo_sexo.Clear
txtFields(3).Text = ""
txtfnacimiento.Text = ""
txtFields(4).Text = ""
frmVivienda_Familia.Text3.Text = ""
txtfijo.Text = ""
txtFields(6).Text = ""
txtFields(7).Text = ""
txtFields(11).Text = ""
Combo_distrito.Clear
txtFields(8).Text = ""
Combo_contacto.Clear
txt_otros.Text = ""
txtFRegistro.Text = ""
txtfcontacto.Text = ""
Combo_tipov.Clear
Combo_permiso.Clear
Combo_alq.Clear
Combo_mudanza.Clear
Combo_segura.Clear
Combo1.Clear
Check1.Value = 0
Check2.Value = 0
Check3.Value = 0
Check4.Value = 0
Check5.Value = 0
Option_fumsi.Value = False
Option_fumno.Value = False
frmVivienda_Familia.Combo_persona.Clear
frmVivienda_Familia.Combo_alergias.Clear
frmVivienda_Familia.Combo_embarazo.Clear
frmVivienda_Familia.Combo_hfueras.Clear
frmVivienda_Familia.Combo_npersonas.Clear
frmVivienda_Familia.Combo_rmasc.Clear
frmVivienda_Familia.Combo_tpersonas.Clear
frmVivienda_Familia.Combo_viajes.Clear
frmVivienda_Familia.Option_cuidadon.Value = False
frmVivienda_Familia.Option_cuidados.Value = False
frmVivienda_Familia.Option_gato.Value = False
frmVivienda_Familia.Option_man.Value = 0
frmVivienda_Familia.Option_mas.Value = 0
frmVivienda_Familia.Option_perro.Value = False
frmVivienda_Familia.Optionmcsi.Value = False
frmVivienda_Familia.Optionmn.Value = False
frmVivienda_Familia.Text1.Text = ""
frmVivienda_Familia.Combo_paciencia.Clear
frmResponComp.txtAcc.Text = ""
frmResponComp.txtSitMasc.Text = ""
frmResponComp.txtsiviaja.Text = ""
frmVivienda_Familia.txtDesc.Text = ""
frmVivienda_Familia.txtmotivo.Text = ""
frmVivienda_Familia.Text2.Text = ""
frmResponComp.Combo_Edad.Enabled = False
frmResponComp.Combo_frecuencia.Enabled = False
frmResponComp.Combo_persona.Enabled = False
frmResponComp.Combo_Resp.Enabled = False
frmResponComp.txtLista_acceso.Text = ""
frmResponComp.Option_abandonon.Value = 0
frmResponComp.Option_abandonos.Value = 0
frmResponComp.Option_acuerdon.Value = 0
frmResponComp.Option_acuerdos.Value = 0
frmResponComp.Option_centvetn.Value = 0
frmResponComp.Option_centvets.Value = 0
frmResponComp.Optionbrindarlen.Value = 0
frmResponComp.Optionbrindarles.Value = 0
frmResponComp.Optioncuidadon.Value = 0
frmResponComp.Optioncuidados.Value = 0
frmResponComp.Optionimpren.Value = 0
frmResponComp.Optionimpres.Value = 0
frmResponComp.Optiontiempon.Value = 0
frmResponComp.Optiontiempos.Value = 0
frmResponComp.txt1.Text = ""
frmResponComp.txt2.Text = ""
frmResponComp.txt3.Text = ""
frmResponComp.txt4.Text = ""
frmResponComp.txt5.Text = ""
frmResponComp.txt6.Text = ""
frmResponComp.txtCuidados.Text = ""
frmResponComp.txtCent.Text = ""
End Sub
		Private Sub MonthView1_DateClick(ByVal DateClicked As Date)
txtfnacimiento.Text = MonthView1.Value
MonthView1.Visible = False
End Sub
Private Sub MonthView4_DateClick(ByVal DateClicked As Date)
txtFRegistro.Text = MonthView4.Value
MonthView4.Visible = False
End Sub
Private Sub Picture1_Click()
MonthView1.Visible = True
End Sub
Private Sub Picture2_Click()
MonthView4.Visible = True
End Sub
Private Sub Picture3_Click()
MonthView3.Visible = True
end Sub
Private Sub MonthView3_DateClick(ByVal DateClicked As Date)
txtfcontacto.Text = MonthView3.Value
MonthView3.Visible = False
End Sub





'9.	frmResponCom
Private Sub Combo_persona_Click()
Combo_persona.AddItem frmVivienda_Familia.Combo_persona.Text
Combo_persona.ListIndex = 0
Combo_persona.Enabled = False
End Sub
Private Sub Combo_Resp_Click()
If Combo_Resp.Text = "Otro" Then
  Combo_Edad.Enabled = True
Else
 Combo_Edad.Enabled = False
End If
End Sub
Private Sub Command1_Click()
frmVivienda_Familia.Show
frmResponComp.Hide
End Sub
Private Sub Form_Load()
Combo_persona.AddItem frmPersonas.Combo_persona.Text
Combo_persona.Enabled = False
End Sub
Private Sub Option_abandonon_Click()
Option_abandonos.Value = 0
End Sub
Private Sub Option_abandonos_Click()
Option_abandonon.Value = 0
End Sub
Private Sub Option_acuerdon_Click()
Option_acuerdos.Value = 0
End Sub
Private Sub Option_acuerdos_Click()
Option_acuerdon.Value = 0
End Sub
Private Sub Option_centvetn_Click()
txtCent.Enabled = False
End Sub
Private Sub Option_centvets_Click()
txtCent.Enabled = True
End Sub
Private Sub Optionbrindarlen_Click()
Optionbrindarles.Value = 0
End Sub
Private Sub Optionbrindarles_Click()
Optionbrindarlen.Value = 0
End Sub
Private Sub Optioncuidadon_Click()
Optioncuidados.Value = 0
End Sub
Private Sub Optioncuidados_Click()
Optioncuidadon.Value = 0
End Sub
Private Sub Optionimpren_Click()
Optionimpres.Value = 0
End Sub
Private Sub Optionimpres_Click()
Optionimpren.Value = 0
End Sub
Private Sub Optiontiempon_Click()
Optiontiempos.Value = 0
End Sub
Private Sub Optiontiempos_Click()
Optiontiempon.Value = 0
End Sub









'10.	frmSeguimiento
Private Sub Combo1_Click()
Dim num, id_seg As Integer
num = CInt(Combo1.Text)
Text2.Enabled = False
Text3.Enabled = False
Picture1.Enabled = False
id_seg = Combo2.List(num - 1)
frmAdopciones.Adodc1.RecordSource = "Select * from seguimiento_adopciones where id_seguimiento=" & id_seg
frmAdopciones.Adodc1.Refresh
    If IsNull(frmAdopciones.Adodc1.Recordset!f_seguimiento) = True Or frmAdopciones.Adodc1.Recordset!f_seguimiento = ""
   Text2.Text = ""
    Else
        Text2.Text = Format$(frmAdopciones.Adodc1.Recordset!f_seguimiento,"dd/mm/yyyy")
End If
    If IsNull(frmAdopciones.Adodc1.Recordset!comentarios) = True Or frmAdopciones.Adodc1.Recordset!comentarios = "" Then
        Text3.Text = ""
    Else
        Text3.Text = frmAdopciones.Adodc1.Recordset!comentarios
    End If
End Sub
Private Sub Command1_Click()
frmAdopciones.Show
frmSeguimiento.Hide
End Sub
Private Sub Command2_Click()
Combo1.Clear
Combo2.Clear
Combo1.Enabled = False
Text2.Enabled = False
Text3.Enabled = True
Text2.Text = ""
Text3.Text = ""
Picture1.Enabled = True
Save = 9
End Sub
Private Sub Command3_Click()
Text2.Enabled = False
Text3.Enabled = True
Picture1.Enabled = True
Save = 10
End Sub
Private Sub Command4_Click()
Dim reg, id_adop As Integer
Dim mascota, id_mascota, persona, id_persona As String
If Save = 9 Then
    frmAdopciones.Adodc1.RecordSource = "Select MAX(id_seguimiento) from seguimiento_adopciones"    frmAdopciones.Adodc1.Refresh
reg = frmAdopciones.Adodc1.Recordset!Max + 1
 frmAdopciones.Adodc1.RecordSource = "Select adopciones.id_adopcion from adopciones inner join entrevista on entrevista.id_entrevista=CAST(adopciones.id_entrevista as integer) where entrevista.id_mascota='" & id_mascota & "' and entrevista.id_persona='" & id_persona & "'"
    frmAdopciones.Adodc1.Refresh
    id_adop = frmAdopciones.Adodc1.Recordset!id_adopcion
    frmAdopciones.Adodc1.RecordSource = "Select * from seguimiento_adopciones"
    frmAdopciones.Adodc1.Refresh
    frmAdopciones.Adodc1.Recordset.AddNew
    frmAdopciones.Adodc1.Recordset!id_seguimiento = reg
    frmAdopciones.Adodc1.Recordset!id_adopcion = CStr(id_adop)
    frmAdopciones.Adodc1.Recordset!f_seguimiento = Text2.Text
    frmAdopciones.Adodc1.Recordset!comentarios = Text3.Text
    frmAdopciones.Adodc1.Recordset.Update
Else
    If Save = 10 Then
    frmAdopciones.Adodc1.RecordSource = "Select * from seguimiento_adopciones where id_adopcion='" & frmAdopciones.Combo2.Text & "'"
    frmAdopciones.Adodc1.Recordset!f_seguimiento = Text2.Text
    frmAdopciones.Adodc1.Recordset!comentarios = Text3.Text
    frmAdopciones.Adodc1.Recordset.Update
    End If
End If
End Sub
Private Sub Form_Load()
Dim mascota, id_mascota, persona, id_persona As String
Dim n As Integer
mascota = frmAdopciones.Combo1.Text
persona = frmAdopciones.Combo2.Text
If mascota = "" And persona = "" Then
    Combo1.Text = ""
    Combo2.Text = ""
Else
frmAdopciones.Adodc1.RecordSource = "Select id_mascota from mascotas where nombre_mascota='" & mascota & "'"
frmAdopciones.Adodc1.Refresh
id_mascota = frmAdopciones.Adodc1.Recordset!id_mascota
frmAdopciones.Adodc1.RecordSource = "Select id_persona from persona where nombre='" & persona & "'"
frmAdopciones.Adodc1.Refresh
id_persona = frmAdopciones.Adodc1.Recordset!id_persona
frmAdopciones.Adodc1.RecordSource = "select  seguimiento_adopciones.id_seguimiento, seguimiento_adopciones.id_adopcion, seguimiento_adopciones.f_seguimiento, seguimiento_adopciones.comentarios  from seguimiento_adopciones inner join adopciones on adopciones.id_adopcion=CAST(seguimiento_adopciones.id_adopcion as INTEGER) inner join entrevista on entrevista.id_entrevista=CAST(adopciones.id_entrevista AS INTEGER) where entrevista.id_mascota='" & id_mascota & "'  and entrevista.id_persona='" & id_persona & "'"
frmAdopciones.Adodc1.Refresh
n = frmAdopciones.Adodc1.Recordset.RecordCount
If n = 0 Then
    MsgBox ("Aún no se ha ingresado ningún seguimiento para esta Adopción")
Else
    If n = 1 Then
        Combo1.AddItem "1"
        Combo2.Text = frmAdopciones.Adodc1.Recordset!id_seguimiento
    Else
    i = 1
      Do Until i = n + 1
       Combo1.AddItem i
      i = i + 1
      Loop
      With frmAdopciones.Adodc1.Recordset
            Do Until .EOF
              Combo2.AddItem frmAdopciones.Adodc1.Recordset!id_seguimiento
              .MoveNext
            Loop
        End With
    End If
End If
End If
End Sub
Private Sub MonthView1_DateClick(ByVal DateClicked As Date)
Text2.Text = MonthView1.Value
MonthView1.Visible = False
End Sub
Private Sub Picture1_Click()
MonthView1.Visible = True
End Sub






'11.	frmVivieda_Familia
Private Sub CmdResposa_Click()
frmResponComp.Show
frmVivienda_Familia.Hide
End Sub
Private Sub CmdSalir_Click()
frmPersonas.Show
frmVivienda_Familia.Hide
End Sub
Private Sub Combo_alergias_Click()
If Combo_alergias.Text = "Si" Then
Option_perro.Enabled = True
Option_gato.Enabled = True
End If
End Sub
Private Sub Combo_embarazo_Click()
If Combo_embarazo.Text = "Si" Then
Combo_smascota.Enabled = True
End If
End Sub
Private Sub Combo_viajes_Click()
If Combo_viajes.Text = "No" Then
    txtDesc.Enabled = False
    txtDesc.Text = ""
End If
End Sub
Private Sub Form_Load()
Combo_persona.AddItem frmPersonas.Combo_persona.Text
Combo_persona.Enabled = False
Combo_persona.ListIndex = 0
End Sub
Private Sub Optionmcsi_Click()
Combo_rmasc.Enabled = True
Combo_masc_act.Enabled = True
End Sub
Private Sub Optionmn_Click()
Combo_rmasc.Enabled = False
Combo_masc_act.Enabled = False
Combo_rmasc.Clear
Combo_masc_act.Clear
End Sub









'12.	frmWeb
Private Sub Combo_historia_Change()
Combo_historia.AddItem "Yes"
Combo_historia.AddItem "No"
End Sub
Private Sub Command1_Click()
frmMascotas.Show
frmWEB.Hide
End Sub
Private Sub MonthView_5_DateClick(ByVal DateClicked As Date)
txt_fpub.Text = MonthView_5.Value
MonthView_5.Visible = False
End Sub 
Private Sub Picture1_Click()
MonthView_5.Visible = True
End Sub
